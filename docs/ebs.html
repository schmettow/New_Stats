<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Elements of Bayesian statistics | New statistics for design researchers</title>
  <meta name="description" content="A statistics book for designers, human factors specialists, UX researchers, applied psychologists and everyone else who works hard to make this world a better place." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Elements of Bayesian statistics | New statistics for design researchers" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A statistics book for designers, human factors specialists, UX researchers, applied psychologists and everyone else who works hard to make this world a better place." />
  <meta name="github-repo" content="schmettow/New_Stats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Elements of Bayesian statistics | New statistics for design researchers" />
  
  <meta name="twitter:description" content="A statistics book for designers, human factors specialists, UX researchers, applied psychologists and everyone else who works hard to make this world a better place." />
  

<meta name="author" content="Martin Schmettow" />


<meta name="date" content="2020-11-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gsr.html"/>
<link rel="next" href="lm.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>I Preparations</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#whom-for"><i class="fa fa-check"></i><b>1.1</b> Whom this book is for</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#quant-design-research"><i class="fa fa-check"></i><b>1.2</b> Quantitative design research</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#what-new-stats"><i class="fa fa-check"></i><b>1.3</b> What is New Statistics?</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#how-to-use"><i class="fa fa-check"></i><b>1.4</b> How to use this book</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#routes"><i class="fa fa-check"></i><b>1.4.1</b> Routes</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#classroom"><i class="fa fa-check"></i><b>1.4.2</b> In the classroom</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#rosetta"><i class="fa fa-check"></i><b>1.4.3</b> The stone of Rosetta</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#scoping-and-additional-readings"><i class="fa fa-check"></i><b>1.5</b> Scoping and additional readings</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gsr.html"><a href="gsr.html"><i class="fa fa-check"></i><b>2</b> Getting started with R</a><ul>
<li class="chapter" data-level="2.1" data-path="gsr.html"><a href="gsr.html#setting-up-r"><i class="fa fa-check"></i><b>2.1</b> Setting up the R environment</a><ul>
<li class="chapter" data-level="2.1.1" data-path="gsr.html"><a href="gsr.html#install-cran"><i class="fa fa-check"></i><b>2.1.1</b> Installing CRAN packages</a></li>
<li class="chapter" data-level="2.1.2" data-path="gsr.html"><a href="gsr.html#install-github"><i class="fa fa-check"></i><b>2.1.2</b> Installing packages from Github</a></li>
<li class="chapter" data-level="2.1.3" data-path="gsr.html"><a href="gsr.html#first-program"><i class="fa fa-check"></i><b>2.1.3</b> A first statistical program</a></li>
<li class="chapter" data-level="2.1.4" data-path="gsr.html"><a href="gsr.html#bibliographic-notes"><i class="fa fa-check"></i><b>2.1.4</b> Bibliographic notes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="gsr.html"><a href="gsr.html#r-primer"><i class="fa fa-check"></i><b>2.2</b> Learning R: a primer</a><ul>
<li class="chapter" data-level="2.2.1" data-path="gsr.html"><a href="gsr.html#objects"><i class="fa fa-check"></i><b>2.2.1</b> Assigning and calling Objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="gsr.html"><a href="gsr.html#vectors"><i class="fa fa-check"></i><b>2.2.2</b> Vectors</a></li>
<li class="chapter" data-level="2.2.3" data-path="gsr.html"><a href="gsr.html#object-types"><i class="fa fa-check"></i><b>2.2.3</b> Basic object types</a></li>
<li class="chapter" data-level="2.2.4" data-path="gsr.html"><a href="gsr.html#operators-functions"><i class="fa fa-check"></i><b>2.2.4</b> Operators and functions</a></li>
<li class="chapter" data-level="2.2.5" data-path="gsr.html"><a href="gsr.html#data-frames"><i class="fa fa-check"></i><b>2.2.5</b> Storing data in data frames</a></li>
<li class="chapter" data-level="2.2.6" data-path="gsr.html"><a href="gsr.html#import-export"><i class="fa fa-check"></i><b>2.2.6</b> Import, export and archiving</a></li>
<li class="chapter" data-level="2.2.7" data-path="gsr.html"><a href="gsr.html#case-env"><i class="fa fa-check"></i><b>2.2.7</b> Case environments</a></li>
<li class="chapter" data-level="2.2.8" data-path="gsr.html"><a href="gsr.html#structuring-data"><i class="fa fa-check"></i><b>2.2.8</b> Structuring data</a></li>
<li class="chapter" data-level="2.2.9" data-path="gsr.html"><a href="gsr.html#data-transformation"><i class="fa fa-check"></i><b>2.2.9</b> Data transformation</a></li>
<li class="chapter" data-level="2.2.10" data-path="gsr.html"><a href="gsr.html#plotting"><i class="fa fa-check"></i><b>2.2.10</b> Plotting data</a></li>
<li class="chapter" data-level="2.2.11" data-path="gsr.html"><a href="gsr.html#fitting"><i class="fa fa-check"></i><b>2.2.11</b> Fitting regression models</a></li>
<li class="chapter" data-level="2.2.12" data-path="gsr.html"><a href="gsr.html#knitting"><i class="fa fa-check"></i><b>2.2.12</b> Knitting statistical reports</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="gsr.html"><a href="gsr.html#lib_gsr"><i class="fa fa-check"></i><b>2.3</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ebs.html"><a href="ebs.html"><i class="fa fa-check"></i><b>3</b> Elements of Bayesian statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="ebs.html"><a href="ebs.html#decision-making"><i class="fa fa-check"></i><b>3.1</b> Rational decision making in design research</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ebs.html"><a href="ebs.html#measuring-uncertainty"><i class="fa fa-check"></i><b>3.1.1</b> Measuring uncertainty</a></li>
<li class="chapter" data-level="3.1.2" data-path="ebs.html"><a href="ebs.html#benchmarking-designs"><i class="fa fa-check"></i><b>3.1.2</b> Benchmarking designs</a></li>
<li class="chapter" data-level="3.1.3" data-path="ebs.html"><a href="ebs.html#comparing-designs"><i class="fa fa-check"></i><b>3.1.3</b> Comparison of designs</a></li>
<li class="chapter" data-level="3.1.4" data-path="ebs.html"><a href="ebs.html#prior-knowledge"><i class="fa fa-check"></i><b>3.1.4</b> Prior knowledge</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ebs.html"><a href="ebs.html#observations-measures"><i class="fa fa-check"></i><b>3.2</b> Observations and measures</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ebs.html"><a href="ebs.html#interaction-seq"><i class="fa fa-check"></i><b>3.2.1</b> Interaction sequences</a></li>
<li class="chapter" data-level="3.2.2" data-path="ebs.html"><a href="ebs.html#perf-measures"><i class="fa fa-check"></i><b>3.2.2</b> Performance measures</a></li>
<li class="chapter" data-level="3.2.3" data-path="ebs.html"><a href="ebs.html#satisfaction-and-other-feelings"><i class="fa fa-check"></i><b>3.2.3</b> Satisfaction and other feelings</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ebs.html"><a href="ebs.html#descriptive-stats"><i class="fa fa-check"></i><b>3.3</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ebs.html"><a href="ebs.html#frequencies"><i class="fa fa-check"></i><b>3.3.1</b> Frequencies</a></li>
<li class="chapter" data-level="3.3.2" data-path="ebs.html"><a href="ebs.html#central-tendency"><i class="fa fa-check"></i><b>3.3.2</b> Central tendency</a></li>
<li class="chapter" data-level="3.3.3" data-path="ebs.html"><a href="ebs.html#dispersion"><i class="fa fa-check"></i><b>3.3.3</b> Dispersion</a></li>
<li class="chapter" data-level="3.3.4" data-path="ebs.html"><a href="ebs.html#associations"><i class="fa fa-check"></i><b>3.3.4</b> Associations</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ebs.html"><a href="ebs.html#bayes-prob-theory"><i class="fa fa-check"></i><b>3.4</b> Bayesian probability theory</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ebs.html"><a href="ebs.html#set-theory"><i class="fa fa-check"></i><b>3.4.1</b> Some set theory</a></li>
<li class="chapter" data-level="3.4.2" data-path="ebs.html"><a href="ebs.html#probability"><i class="fa fa-check"></i><b>3.4.2</b> Probability</a></li>
<li class="chapter" data-level="3.4.3" data-path="ebs.html"><a href="ebs.html#likelihood"><i class="fa fa-check"></i><b>3.4.3</b> Likelihood</a></li>
<li class="chapter" data-level="3.4.4" data-path="ebs.html"><a href="ebs.html#bayes-freq-prob"><i class="fa fa-check"></i><b>3.4.4</b> Bayesian and frequentist probability</a></li>
<li class="chapter" data-level="3.4.5" data-path="ebs.html"><a href="ebs.html#bayes-theorem"><i class="fa fa-check"></i><b>3.4.5</b> Bayes theorem</a></li>
<li class="chapter" data-level="3.4.6" data-path="ebs.html"><a href="ebs.html#dynamics-belief"><i class="fa fa-check"></i><b>3.4.6</b> Bayesian dynamics of belief</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ebs.html"><a href="ebs.html#statmod"><i class="fa fa-check"></i><b>3.5</b> Statistical models</a><ul>
<li class="chapter" data-level="3.5.1" data-path="ebs.html"><a href="ebs.html#structural-part"><i class="fa fa-check"></i><b>3.5.1</b> The structural part</a></li>
<li class="chapter" data-level="3.5.2" data-path="ebs.html"><a href="ebs.html#distributions"><i class="fa fa-check"></i><b>3.5.2</b> Distributions: shapes of randomness</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ebs.html"><a href="ebs.html#bayes-estimation"><i class="fa fa-check"></i><b>3.6</b> Towards Bayesian estimation</a></li>
<li class="chapter" data-level="3.7" data-path="ebs.html"><a href="ebs.html#priors-defaults"><i class="fa fa-check"></i><b>3.7</b> On priors and defaults</a></li>
<li class="chapter" data-level="3.8" data-path="ebs.html"><a href="ebs.html#further-readings"><i class="fa fa-check"></i><b>3.8</b> Further readings</a></li>
</ul></li>
<li class="part"><span><b>II Models</b></span></li>
<li class="chapter" data-level="4" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>4</b> Linear models</a><ul>
<li class="chapter" data-level="4.1" data-path="lm.html"><a href="lm.html#gmm"><i class="fa fa-check"></i><b>4.1</b> Quantification at work: grand mean models</a><ul>
<li class="chapter" data-level="4.1.1" data-path="lm.html"><a href="lm.html#random-walk"><i class="fa fa-check"></i><b>4.1.1</b> Do the random walk: Markov Chain Monte Carlo sampling</a></li>
<li class="chapter" data-level="4.1.2" data-path="lm.html"><a href="lm.html#likelihood-random-term"><i class="fa fa-check"></i><b>4.1.2</b> Likelihood and random term</a></li>
<li class="chapter" data-level="4.1.3" data-path="lm.html"><a href="lm.html#posterior-dist"><i class="fa fa-check"></i><b>4.1.3</b> Working with the posterior distribution</a></li>
<li class="chapter" data-level="4.1.4" data-path="lm.html"><a href="lm.html#clu"><i class="fa fa-check"></i><b>4.1.4</b> Center and interval estimates</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lm.html"><a href="lm.html#lrm"><i class="fa fa-check"></i><b>4.2</b> Walk the line: linear regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="lm.html"><a href="lm.html#transform-measures"><i class="fa fa-check"></i><b>4.2.1</b> Transforming measures</a></li>
<li class="chapter" data-level="4.2.2" data-path="lm.html"><a href="lm.html#correlations"><i class="fa fa-check"></i><b>4.2.2</b> Correlations</a></li>
<li class="chapter" data-level="4.2.3" data-path="lm.html"><a href="lm.html#endless-linear"><i class="fa fa-check"></i><b>4.2.3</b> Endlessly linear</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lm.html"><a href="lm.html#factorial-models"><i class="fa fa-check"></i><b>4.3</b> Factorial Models</a><ul>
<li class="chapter" data-level="4.3.1" data-path="lm.html"><a href="lm.html#cgm"><i class="fa fa-check"></i><b>4.3.1</b> A versus B: Comparison of groups</a></li>
<li class="chapter" data-level="4.3.2" data-path="lm.html"><a href="lm.html#dummy"><i class="fa fa-check"></i><b>4.3.2</b> Not stupid: dummy variables</a></li>
<li class="chapter" data-level="4.3.3" data-path="lm.html"><a href="lm.html#treatment-contrasts"><i class="fa fa-check"></i><b>4.3.3</b> Treatment contrast</a></li>
<li class="chapter" data-level="4.3.4" data-path="lm.html"><a href="lm.html#amm"><i class="fa fa-check"></i><b>4.3.4</b> Absolute Means Model</a></li>
<li class="chapter" data-level="4.3.5" data-path="lm.html"><a href="lm.html#ofm"><i class="fa fa-check"></i><b>4.3.5</b> Ordered Factors Models</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lm.html"><a href="lm.html#mpm"><i class="fa fa-check"></i><b>4.4</b> Putting it all together: multi predictor models</a><ul>
<li class="chapter" data-level="4.4.1" data-path="lm.html"><a href="lm.html#mrm"><i class="fa fa-check"></i><b>4.4.1</b> On surface: multiple regression models</a></li>
<li class="chapter" data-level="4.4.2" data-path="lm.html"><a href="lm.html#mfm"><i class="fa fa-check"></i><b>4.4.2</b> Crossover: multifactorial models</a></li>
<li class="chapter" data-level="4.4.3" data-path="lm.html"><a href="lm.html#grm"><i class="fa fa-check"></i><b>4.4.3</b> Line-by-line: grouped regression models</a></li>
<li class="chapter" data-level="4.4.4" data-path="lm.html"><a href="lm.html#emp-stat-control"><i class="fa fa-check"></i><b>4.4.4</b> Empirical versus statistical control</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lm.html"><a href="lm.html#cfxm"><i class="fa fa-check"></i><b>4.5</b> Conditional effects models</a><ul>
<li class="chapter" data-level="4.5.1" data-path="lm.html"><a href="lm.html#cmrm"><i class="fa fa-check"></i><b>4.5.1</b> Conditional multiple regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="lm.html"><a href="lm.html#cmfm"><i class="fa fa-check"></i><b>4.5.2</b> Conditional multifactorial models</a></li>
<li class="chapter" data-level="4.5.3" data-path="lm.html"><a href="lm.html#saturation"><i class="fa fa-check"></i><b>4.5.3</b> Saturation: hitting the boundaries</a></li>
<li class="chapter" data-level="4.5.4" data-path="lm.html"><a href="lm.html#amplification"><i class="fa fa-check"></i><b>4.5.4</b> Amplification: more than the sum</a></li>
<li class="chapter" data-level="4.5.5" data-path="lm.html"><a href="lm.html#cfx-theory"><i class="fa fa-check"></i><b>4.5.5</b> Conditional effects and design theory</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lm.html"><a href="lm.html#prm"><i class="fa fa-check"></i><b>4.6</b> Doing the rollercoaster: polynomial regression models</a><ul>
<li class="chapter" data-level="4.6.1" data-path="lm.html"><a href="lm.html#test-stat"><i class="fa fa-check"></i><b>4.6.1</b> Make yourself a test statistic</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="lm.html"><a href="lm.html#further-readings-1"><i class="fa fa-check"></i><b>4.7</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mlm.html"><a href="mlm.html"><i class="fa fa-check"></i><b>5</b> Multilevel models</a><ul>
<li class="chapter" data-level="5.1" data-path="mlm.html"><a href="mlm.html#intercept-re"><i class="fa fa-check"></i><b>5.1</b> The Human Factor: Intercept random effects</a></li>
<li class="chapter" data-level="5.2" data-path="mlm.html"><a href="mlm.html#slope-re"><i class="fa fa-check"></i><b>5.2</b> Slope random effects: variance in change</a></li>
<li class="chapter" data-level="5.3" data-path="mlm.html"><a href="mlm.html#thinking-multi-level"><i class="fa fa-check"></i><b>5.3</b> Thinking multi-level</a></li>
<li class="chapter" data-level="5.4" data-path="mlm.html"><a href="mlm.html#universality"><i class="fa fa-check"></i><b>5.4</b> Testing universality of theories</a></li>
<li class="chapter" data-level="5.5" data-path="mlm.html"><a href="mlm.html#non-human-populations"><i class="fa fa-check"></i><b>5.5</b> Non-human populations and cross-overs</a></li>
<li class="chapter" data-level="5.6" data-path="mlm.html"><a href="mlm.html#nested-re"><i class="fa fa-check"></i><b>5.6</b> Nested random effects</a></li>
<li class="chapter" data-level="5.7" data-path="mlm.html"><a href="mlm.html#pool-shrink"><i class="fa fa-check"></i><b>5.7</b> What are random effects? On pooling and shrinkage</a></li>
<li class="chapter" data-level="5.8" data-path="mlm.html"><a href="mlm.html#psychometrics"><i class="fa fa-check"></i><b>5.8</b> Psychometrics and design-o-metric models</a><ul>
<li class="chapter" data-level="5.8.1" data-path="mlm.html"><a href="mlm.html#coverage"><i class="fa fa-check"></i><b>5.8.1</b> Coverage</a></li>
<li class="chapter" data-level="5.8.2" data-path="mlm.html"><a href="mlm.html#reliability"><i class="fa fa-check"></i><b>5.8.2</b> Reliability</a></li>
<li class="chapter" data-level="5.8.3" data-path="mlm.html"><a href="mlm.html#validity"><i class="fa fa-check"></i><b>5.8.3</b> Validity</a></li>
<li class="chapter" data-level="5.8.4" data-path="mlm.html"><a href="mlm.html#designometrix"><i class="fa fa-check"></i><b>5.8.4</b> Towards Design-o-metrix</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="mlm.html"><a href="mlm.html#further-readings-2"><i class="fa fa-check"></i><b>5.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>6</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="6.1" data-path="glm.html"><a href="glm.html#elements-glm"><i class="fa fa-check"></i><b>6.1</b> Elements of Generalized Linear Models</a><ul>
<li class="chapter" data-level="6.1.1" data-path="glm.html"><a href="glm.html#relinking-linearity"><i class="fa fa-check"></i><b>6.1.1</b> Re-linking linearity</a></li>
<li class="chapter" data-level="6.1.2" data-path="glm.html"><a href="glm.html#choosing-randomness"><i class="fa fa-check"></i><b>6.1.2</b> Choosing patterns of randomness</a></li>
<li class="chapter" data-level="6.1.3" data-path="glm.html"><a href="glm.html#mean-var-rel"><i class="fa fa-check"></i><b>6.1.3</b> Mean-variance relationship</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="glm.html"><a href="glm.html#count-data"><i class="fa fa-check"></i><b>6.2</b> Count data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="glm.html"><a href="glm.html#pois-reg"><i class="fa fa-check"></i><b>6.2.1</b> Poisson regression</a></li>
<li class="chapter" data-level="6.2.2" data-path="glm.html"><a href="glm.html#logistic-reg"><i class="fa fa-check"></i><b>6.2.2</b> Logistic (aka Binomial) regression</a></li>
<li class="chapter" data-level="6.2.3" data-path="glm.html"><a href="glm.html#overdispersion"><i class="fa fa-check"></i><b>6.2.3</b> Modelling overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="glm.html"><a href="glm.html#duration-measures"><i class="fa fa-check"></i><b>6.3</b> Duration measures</a><ul>
<li class="chapter" data-level="6.3.1" data-path="glm.html"><a href="glm.html#exp-gam-reg"><i class="fa fa-check"></i><b>6.3.1</b> Exponential and Gamma regression</a></li>
<li class="chapter" data-level="6.3.2" data-path="glm.html"><a href="glm.html#exgauss-reg"><i class="fa fa-check"></i><b>6.3.2</b> ExGaussian regression</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="glm.html"><a href="glm.html#rating-scales"><i class="fa fa-check"></i><b>6.4</b> Rating scales</a><ul>
<li class="chapter" data-level="6.4.1" data-path="glm.html"><a href="glm.html#ord-logist-reg"><i class="fa fa-check"></i><b>6.4.1</b> Ordered logistic regression</a></li>
<li class="chapter" data-level="6.4.2" data-path="glm.html"><a href="glm.html#beta-reg"><i class="fa fa-check"></i><b>6.4.2</b> Beta regression</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="glm.html"><a href="glm.html#distributional-models"><i class="fa fa-check"></i><b>6.5</b> Beyond mean: distributional models</a><ul>
<li class="chapter" data-level="6.5.1" data-path="glm.html"><a href="glm.html#item-anchoring"><i class="fa fa-check"></i><b>6.5.1</b> Item-level anchoring in rating scales</a></li>
<li class="chapter" data-level="6.5.2" data-path="glm.html"><a href="glm.html#part-employment"><i class="fa fa-check"></i><b>6.5.2</b> Participant-level employment of scale</a></li>
<li class="chapter" data-level="6.5.3" data-path="glm.html"><a href="glm.html#part-skew"><i class="fa fa-check"></i><b>6.5.3</b> Participant-level skew in reaction times</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="glm.html"><a href="glm.html#further-readings-3"><i class="fa fa-check"></i><b>6.6</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="wwm.html"><a href="wwm.html"><i class="fa fa-check"></i><b>7</b> Working with models</a><ul>
<li class="chapter" data-level="7.1" data-path="wwm.html"><a href="wwm.html#model-criticism"><i class="fa fa-check"></i><b>7.1</b> Model criticism</a><ul>
<li class="chapter" data-level="7.1.1" data-path="wwm.html"><a href="wwm.html#residual-analysis"><i class="fa fa-check"></i><b>7.1.1</b> Residual analysis</a></li>
<li class="chapter" data-level="7.1.2" data-path="wwm.html"><a href="wwm.html#fitted-responses"><i class="fa fa-check"></i><b>7.1.2</b> Fitted responses analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="wwm.html"><a href="wwm.html#model-selection"><i class="fa fa-check"></i><b>7.2</b> Model selection</a><ul>
<li class="chapter" data-level="7.2.1" data-path="wwm.html"><a href="wwm.html#overfitting"><i class="fa fa-check"></i><b>7.2.1</b> The problem of over-fitting</a></li>
<li class="chapter" data-level="7.2.2" data-path="wwm.html"><a href="wwm.html#cross-validation"><i class="fa fa-check"></i><b>7.2.2</b> Cross validation and LOO</a></li>
<li class="chapter" data-level="7.2.3" data-path="wwm.html"><a href="wwm.html#ic"><i class="fa fa-check"></i><b>7.2.3</b> Information Criteria</a></li>
<li class="chapter" data-level="7.2.4" data-path="wwm.html"><a href="wwm.html#model-selection-1"><i class="fa fa-check"></i><b>7.2.4</b> Model selection</a></li>
<li class="chapter" data-level="7.2.5" data-path="wwm.html"><a href="wwm.html#choose-dist"><i class="fa fa-check"></i><b>7.2.5</b> Comparing response distributions</a></li>
<li class="chapter" data-level="7.2.6" data-path="wwm.html"><a href="wwm.html#testing-theories"><i class="fa fa-check"></i><b>7.2.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="7.2.7" data-path="wwm.html"><a href="wwm.html#a-note-on-bayes-factor"><i class="fa fa-check"></i><b>7.2.7</b> A note on Bayes Factor</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="wwm.html"><a href="wwm.html#further-readings-4"><i class="fa fa-check"></i><b>7.3</b> Further readings</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="cases.html"><a href="cases.html"><i class="fa fa-check"></i><b>A</b> Cases</a><ul>
<li class="chapter" data-level="A.1" data-path="cases.html"><a href="cases.html#real-cases"><i class="fa fa-check"></i><b>A.1</b> Real cases</a><ul>
<li class="chapter" data-level="A.1.1" data-path="cases.html"><a href="cases.html#hugme"><i class="fa fa-check"></i><b>A.1.1</b> Hugme</a></li>
<li class="chapter" data-level="A.1.2" data-path="cases.html"><a href="cases.html#cue8"><i class="fa fa-check"></i><b>A.1.2</b> CUE8</a></li>
<li class="chapter" data-level="A.1.3" data-path="cases.html"><a href="cases.html#uncanny"><i class="fa fa-check"></i><b>A.1.3</b> Uncanny Valley</a></li>
<li class="chapter" data-level="A.1.4" data-path="cases.html"><a href="cases.html#ipump"><i class="fa fa-check"></i><b>A.1.4</b> IPump</a></li>
<li class="chapter" data-level="A.1.5" data-path="cases.html"><a href="cases.html#sleepstudy"><i class="fa fa-check"></i><b>A.1.5</b> Case Sleepstudy</a></li>
<li class="chapter" data-level="A.1.6" data-path="cases.html"><a href="cases.html#egan"><i class="fa fa-check"></i><b>A.1.6</b> Egan</a></li>
<li class="chapter" data-level="A.1.7" data-path="cases.html"><a href="cases.html#mmn"><i class="fa fa-check"></i><b>A.1.7</b> Case: Millers Magic Number</a></li>
<li class="chapter" data-level="A.1.8" data-path="cases.html"><a href="cases.html#aup"><i class="fa fa-check"></i><b>A.1.8</b> AUP</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="cases.html"><a href="cases.html#synthetic-data"><i class="fa fa-check"></i><b>A.2</b> Synthetic data sets</a><ul>
<li class="chapter" data-level="A.2.1" data-path="cases.html"><a href="cases.html#rainfall"><i class="fa fa-check"></i><b>A.2.1</b> Rainfall</a></li>
<li class="chapter" data-level="A.2.2" data-path="cases.html"><a href="cases.html#sec99"><i class="fa fa-check"></i><b>A.2.2</b> 99 seconds</a></li>
<li class="chapter" data-level="A.2.3" data-path="cases.html"><a href="cases.html#rational"><i class="fa fa-check"></i><b>A.2.3</b> Rational</a></li>
<li class="chapter" data-level="A.2.4" data-path="cases.html"><a href="cases.html#browsingab"><i class="fa fa-check"></i><b>A.2.4</b> BrowsingAB</a></li>
<li class="chapter" data-level="A.2.5" data-path="cases.html"><a href="cases.html#headache"><i class="fa fa-check"></i><b>A.2.5</b> Headache</a></li>
<li class="chapter" data-level="A.2.6" data-path="cases.html"><a href="cases.html#reading"><i class="fa fa-check"></i><b>A.2.6</b> Reading time</a></li>
<li class="chapter" data-level="A.2.7" data-path="cases.html"><a href="cases.html#argame"><i class="fa fa-check"></i><b>A.2.7</b> AR_game</a></li>
<li class="chapter" data-level="A.2.8" data-path="cases.html"><a href="cases.html#sleep"><i class="fa fa-check"></i><b>A.2.8</b> Sleep</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">New statistics for design researchers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ebs" class="section level1">
<h1><span class="header-section-number">3</span> Elements of Bayesian statistics</h1>
<p>As human beings we make our decisions on what has happened to us in the past.
For example, we trust a person or a company more, when we can look back at a series of successful transactions.
And we have remarkable capability to recall what has just happened, but also what happened yesterday or years ago.
By integrating over all the evidence, we form a view of the world we forage.
When evidence is abundant, we vigorously experience a feeling of certainty, or lack of doubt.
That is not to deny, that in a variety of situations, the boundedness of the human mind kicks in and we become terrible decision makers.
This is for a variety of psychological reasons, to name just a few:</p>
<ul>
<li>plain forgetting</li>
<li>the primacy effect: recent events get more weight</li>
<li>confirmation bias: evidence that supports a belief is actively sought for, counter-evidence gets ignored.</li>
<li>the hindsight bias: once a situation has taken a certain outcome, we believe that it had to happen that way.</li>
</ul>
<p>The very aim of scientific research is to avoid the pitfalls of our minds and act as rational as possible by translating our theory into a formal model of reality, gathering evidence in an unbiased way and weigh the evidence by formal procedures.
This weighing of evidence using data essentially is <em>statistical modeling</em> and statistical models in this book all produces two sorts of numbers: <em>magnitude of effects</em> and <em>level of certainty</em>.
<!-- When a statistic is reported together with the strength of evidence, this is conventionally called an *inferential statistic*. -->
In applied research, real world decisions depend on the evidence, which has two aspects: first, the strength of effects and the level of certainty we have reached.</p>
<p>Bayesian inferential statistics grounds on the idea of accumulating evidence, where past data is not lost. <em>Certainty</em> (or <em>strength of belief</em> or <em>credibility</em> or <em>credence</em>) in Bayesian statistics is formalized as a <em>probability scale (0 = impossible, 1 = certain)</em>.
The level of certainty is determined by two sources, everything that we already know about the subject and the data we just gathered.
Both sources are only seemingly different, because when new data is analyzed, a transition occurs from what you new before, <em>prior belief</em>, to what you know after seeing the data, <em>posterior belief</em>.
In other words: by data the current belief gets an update.</p>
<p>Updating our beliefs is essential for acting in rational ways.
The first section of this chapter is intended to tell the Big Picture.
It puts statistics into the context of decision-making in design research.
For those readers with a background in statistics, this section may be a sufficient introduction all by itself.</p>
<p>In the remainder of this chapter the essential concepts of statistics and Bayesian analysis will be introduced from ground up.
First we will look at descriptive statistics and I will introduce basic statistical tools, such as summary statistics and figures.
Descriptive statistics can be used effectively to explore data and prepare the statistical modeling, but they lack one important ingredient: information about the level certainty.</p>
<p><a href="ebs.html#bayes-prob-theory">3.4</a> first derives probability from set theory and relative frequencies, before we turn to the the famous Bayes theorem <a href="ebs.html#bayes-theorem">3.4.5</a>, followed by an introduction to Bayesian thinking <a href="ebs.html#dynamics-belief">3.4.6</a>.</p>
<p>Then we go on to basic concepts of statistical modeling, such as the likelihood and we finish with Bayes theorem, which does the calculation of the posterior certainty from prior knowledge and data.
Despite the matter, I will make minimal use of mathematical formalism.
Instead, I use R code as much as possible to illustrate the concepts.
If you are not yet familiar with R, you may want to read chapter <a href="gsr.html#r-primer">2.2</a> first, or alongside.</p>
<p>Section <a href="ebs.html#statmod">3.5</a> goes into the practical details of modeling.
A statistical model is introduced by its two components: the structural part, which typically carries the research question or theory, followed by a rather deep account of the second component of statistical models: the random part.</p>
<div id="decision-making" class="section level2">
<h2><span class="header-section-number">3.1</span> Rational decision making in design research</h2>
<ul>
<li>I see clouds. Should I take my umbrella?</li>
<li>Should I do this bungee jump? How many people came to death by jumping? (More or less than alpine skiing?) And how much fun is it really?</li>
<li>Overhauling our company website will cost us EUR 100.000. Is it worth it?</li>
</ul>
<p>All the above cases are examples of decision making under uncertainty.
The actors aim for maximizing their outcome, be it well being, fun or money.
But, they are uncertain about what will really happen.
And their uncertainty occurs on two levels:</p>
<ol style="list-style-type: decimal">
<li>One cannot precisely foresee the exact outcome of one’s chosen action:</li>
</ol>
<ul>
<li>Taking the umbrella with you can have two consequences: if it rains, you have the benefit of staying dry. If it does not rain, you have the inconvenience of carrying it with you.</li>
<li>You don’t know if you will be the rare unlucky one, who’s bungee rope breaks.</li>
<li>You don’t know by how much the new design will attract more visitors and how much the income will raise.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>It can be difficult to precisely determine the benefits or losses of potential outcomes:</li>
</ol>
<ul>
<li>How much worse is your day when carrying a useless object with you? How much do you hate moisture? In order to compare the two, they must be assessed on the same scale.</li>
<li>How much fun (or other sources of reward, like social acknowledgments) is it to jump a 120 meter canyon? And how much worth is your own life to you?</li>
<li>What is the average revenue generated per visit? What is an increase of recurrence rate of, say, 50% worth?</li>
</ul>
<p>Once you know the probabilities of all outcomes and the respective losses, <em>decision theory</em> provides an intuitive framework to estimate these values.
<em>Expected utility</em> <span class="math inline">\(U\)</span> is the sum product of <em>outcome probabilities</em> <span class="math inline">\(P\)</span> and the involved <em>losses</em>.
In the case of the umbrella, the decision is between two options: taking an umbrella versus taking no umbrella, when it is cloudy.
We calculate and compare the expected utilities <code>U</code> as follows (<span class="math inline">\(P(\text{outcome})\)</span> is the probability of an outcome):</p>
<p><span class="math display">\[
\begin{aligned}
&amp;P(\text{rain}) &amp;&amp;&amp;=&amp; 0.6 \\
&amp;P(\text{no rain}) &amp;=&amp; 1 - P(\text{rain}) &amp;=&amp; 0.4 \\
&amp;L(\text{carry}) &amp;&amp;&amp;=&amp; 2 \\
&amp;L(\text{wet}) &amp;&amp;&amp;=&amp; 4 \\
&amp;U(\text{umbrella}) &amp;=&amp; P(\text{rain}) L(\text{carry}) + P(\text{no rain}) L(\text{carry})   = L(\text{carry}) &amp;=&amp; 2\\
&amp;U(\text{no umbrella}) &amp;=&amp; P(\text{rain}) L(\text{wet}) &amp;=&amp; 2.4
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="ebs.html#cb134-1"></a><span class="kw">attach</span>(Rainfall)</span>
<span id="cb134-2"><a href="ebs.html#cb134-2"></a></span>
<span id="cb134-3"><a href="ebs.html#cb134-3"></a>Actions &lt;-</span>
<span id="cb134-4"><a href="ebs.html#cb134-4"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">action =</span> <span class="kw">c</span>(<span class="st">&quot;umbrella&quot;</span>, <span class="st">&quot;no umbrella&quot;</span>))</span>
<span id="cb134-5"><a href="ebs.html#cb134-5"></a>Actions</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">umbrella</td>
</tr>
<tr class="even">
<td align="left">no umbrella</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="ebs.html#cb135-1"></a>Outcomes  &lt;-</span>
<span id="cb135-2"><a href="ebs.html#cb135-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">outcome  =</span> <span class="kw">c</span>(<span class="st">&quot;rain&quot;</span>, <span class="st">&quot;no rain&quot;</span>),</span>
<span id="cb135-3"><a href="ebs.html#cb135-3"></a>                     <span class="dt">prob   =</span> <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>))</span>
<span id="cb135-4"><a href="ebs.html#cb135-4"></a>Outcomes</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">outcome</th>
<th align="right">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rain</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">no rain</td>
<td align="right">0.4</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="ebs.html#cb136-1"></a>Losses  &lt;-<span class="st"> </span></span>
<span id="cb136-2"><a href="ebs.html#cb136-2"></a><span class="st">  </span><span class="kw">expand.grid</span>(<span class="dt">action =</span> Actions<span class="op">$</span>action, </span>
<span id="cb136-3"><a href="ebs.html#cb136-3"></a>              <span class="dt">outcome =</span> Outcomes<span class="op">$</span>outcome) <span class="op">%&gt;%</span></span>
<span id="cb136-4"><a href="ebs.html#cb136-4"></a><span class="st">  </span><span class="kw">join</span>(Outcomes) <span class="op">%&gt;%</span></span>
<span id="cb136-5"><a href="ebs.html#cb136-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">loss =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb136-6"><a href="ebs.html#cb136-6"></a>Losses</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">action</th>
<th align="left">outcome</th>
<th align="right">prob</th>
<th align="right">loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">umbrella</td>
<td align="left">rain</td>
<td align="right">0.6</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">no umbrella</td>
<td align="left">rain</td>
<td align="right">0.6</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">umbrella</td>
<td align="left">no rain</td>
<td align="right">0.4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">no umbrella</td>
<td align="left">no rain</td>
<td align="right">0.4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="ebs.html#cb137-1"></a>Utility &lt;-<span class="st"> </span></span>
<span id="cb137-2"><a href="ebs.html#cb137-2"></a><span class="st">  </span>Losses <span class="op">%&gt;%</span></span>
<span id="cb137-3"><a href="ebs.html#cb137-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">conditional_loss =</span> prob <span class="op">*</span><span class="st"> </span>loss) <span class="op">%&gt;%</span></span>
<span id="cb137-4"><a href="ebs.html#cb137-4"></a><span class="st">  </span><span class="kw">group_by</span>(action) <span class="op">%&gt;%</span></span>
<span id="cb137-5"><a href="ebs.html#cb137-5"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">expected_loss =</span> <span class="kw">sum</span>(conditional_loss))</span>
<span id="cb137-6"><a href="ebs.html#cb137-6"></a>Utility</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">action</th>
<th align="right">expected_loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">umbrella</td>
<td align="right">2.0</td>
</tr>
<tr class="even">
<td align="left">no umbrella</td>
<td align="right">2.4</td>
</tr>
</tbody>
</table>
<p>We conclude that, given the high chance for rain, and the conditional losses, the expected loss is larger for not taking an umbrella with you.
It is rational to take an umbrella when it is cloudy.</p>
<div id="measuring-uncertainty" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Measuring uncertainty</h3>
<p>As we have seen above, a decision requires two investigations: outcomes and their probabilities, and the assigned loss.
Assigning loss to decisions is highly context dependent and often requires domain-specific expertise.
The issues of probabilistic processes and the uncertainty that arises from them is basically what the idea of <em>New Statistics</em> represents.
We encounter uncertainty in two forms: first, we usually have just a limited set of observations to draw inference from, this is <em>uncertainty of parameter estimates</em>.
From just 20 days of observation, we cannot be absolutely certain about the true chance of rain.
It can be 60%, but also 62% or 56%.
Second, even if we precisely knew the chance of rain, it does not mean we could make a certain statement of the future weather conditions, which is <em>predictive uncertainty</em>.
For a perfect forecast, we had to have a complete and exact figure of the physical properties of the atmosphere, and a fully valid model to predict future states from it.
For all non-trivial systems (which excludes living organisms and weather), this is impossible.</p>
<p>Review the rainfall example: the strategy of taking an umbrella with you has proven to be superior under the very assumption of <em>predictive uncertainty</em>.
As long as you are interested in long-term benefit (i.e. optimizing the average loss on a long series of days), this is the best strategy.
This may sound obvious, but it is not.
In many cases, where we make decisions under uncertainty, the decision is not part of a homogeneous series.
If you are member of a startup team, you only have this one chance to make a fortune.
There is not much opportunity to average out a single failure at future occasions.
In contrast, the investor, who lends you the money for your endeavor, probably has a series.
You and the investor are playing to very different rules.
For the investor it is rational to optimize his strategy towards a minimum average loss.
The entrepreneur is best advised to keep the maximum possible loss at a minimum.</p>
<p>As we have seen, predictive uncertainty is already embedded in the framework of rational decision making.
Some concepts in statistics can be of help here: the uncertainty regarding future events can be quantified (for example, with posterior predictive distributions <a href="lm.html#posterior-dist">4.1.3</a> and the process of model selection can assist in finding the model that provides the best predictive power.</p>
<p>Still, in our formalization of the Rainfall case, what magically appears are the estimates for the chance of rain.
Having these estimates is crucial for finding an optimal decision, but they are created outside of the framework.
Furthermore, we pretended to know the chance of rain exactly, which is unrealistic.
Estimating parameters from observations is the reign of statistics.
From naive calculations, statistical reasoning differs by also regarding uncertainty of estimates.
Generally, we aim for making statements of the following form:</p>
<p>“With probability <span class="math inline">\(p\)</span>, the attribute <span class="math inline">\(A\)</span> is of magnitude <span class="math inline">\(X\)</span>.”</p>
<p>In the umbrella example above, the magnitude of interest is the chance of rain.
It was assumed to be 60%.
This appears extremely high for an average day.
A more realistic assumption would be that the probability of rainfall is 60% <em>given the observation of a cloudy sky</em>.
How could we have come to the belief that with 60% chance, it will rain when the sky is cloudy?
We have several options, here:</p>
<ol style="list-style-type: decimal">
<li>Supposed, you know that, on average, it rains 60% of all days, it is a matter of common sense, that the probability of rain must be equal or larger than that, when it’s cloudy.</li>
<li>You could go and ask a number of experts about the association of clouds and rain.</li>
<li>You could do some systematic observations yourself.</li>
</ol>
<p>Imagine, you have recorded the coincidences of clouds and rainfall over a period, of, let’s say, 20 days, with the following observations:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="ebs.html#cb138-1"></a>Rain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>()</span></code></pre></div>
<p>Intuitively, you would use the average to estimate the probability of rain under every condition.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="ebs.html#cb139-1"></a>T_desc &lt;-</span>
<span id="cb139-2"><a href="ebs.html#cb139-2"></a><span class="st">  </span>Rain <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb139-3"><a href="ebs.html#cb139-3"></a><span class="st">  </span><span class="kw">group_by</span>(cloudy) <span class="op">%&gt;%</span></span>
<span id="cb139-4"><a href="ebs.html#cb139-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">chance_of_rain =</span> <span class="kw">mean</span>(rain))</span></code></pre></div>
<p>These probabilities we can feed into the decision framework as outlined above.
The problem is, that we obtained just a few observations to infer the magnitude of the parameter <span class="math inline">\(P(rain|cloudy) = 60\)</span>%.
Imagine, you would repeat the observation series on another 20 days.
Due to random fluctuations, you would get a more or less different series and different estimates for the probability of rain.
More generally, the <em>true</em> parameter is only imperfectly represented by any sample, it is not unlikely, that it is close to the estimate, but it could be somewhere else, for example, <span class="math inline">\(P(rain|cloudy) = 56.124\)</span>%.</p>
<p>The trust you put in your estimation is called <em>level of certainty</em> or <em>belief</em> or <em>confidence</em>.
It is the primary aim of statistics to rationally deal with uncertainty, which involves to <em>measure the level of certainty</em> associated with any statement derived from teh data.
So, what would be a good way to determine certainty?
Think for a moment.
If you were asking an expert, how would you do that to learn about magnitude and uncertainty regarding <span class="math inline">\(P(rain|cloudy)\)</span>?</p>
<p>Maybe, the conversation would be as follows:</p>
<blockquote>
<p>YOU: What is the chance of rain, when it’s cloudy.</p>
</blockquote>
<blockquote>
<p>EXPERT: Wow, difficult question.
I don’t have a definite answer.</p>
</blockquote>
<blockquote>
<p>YOU: Oh, c’mon.
I just need a rough answer.
Is it more like 50%-ish, or rather 70%-ish.</p>
</blockquote>
<blockquote>
<p>EXPERT: Hmm, maybe somewhere between 50 and 70%.</p>
</blockquote>
<blockquote>
<p>YOU: Then, I guess, taking an umbrella with me is the rational choice of action.</p>
</blockquote>
<p>Note how the expert gave two endpoints for the parameter in question, to indicate the location and the level of uncertainty.
If she had been more certain, she had said "between 55 and 65%. While this is better than nothing, it remains unclear, which level of uncertainty is enclosed. Is the expert 100%, 90% or just 50% sure the true chance is in the interval? Next time, you could ask as follows:</p>
<blockquote>
<p>…</p>
</blockquote>
<blockquote>
<p>EXPERT: Hmm, maybe somewhere between 70-90%</p>
</blockquote>
<blockquote>
<p>YOU: What do you bet?
I’m betting 5 EUR that the true parameter is outside the range you just gave.</p>
</blockquote>
<blockquote>
<p>EXPERT: I dare you!
95 EUR it’s inside!</p>
</blockquote>
<p>The expert feels 95% certain, that the parameter in question is in the interval.
However, for many questions of interest, we have no expert at hand (or we may not even trust them altogether).
Then we proceed with option 3: making our own observations.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="ebs.html#cb140-1"></a><span class="kw">detach</span>(Rainfall)</span></code></pre></div>
</div>
<div id="benchmarking-designs" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Benchmarking designs</h3>
<p>The most basic decision in practical design research is whether a design fulfills an external criterion.
External criteria for human performace in a human-machine system are most common, albeit not abundant, in safety-critical domains.</p>
<p>Consider Jane: she is user experience researcher at the mega-large rent-a-car company smartr.car.
Jane was responsible for a overhaul of the customer interface for mobile users.
Goal of the redesign was to streamline the user interface, which had grown wild over the years.
Early customer studies indicated that the app needed a serious visual de-cluttering and stronger funneling of tasks.
300 person months went into the re-development and the team did well: a recent A/B study had shown that users learned the smartr.car v2.0 fast and could use its functionality very efficiently.
Jane’s team is prepared for the roll-out, when Marketing comes up with the following request:</p>
<blockquote>
<p>Marketing: We want to support market introduction with the following slogan: “rent a car in 99 seconds”.</p>
</blockquote>
<blockquote>
<p>Jane: Not all users manage a full transaction in that short time.
That could be a lie.</p>
</blockquote>
<blockquote>
<p>Marketing: Legally, the claim is fine if it holds on average.</p>
</blockquote>
<blockquote>
<p>Jane: That I can find out for you.</p>
</blockquote>
<p>Jane takes another look at the performance of users in the smartr car v2.0 condition.
As she understands it, she has to find out whether the average of all recorded time-on-tasks with smartr.car 2.0 is 99 seconds, or better.
Here is how the data looks like:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="ebs.html#cb141-1"></a><span class="kw">attach</span>(Sec99)</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="ebs.html#cb142-1"></a>Ver20 <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb142-2"><a href="ebs.html#cb142-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ToT)) <span class="op">+</span></span>
<span id="cb142-3"><a href="ebs.html#cb142-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/seconds_99_1-1.png" width="90%" /></p>
<p>The performance is not completely off the 99 seconds, many users are even faster.
Jane figures out that she has to ask a more precise question, first, as teh slogan can mean different things, like:</p>
<ul>
<li>all users can do it within 99 seconds</li>
<li>at least one user can do it</li>
<li>half of the users can do it</li>
</ul>
<p>Jane decides to go the middle way and chooses the population average, hence the average ToT must not be more than 99 seconds.
Unfortunately, she had only tested a small minority of users and therefore cannot be certain about the true average:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="ebs.html#cb143-1"></a><span class="kw">mean</span>(Ver20<span class="op">$</span>ToT)</span></code></pre></div>
<pre><code>## [1] 106</code></pre>
<p>Because the sample average is an uncertain, Jane is afraid, Marketing could use this as an argument to ignore the data and go with the claim.
Jane sees no better way as quantifying the chance of being wrong using a statistical model, which will later become known as the <em>Grand Mean Model</em>)</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="ebs.html#cb145-1"></a>M_<span class="dv">1</span> &lt;-<span class="st"> </span></span>
<span id="cb145-2"><a href="ebs.html#cb145-2"></a><span class="st">  </span>Ver20 <span class="op">%&gt;%</span><span class="st">    </span></span>
<span id="cb145-3"><a href="ebs.html#cb145-3"></a><span class="st">  </span><span class="kw">stan_glm</span>(ToT <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> .)</span>
<span id="cb145-4"><a href="ebs.html#cb145-4"></a></span>
<span id="cb145-5"><a href="ebs.html#cb145-5"></a>P_<span class="dv">1</span> &lt;-</span>
<span id="cb145-6"><a href="ebs.html#cb145-6"></a><span class="st">  </span><span class="kw">posterior</span>(M_<span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="ebs.html#cb146-1"></a><span class="kw">coef</span>(P_<span class="dv">1</span>)</span></code></pre></div>
<table>
<caption>(#tab:seconds_99_3)Estimates with 95% credibility limits</caption>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">parameter</th>
<th align="left">type</th>
<th align="left">fixef</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">M_1</td>
<td align="left">Intercept</td>
<td align="left">fixef</td>
<td align="left">Intercept</td>
<td align="right">106</td>
<td align="right">99.8</td>
<td align="right">112</td>
</tr>
</tbody>
</table>
<p>Let’s see what the GMM reports about the population average and its uncertainty: The table above is called a <em>CLU table</em>, because it reports three estimates per coefficient:</p>
<ul>
<li>Center, which (approximately) is the most likely position of the true value</li>
<li>Lower, which is the lower 95% credibility limit. There is a 2.5% chance that the true value is lower</li>
<li>Upper, the 95% upper limit. The true value is larger than this with a chance of 2.5%.</li>
</ul>
<p>This tell Jane that most likely the average time-on-task is <span class="math inline">\(Intercept\)</span>.
That is not very promising, and it is worse: 99 is even below the lower 95% credibility limit.
So, Jane can send a strong message: The probability that this claim is justified, is smaller than 2.5%.</p>
<p>Luckily, Jane had the idea that the slogan could be changed to <em>“rent a card in 1-1-1 seconds”</em>.
The 95% credibility limits are in her favor, since 111 is at the upper end of the credibility limit.
It would be allowed to say that the probability to err is not much smaller than 2.5%.
But Jane desires to make an accurate statement.
But what precisely is the chance that the true population average is 111 or lower?
In Bayesian analysis there is a solution to that.
When estimating such a model, we get the complete distribution of certainty, called the posterior distribution.
In fact, a CLU table with 95% credibility limits is just a summary on the posterior distribution.
This distribution is not given as a function, but has been generated by a (finite) random walk algorith, known as Markov-Chain Monte Carlo.
At every step (or most, to be precise), this algorithm jumps to another set of coordinates in parameter space and a frequency distribution arises that can be used to approximate levels of certainty.
The following illustration shows the posterior frequency distribution of the coefficient, divided into the two possible outcomes.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ebs.html#cb147-1"></a>P_<span class="dv">1</span> <span class="op">%&gt;%</span></span>
<span id="cb147-2"><a href="ebs.html#cb147-2"></a><span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">==</span><span class="st"> &quot;Intercept&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb147-3"><a href="ebs.html#cb147-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">outcome =</span> <span class="kw">ifelse</span>(value <span class="op">&lt;=</span><span class="st"> </span><span class="dv">111</span>, </span>
<span id="cb147-4"><a href="ebs.html#cb147-4"></a>                          <span class="st">&quot;111 seconds or shorter&quot;</span>, </span>
<span id="cb147-5"><a href="ebs.html#cb147-5"></a>                          <span class="st">&quot;longer than 111 seconds&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb147-6"><a href="ebs.html#cb147-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> outcome)) <span class="op">+</span></span>
<span id="cb147-7"><a href="ebs.html#cb147-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/rational_design_risk_of_failure-1.png" width="90%" /></p>
<p>In the present case, we can derive the chance that the true average of the customer population is lower than the target of 111:</p>
<p>In a similar manner to how the graph above was produced, a precise certainty level can be estimated from the MCMC frequency distribution contained in the posterior object.
The certainty that the 111 seconds slogan holds is much better:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="ebs.html#cb148-1"></a>P_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb148-2"><a href="ebs.html#cb148-2"></a><span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">==</span><span class="st"> &quot;Intercept&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb148-3"><a href="ebs.html#cb148-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">certainty =</span> <span class="kw">mean</span>(value <span class="op">&lt;=</span><span class="st"> </span><span class="dv">111</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">certainty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.935</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ebs.html#cb149-1"></a><span class="kw">detach</span>(Sec99)</span></code></pre></div>
<p>The story of Jane is about decision making under risk and under uncertainty.
We have seen how easily precise statements on uncertainty can be derived from a statistical model.
But regarding rational decision making, this is not an ideal story: What is missing is a systematic analysis of losses (and wins).
The benefit of going with the slogan has never been quantified.
How many new customers it will really attract and how much they will spend cannot really be known upfront.
Let alone, predicting the chance to loose in court and what this costs are almost unintelligeable.
The question must be allowed, what good is the formula for utility, when it is practically impossible to determine the losses.
And if we cannot estimate utilities, what are the certainties good for?</p>
<p>Sometimes, one possible outcome is just so bad, that the only thing that practically matters, is to avoid it at any costs.
Loosing a legal battle often falls into this category and the strategy of Marketing/Jane effectively reduced this risk: they dismissed a risky action, the 99 seconds statement, and replaced it with a slogan that they can prove is true with good certainty.</p>
<p>In general, we can be sure that there is at least some implicit calculation of utilities going on in the minds of Marketing.
Perhaps, that is a truly intuitive process, which is felt as an emotional struggle between the fear of telling the untruth and love for the slogan.
This utility analysis probably is inaccurate, but that does not mean it is completely misleading.
A rough guess always beats complete ignorance, especially when you know about the attached uncertainty.
Decision-makers tend to be pre-judiced, but even then probabilities can help find out to what extent this is the case: Just tell the probabilities and see who listens.</p>
</div>
<div id="comparing-designs" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Comparison of designs</h3>
<p>The design of systems can be conceived as a choice between design options.
For example, when designing an informational website, you have the choice of making the navigation structure flat or deep.
Your choice will change usability of the website, hence your customer satisfaction, rate of recurrence, revenue etc.
Much practical design research aims at making good choices and from a statistical perspective that means to compare the outcomes of two (or more) design option.
A typical situation is to compare a redesign with its predecessor, which will now be illustrated by a hypothetical case:</p>
<p>Violet is a manager of an e-commerce website and at present, a major overhaul of the website is under debate.
The management team agrees that this overhaul is about time and will most likely increase the revenue per existing customer.
Still, there are considerable development costs involved and the question arises whether the update will pay itself in a reasonable time frame.
To answer this question, it is not enough to know that revenues increase, but an more accurate prediction of <em>how much precisely</em> is gained.
In order to return the investment, the increase must be in the ballpark of 10% increase in revenue.
For this purpose, Violet carries out a user study to compare the two designs.
Essentially, she observes the transactions of 50 random customers using the current system with 50 transactions with a prototype of the new design.
The measured variable is the money every user spends during the visit.
The research question is: <em>By how much do revenues increase in the prototype condition?</em>.
The figure below shows the distribution of measured revenue in the experiment.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="ebs.html#cb150-1"></a><span class="kw">attach</span>(Rational)</span></code></pre></div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ebs.html#cb151-1"></a>RD  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb151-2"><a href="ebs.html#cb151-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Euro, <span class="dt">fill =</span> Design)) <span class="op">+</span></span>
<span id="cb151-3"><a href="ebs.html#cb151-3"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/rational_design_1-1.png" width="90%" /></p>
<p>There seems to be a slight benefit for the prototype condition.
But, is it a 10% increase?
The following calculation shows Violet that it could be the case:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="ebs.html#cb152-1"></a>RD <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb152-2"><a href="ebs.html#cb152-2"></a><span class="st">  </span><span class="kw">group_by</span>(Design) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb152-3"><a href="ebs.html#cb152-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_revenue =</span> <span class="kw">mean</span>(Euro))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Design</th>
<th align="right">mean_revenue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">current</td>
<td align="right">49.9</td>
</tr>
<tr class="even">
<td align="left">proto</td>
<td align="right">56.3</td>
</tr>
</tbody>
</table>
<p>Like in the previous case, testing only a sample of 100 users out of the whole population leaves room for uncertainty.
So, how certain can Violet be?
A statistical model can give a more complete answer, covering the magnitude of the improvement, as well as a level of certainty.
Violet estimates a model that compares the means of the two conditions <a href="lm.html#cgm">4.3.1</a>, assuming that the randomness in follows a Gamma distribution <a href="glm.html#exp-gam-reg">6.3.1</a>.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="ebs.html#cb153-1"></a><span class="kw">library</span>(rstanarm)</span>
<span id="cb153-2"><a href="ebs.html#cb153-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb153-3"><a href="ebs.html#cb153-3"></a><span class="kw">library</span>(bayr)</span>
<span id="cb153-4"><a href="ebs.html#cb153-4"></a></span>
<span id="cb153-5"><a href="ebs.html#cb153-5"></a>M_<span class="dv">1</span> &lt;-<span class="st"> </span></span>
<span id="cb153-6"><a href="ebs.html#cb153-6"></a><span class="st">  </span>RD <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb153-7"><a href="ebs.html#cb153-7"></a><span class="st">  </span><span class="kw">stan_glm</span>(Euro <span class="op">~</span><span class="st"> </span>Design, </span>
<span id="cb153-8"><a href="ebs.html#cb153-8"></a>           <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb153-9"><a href="ebs.html#cb153-9"></a>      <span class="dt">data =</span> .)</span>
<span id="cb153-10"><a href="ebs.html#cb153-10"></a></span>
<span id="cb153-11"><a href="ebs.html#cb153-11"></a>P_<span class="dv">1</span> &lt;-<span class="st">  </span><span class="kw">posterior</span>(M_<span class="dv">1</span>)</span></code></pre></div>
<p>The coefficients of the Gamma model are on a logarithmic scale, but when exponentiated, they can directly be interpreted as multiplications <a href="glm.html#speaking-multipliers">6.2.1.1</a>.
That precisely matches the research question, which is stated as percentage increase, rather than a difference.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="ebs.html#cb154-1"></a><span class="kw">coef</span>(P_<span class="dv">1</span>, <span class="dt">mean.func =</span> exp)</span></code></pre></div>
<table>
<caption>(#tab:rational_design_3)Estimates with 95% credibility limits</caption>
<thead>
<tr class="header">
<th align="left">parameter</th>
<th align="left">fixef</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="left">Intercept</td>
<td align="right">49.90</td>
<td align="right">46.99</td>
<td align="right">53.05</td>
</tr>
<tr class="even">
<td align="left">Designproto</td>
<td align="left">Designproto</td>
<td align="right">1.13</td>
<td align="right">1.04</td>
<td align="right">1.23</td>
</tr>
</tbody>
</table>
<p>The results tell Violet that, most likely, the average user spends 49.904 Euro with the current design.
The prototype seems to increase the revenue per transaction by a factor of <span class="math inline">\(1.127\)</span>.
That would be a sufficient increase, however this estimate comes from a small sample of users and there remains a considerable risk, that the true improvement factor is much weaker (or stronger).
The above coefficient table tells that with a certainty of 95% the true value lies between <span class="math inline">\(1.039\)</span> and <span class="math inline">\(1.225\)</span>.
But, what precisely is the risk of the true value being lower than 1.1?
This information can be extracted from the model (or the posterior distribution):</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="ebs.html#cb155-1"></a>N_risk_of_failure &lt;-</span>
<span id="cb155-2"><a href="ebs.html#cb155-2"></a><span class="st">  </span>P_<span class="dv">1</span> <span class="op">%&gt;%</span></span>
<span id="cb155-3"><a href="ebs.html#cb155-3"></a><span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">==</span><span class="st"> &quot;Designproto&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb155-4"><a href="ebs.html#cb155-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">risk_of_failure =</span> <span class="kw">mean</span>(<span class="kw">exp</span>(value) <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.1</span>))</span>
<span id="cb155-5"><a href="ebs.html#cb155-5"></a>N_risk_of_failure</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">risk_of_failure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.284</td>
</tr>
</tbody>
</table>
<p>The risk of failure is just below 30%.
With this information in mind Violet now has several options:</p>
<ol style="list-style-type: decimal">
<li>deciding that 28.425% is a risk she <em>dares</em> to take and recommend going forward with the development</li>
<li><em>continue testing</em> more users to reach a higher level of certainty</li>
<li>improve the model by taking into account sources of evidence from the past, i.e. <em>prior knowledge</em></li>
</ol>
<!-- The first option represents an unspecific tolerance towards risk. Extreme risk tolerance of managers became is infamous as one cause for large scale economic crises [BLACK_SWANs]. Her motives could be manifold, still: maybe she was nursed to take risks in her life; or she is confident that consequences in case of failure will be bearable. -->
<!-- The second and third options have one thing in common: they make use of *external knowledge*. This is explained in the coming section. The fourth option is another way of making *cumulative use of knowledge*, namely *[adaptive testing: find correct term]*.  -->
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="ebs.html#cb156-1"></a><span class="kw">detach</span>(Rational)  </span></code></pre></div>
</div>
<div id="prior-knowledge" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Prior knowledge</h3>
<p>It is rarely the case that we encounter a situation as a <em>blank slate</em>.
Whether we are correct or not, when we look at the sky in the morning, we have some expectations on how likely there will be rain.
We also take into account the season and the region and even the very planet is sometimes taken into account: the Pathfinder probe carried a bag of high-tech gadgets to planet Mars. However, the included umbrella was for safe landing only, not to cover from precipitation, as Mars is a dry planet.</p>
<p>In most behavioral research it still is the standard that every experiment had to be judged on the produced data alone.
For the sake of objectivity, researchers were not allowed to take into account previous results, let alone their personal opinion.
In Bayesian statistics, you have the choice.
You can make use of external knowledge, but you don’t have to.</p>
<p>Violet, the rational design researcher has been designing and testing e-commerce systems for many years and has supervised several large scale roll-outs.
So the current project is not a new situation, at all.
From the top of her head, Violet produces the following table to capture her past twenty projects and the increase in revenue that had been recorded afterwards.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="ebs.html#cb157-1"></a><span class="kw">attach</span>(Rational)</span></code></pre></div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="ebs.html#cb158-1"></a>D_prior <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">8</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">project</th>
<th align="right">revenue_increase</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">19</td>
<td align="right">1.041</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="right">1.072</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">1.003</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="right">0.998</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="right">1.037</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">1.014</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="right">0.979</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">1.016</td>
</tr>
</tbody>
</table>
<p>On this data set, Violet estimates another grand mean model that essentially captures prior knowledge about revenue increases after redesign:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="ebs.html#cb159-1"></a>M_prior &lt;-</span>
<span id="cb159-2"><a href="ebs.html#cb159-2"></a><span class="st">  </span>D_prior <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb159-3"><a href="ebs.html#cb159-3"></a><span class="st">  </span><span class="kw">stan_glm</span>(revenue_increase <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb159-4"><a href="ebs.html#cb159-4"></a>           <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb159-5"><a href="ebs.html#cb159-5"></a>           <span class="dt">data =</span> .,</span>
<span id="cb159-6"><a href="ebs.html#cb159-6"></a>           <span class="dt">iter =</span> <span class="dv">5000</span>)</span>
<span id="cb159-7"><a href="ebs.html#cb159-7"></a></span>
<span id="cb159-8"><a href="ebs.html#cb159-8"></a>P_prior &lt;-<span class="st"> </span><span class="kw">posterior</span>(M_prior)</span></code></pre></div>
<p><em>Note</em> that the above model is a so called Generalized Linear Model with a Gamma shape of randomness, which will be explained more deeply in chapter <a href="glm.html#duration-measures">6.3</a>.</p>
<p>The following CLU table shows the results.
The mean increase was Intercept and without any further information, this is the best guess for revenue increase in any future projects (of Violet).
A statistical model that is based on such a small number of observations usually produces very uncertain estimates, which is why the 95% credibility limits are wide.
There even remains a considerable risk that a project results in a decrease of revenue, although that has never been recorded.
(In Gamma models coefficients are usually multiplicative, so a coefficient <span class="math inline">\(&lt;1\)</span> is a decline).</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ebs.html#cb160-1"></a><span class="kw">coef</span>(P_prior, <span class="dt">mean.func =</span> exp)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-20">Table 3.1: </span>Estimates with 95% credibility limits</caption>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">parameter</th>
<th align="left">type</th>
<th align="left">fixef</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">M_prior</td>
<td align="left">Intercept</td>
<td align="left">fixef</td>
<td align="left">Intercept</td>
<td align="right">1.02</td>
<td align="right">0.882</td>
<td align="right">1.18</td>
</tr>
</tbody>
</table>
<p>Or graphically, we can depict the belief as follows:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="ebs.html#cb161-1"></a>P_prior <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb161-2"><a href="ebs.html#cb161-2"></a><span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">==</span><span class="st"> &quot;Intercept&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb161-3"><a href="ebs.html#cb161-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">exp</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb161-4"><a href="ebs.html#cb161-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></span>
<span id="cb161-5"><a href="ebs.html#cb161-5"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span></span>
<span id="cb161-6"><a href="ebs.html#cb161-6"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Strength of belief&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/previous_belief_in_revenue-1.png" width="90%" /></p>
<p>The population average (of projects) is less favorable than what Violet saw in her present experiment.
If the estimated revenue on the experimental data is correct, it would be a rather extreme outcome.
And that is a potential problem, because extreme outcomes are rare.
Possibly, the present results are overly optimistic (which can happen by chance) and do not represent the true change revenue, i.e. on the whole population of users.
In Bayesian Statistics, mixing present results with prior knowledge is a standard procedure to correct this problem.
In the following step, she uses the (posterior) certainty from M_prior and employs it as prior information (by means of a Gaussian distribution).
Model M_2 has the same formula as M_1 before, but combines the information of both sources, data and prior certainty.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="ebs.html#cb162-1"></a>T_prior &lt;-<span class="st"> </span></span>
<span id="cb162-2"><a href="ebs.html#cb162-2"></a><span class="st">  </span>P_prior <span class="op">%&gt;%</span></span>
<span id="cb162-3"><a href="ebs.html#cb162-3"></a><span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">==</span><span class="st"> &quot;Intercept&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb162-4"><a href="ebs.html#cb162-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value), <span class="dt">sd =</span> <span class="kw">sd</span>(value))</span>
<span id="cb162-5"><a href="ebs.html#cb162-5"></a></span>
<span id="cb162-6"><a href="ebs.html#cb162-6"></a>M_<span class="dv">2</span> &lt;-</span>
<span id="cb162-7"><a href="ebs.html#cb162-7"></a><span class="st">  </span><span class="kw">stan_glm</span>(<span class="dt">formula =</span> Euro <span class="op">~</span><span class="st"> </span>Design, </span>
<span id="cb162-8"><a href="ebs.html#cb162-8"></a>      <span class="dt">prior_intercept =</span> <span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb162-9"><a href="ebs.html#cb162-9"></a>      <span class="dt">prior =</span> <span class="kw">normal</span>(T_prior[[<span class="dv">1</span>,<span class="dv">1</span>]], T_prior[[<span class="dv">1</span>,<span class="dv">2</span>]]),</span>
<span id="cb162-10"><a href="ebs.html#cb162-10"></a>      <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb162-11"><a href="ebs.html#cb162-11"></a>      <span class="dt">data =</span> RD)</span>
<span id="cb162-12"><a href="ebs.html#cb162-12"></a></span>
<span id="cb162-13"><a href="ebs.html#cb162-13"></a>P_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">posterior</span>(M_<span class="dv">2</span>)</span></code></pre></div>
<p><em>Note</em> that the standard deviation here is saying how the strength of belief is distributed for the average revenue.
It is not the standard deviation in the a population of projects.</p>
<table>
<caption><span id="tab:unnamed-chunk-23">Table 3.2: </span>Estimates with 95% credibility limits</caption>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">parameter</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">M_1</td>
<td align="left">Designproto</td>
<td align="right">1.13</td>
<td align="right">1.04</td>
<td align="right">1.23</td>
</tr>
<tr class="even">
<td align="left">M_2</td>
<td align="left">Designproto</td>
<td align="right">1.10</td>
<td align="right">1.02</td>
<td align="right">1.19</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="ebs.html#cb163-1"></a>P_comb <span class="op">%&gt;%</span></span>
<span id="cb163-2"><a href="ebs.html#cb163-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> model, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb163-3"><a href="ebs.html#cb163-3"></a><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb163-4"><a href="ebs.html#cb163-4"></a><span class="st">  </span><span class="kw">geom_crossbar</span>(<span class="dt">data =</span> <span class="kw">coef</span>(P_comb),</span>
<span id="cb163-5"><a href="ebs.html#cb163-5"></a>                <span class="kw">aes</span>(<span class="dt">y =</span> center, <span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper),</span>
<span id="cb163-6"><a href="ebs.html#cb163-6"></a>                <span class="dt">width =</span> <span class="fl">.05</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-24-1.png" width="90%" /></p>
<p>Model M_2 reduces the estimated expected revenue by a small amount.
But, remember that Violet has to meet the criterion of 110% in revenue.
In the following she extracts the risk of failure (revenue smaller than 110%) from the posterior distribution.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="ebs.html#cb164-1"></a>P_comb <span class="op">%&gt;%</span></span>
<span id="cb164-2"><a href="ebs.html#cb164-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">outcome =</span> value <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.1</span>) <span class="op">%&gt;%</span></span>
<span id="cb164-3"><a href="ebs.html#cb164-3"></a><span class="st">  </span><span class="kw">group_by</span>(model) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb164-4"><a href="ebs.html#cb164-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">risk_to_fail =</span> <span class="kw">mean</span>(outcome))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">risk_to_fail</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">M_1</td>
<td align="right">0.284</td>
</tr>
<tr class="even">
<td align="left">M_2</td>
<td align="right">0.512</td>
</tr>
</tbody>
</table>
<p>So what should Violet report to decision makers?
Something like this: "The data from the study us that our chance of success is around two-thirds. <em>However</em>, in my long career I have never actually reached such an increase in revenue, so I’d rather say, chance of success is more around 50%.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="ebs.html#cb165-1"></a><span class="kw">detach</span>(Rational)</span></code></pre></div>
<!-- ## What is wrong with classic statistics? [TBC] -->
<!-- The short version of the story is this: in face of typically noisy data, there is always the risk that  experimental data supports a certain hypothesis, seemingly. If the researcher calls the results supportive, although they were just due to randomness, this is called a *false alarm*. Many scientific disciplines have therefore committed to keep the overall number of false alarms under a threshold, for example 5%.  -->
<!-- The even shorter version is that voluntary commitment failed. The true rate of false alarms is about a magnitude higher. -->
<!-- The p-value [...] Imagine giant replication study that showed that 35% of published psychology studies are not replicable. In fact, such a study exists and it has far-reaching consequences. [...]  [REF] shows that rejection bias is one reason: studies that have not reached the *magic .05 level* of significance, have a lower chance of publication. [REF] sees as a reason that author's implicitly trick the system by *the garden of forking paths*  strategy. The research project collects an array of variables, followed by a fishing expenditure. Theory is conveniently considered last, but written up in  a pseudo-a prior way. -->
</div>
</div>
<div id="observations-measures" class="section level2">
<h2><span class="header-section-number">3.2</span> Observations and measures</h2>
<p>The statistical models presented in this book have in common, that there is exactly one measure, which we call the <em>outcome</em>. In design research, outcome variables directly represent the current value of a design, or an aspect of it. This section provides an overview on the types of outcome variables.</p>
<div id="interaction-seq" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Interaction sequences</h3>
<p>A general concept in design is to think of purposes as <em>user tasks</em>.
A user task can be defined as an initial state, a desired outcome and a procedure to get there.
The knowledge required to follow the procedure can be found in two major locations: the users mind (mental model) and the interface (design model).
A principle of user-centered design is to create a design model that matches the users current representation of the task, or easily enters the users mind, at least.
The first is called <em>intuitiveness</em> of a design, the latter <em>ease-of-learning</em>.</p>
<p>A highly intuitive design matches the users mental model, and can be used out-of-the-box, without the requirement to instruct or train a user.
Intuitiveness relies on the match between design and mental model.
Whereas the design model is explicit, the mental model needs to be elicited from the users mind.
Eliciting procedural mental models is difficult.
You may think it is sufficient to just ask users about the idea of a procedure, but that is a limited approach.
If I ask you about the precise steps in preparing a cup of coffee in your kitchen, that probably is a more demanding and error-prone than to ask you to prepare an actual cup of coffee.
Two reasons make up for this discrepancy:</p>
<ol style="list-style-type: decimal">
<li>The human mind has separate facilities for procedural knowledge and declarative knowledge. If I ask you about a procedure, you first have to make a translation.</li>
<li>The more automated a task is, the less available it is to your conscious mind.</li>
</ol>
<p>Our ability to verbalize our actions are limited.
If there were no such verbalization limit, designing for tasks would be simple: just ask!
Only mind-reading is more convenient.
In user-centered design verbal inquiries are a central method.
But, results from user interviews can be incomplete or biased.</p>
<p>An example for incompleteness is that users sometimes fail to report what they think is obvious.
For example, in modern computer desktop applications a function to undo a step is standard and probably it is one of the most frequently used functions.
In other types of systems, for example data-base driven information systems, implementing an Undo function is non-trivial, because data base records can be changed by multiple users.
It can be implemented by so-called roll-back mechanisms, but these reduce performance and storage capacity of the system.
When collecting user requirements for such a system, the developer has little interest in Undo, whereas the user has a huge interest, but does not mention it. If that is not resolved during the design process, there will be trouble.</p>
<p>Verbal reports of action sequences are often incomplete.
But, if there is something even worse, then it is the limited ability of humans to imagine new situations, or novel ways of doing something.
Imagine you had a time machine and you would travel back to the year 1981, which is a year before the series Knight Rider went on broadcast.
If you would ask car drivers from that era, how they would envision a navigation assistant device, you would probably end up with something that looks more like a Star Trek computer console than with anything comparable to modern navigation device.</p>
<p>This why one central principle of user-centered design is the <em>direct observation</em> of users.
By directly observing how a person prepares a cup of coffee, we can learn about the details of behavior and close the verbalization gap.
By observing many action sequences, we can carve out detailed user requirements, or fix an existing design.
Observing user interactions does not require one-way mirrors and nights of video coding.
Because of the verbalization gap, a lot can be learned just by watching over the users shoulder.
The method of <em>think-aloud usability testing</em> even goes one step further and combines behavior observation with verbalization.</p>
<p>Interaction sequences can sometimes be collected without a human observer.
Log files of web servers provide sequences of users navigating web site.
Plugin software is available that records keystrokes and mouse actions on computers.
The difficult part is the following: When observing 50 users while doing a non-trivial task, no two interaction sequences are exactly the same (if i had to bet on it).
By itself, there is little value without further means of interpretation and this can go two ways up: qualitative and quantitative.</p>
<p>The <em>qualitative design researcher</em> will collect interaction sequences, as well as verbal reports and shuffle them around until an intelligible picture emerges.
One way to describe the purpose of user testing is to <em>find out all possible ways how things can go wrong.</em> Every break-down that is observed at least once in a sample of test users, tells a story of what may happen to hundreds or thousands of users in the future. That is why in early development phases, qualitative research rules.</p>
<!-- is not just an art, but also scientific at its heart.  -->
<!-- The diligent and skilled *qualitative* researchers are able to extract meaningful patterns from such sequences. For example, in usability tests, the following patterns are frequently observed and interpreted.   -->
<!-- + a user jumping back to the main screen felt being in a dead-end  -->
<!-- + a frowning user feels confused -->
<!-- +  -->
<p>The <em>quantitative</em> researcher will aim at deriving measures from the interaction sequence.
Formally, <em>to measure</em> means assigning numbers to observed sequences, so that these can be brought into an <em>order</em>, at least.
If the original data is qualitative, we need some method of transformation that gives us measures.</p>
<p>Sometimes, you have to go a long way up the qualitative route, before you can derive useful measures.
In <span class="citation">(Schnittker et al. 2016)</span> we coded sequences from nurses using an infusion pump.
Individual sequences were compared to a optimal reference path. The closer a user stays on this path, the better.
But how to measure similarity?
We used the <em>Levensthein distance</em>, which takes two sequences, the optimal patzh and the observed path and determines the minimum number of edits to transform one sequence into the other. This results in a score for error proneness, the <em>deviation from optimal path</em>.</p>
<p>Another example is a study we did on the active user paradox.
We recorded interaction sequences of users doing editing tasks with a graphics software.
The sessions were recorded and analysed using a behavioural coding scheme.
First, events were classified on a low level (e.g. “reading the handbook”, “first time trying a function”) and later aggregated to broader classes (e.g. “exploratory behavior”).
The number of exploratory events then served as a measure for the exploratory tendencies of the participant.</p>
</div>
<div id="perf-measures" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Performance measures</h3>
<p>User errors are qualitative by nature and need a transformation to be used as outcome variables. Other aspects of performance can be measured directly. A useful framework for outcome measures is the classic concept of <em>usability</em>, which the ISO 9142-11 defines by the following three high-level criteria:</p>
<ul>
<li>effectiveness: can users accomplish their tasks?</li>
<li>efficiency: what resources have to be spend for a task, e.g. time.</li>
<li>satisfaction: how did the user like it?</li>
</ul>
<p>While these criteria originated in the field of Human-Computer Interaction, they can easily be adapted to compare everything that people do their work with.
Even within the field, it has been adapted to hundreds of studies and a hundred ways are reported of assessing these criteria.</p>
<p><em>Effectiveness</em> is often measured by <em>completion rate (CR)</em>.
A classic waterfall approach would be to consult the user requirements documents and identify the, let’s say eight, crucial tasks the system must support.
User test might then show that most users fail at the two tasks, and a completion rate of 75% is recorded for the system.
Completion rate is only a valid effectiveness measure with <em>distinct tasks</em>.
Strictly, the set of tasks also had to be <em>complete</em>, covering the whole system.
When completion rate is taken from in series of <em>repetitive tasks</em>, it depends on whether it is effectiveness or efficiency.
It is effectiveness, when a failed operation is unrepairable, such as a traffic accident, data loss on a computer or medical errors.
But, who cares for a single number between 0 and 1, when the user test provides such a wealth of information on <em>why</em> users failed?
Effectiveness, in the sense of task completion, is primarily a qualitative issue and we shall rarely encounter it in this book.</p>
<p>A more subtle notion of effectiveness is the <em>quality of outcome</em>, and despite the very term, it is a measure. (Perhaps, it should better be called <em>level of perfection</em>.)
Reconsider the AUP study, where participants had to modify a given graphic, e.g. change some colors and erase parts of it.
Of course, some participants worked neatly, whereas others used broader strokes (literally).
There are several ways to rank all results by quality and thereby create an outcome variable.</p>
<p><em>Efficiency</em> is where it really gets quantitative as we ask about resources: time, attention, strain, distraction and Euros.
Efficiency can be measured in a variety of ways: time-on-task (ToT), clicks, mental workload or time spent watching the traffic while driving.</p>
<p>Counting the <em>number of clicks</em> before someone has found the desired piece of information is a coarse, but easy to acquire and intuitive measure of efficiency, and so is <em>time-on-task (ToT)</em>.
<!-- Still, these It differs from ToT in that it only counts real action, not the time a participant read the manual or watched the sky. -->
<!-- In the downside, this is a very limited definition of action. -->
<!-- While errors are usually best analyzed qualitatively, *error rate* can be efficiency, too, when failures are non-critical, but can be repaired in some time, such as correcting a typing error. --></p>
<p>ToT and other performance measures can be very noisy.
The general recipe to reduce noise and improve certainty is to collect more data.
The obvious way of doing this is by increasing the sample size, but that can be costly.
A more efficient way to reduce uncertainty with a given sample is to collect more data per participant, which is called <em>repeated measures</em>.
Chapter <a href="mlm.html#mlm">5</a> will introduce models that deal with repeated measures in a straight-forward way.</p>
<!-- Above, I did not mean to say that design research always requires the sometimes painful recording of interaction sequences. The majority of studies jumps over them and proceed to performance measures, directly, by counting attempts or pressing stop watches. -->
<p>Counting steps-to-completion or errors often requires the laborous process of interaction analysis.
Measures of duration are much easier to obtain and in many situations they are spot-on: In usability studies, <em>time-on-task</em> is a direct measure of efficiency.
When controlling a car in dense city traffic, a few hundred milliseconds is what makes huge a difference and therefore <em>reaction time</em> is a valid performance measure.
In experimental cognitive research reaction times have been succesfully used in countless experiments to reveal the structure of the mind.</p>
<!-- The Stroop tasks is a golden evergreen cognitive psychology and serves as an example. Participants are shown a words drawn in one of three ink colors and are asked to name the ink as quick as possible. The Stroop effect occurs: in the incongruent condition, participants respond much slower than in the congruent and neutral (a few hundred ms). There is ample sweet replication of this effect and an ecosystem of theories surround it. -->
<!-- black tower PC + "explore" -> "can someone hand me a screwdriver" -->
<!-- CONDITION WORD    : Ink -->
<!-- congruent [GREEN ]: green -->
<!-- incongr   [YELLOW]: green -->
<!-- neutral   [CHAIR ]: green -->
</div>
<div id="satisfaction-and-other-feelings" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Satisfaction and other feelings</h3>
<p>The standard definition of usability defines three levels of usability, the two performance-related effectiveness and efficiency, and satisfaction.
The latter has long been held the enfant terrible of the three.
That’s not a big surprise, as satisfaction is about the <em>feelings</em> of users.</p>
<p>Early research in the 1990s took enough with a few rating scales, that measure satisfaction, as the <em>absence of negative feelings</em>.
Later, when User Experience era took off, a wave of constructs and measures washed over the research community, here are just a few examples:</p>
<ul>
<li>beauty</li>
<li>hedonic quality</li>
<li>coolness</li>
<li>credibility</li>
<li>meaning of life</li>
</ul>
<p>Feelings are a tricky business when it comes to measuring them.
Most frequently, rating scales are employed, and often the same author makes the remark, that the study should be replicated with more objective measures for emotional states, such as physiological measures or implicit measures. However, I haven’t seen many studies where such measures produced good results.</p>
<!-- Unfortunately those do not exist. -->
<!-- Also, several authors took on the same construct, but called it differently, or the other way round. -->
<p>Despite all criticism, <em>self-report rating scales</em> are still the primary method of measuring feelings towards designs. Rating scale instruments exist for a variety of concepts, but they come in only a few forms: first, there exist single item or multi-item scales.
<em>Single-item</em> instruments are the hydrogen of rating scales.
Because they are so short, they cause little interruption and are therefore useful for obtaining repeated measures over time. That is very valuable, when the goal is to track feelings of an extended period of time.
For example, the effect of learning can be seen in a decline of cognitive workload over time.
From a methodological point-of-view, single-item scales are inferior, because many quality checks rest on having multiple items (see <a href="mlm.html#psychometrics">5.8</a>).</p>
<p><em>Multi-item</em> rating scales are the standard.
Participants or users respond to a number of statements, that have an overarching theme.
In contrast to single items, multi-item scales are amenable to a number of procedures for quality check, such as reliability.
<!-- In design research, measures of feelings are usually taken as design benchmarks. -->
<!-- It would be impractical to report responses of individual items. -->
Whereas a psychometric assessment requires the data on item level, for the purpose of design eveluation multi-item ratings are often aggregated total scores, such as the <em>average score</em>. However, aggregation always causes a loss in information and with the multi-level models presented in <a href="mlm.html#psychometrics">5.8</a>, this is also no longer required.</p>
<p>Next to the number of items, rating scale instruments differ in <em>cardinality of the response</em>, which is the number of possible responses to an item.
By far most rating scales use between four and nine <em>ordered bins</em>.
In contrast, so called <em>visual analog</em> rating scales measure on a continuum.
This can be done on paper, using a ruler to translate the response into numbers, or using a slider bar in a computer program.
<!-- That being said, one can also think of situations, where the answer is a simple Yes/No, such as for the question: Do you think you solved the task correctly? --></p>
<p>Finally, rating scales have either <em>unipolar or bipolar anchoring</em>.
Many rating scales put labels (instead of just numbers) on minimum and the maximum bins.
With a unipolar item, the left anchor is neutral, whereas the right is not, like in:</p>
<p>0: Dull … 1: Bliss</p>
<p>Dull is not the opposite of bliss, it is the absence of it. (Just like Zero is not the opposite of One.) one example of a bipolar scales is:</p>
<p>-1: Ugly … + 1: Beautiful</p>
<p>Another consideration with binned (rather than continuous) bipolar scales.
If such a scale has an uneven number, the center bin is neutral.</p>
<p>-1:Ugly … 0:Neutral … +1:Beautifuly</p>
<p>Sometimes, it is useful that participants have the opportunity for a neutral answer, for example, when the participant may just not know:</p>
<p>The help pages of the program are written in a clear language.</p>
<p>-1: Not at all … 0: I didn’t notice +1: … Totally</p>
<p>Especially with long questionnaires, it can happen that participants are getting bored an just always respond neutral. In such a case, an even number of bins, i.e. the absence of a neutral response, forces participants to make a choice of direction, at least.</p>
<p>What kind of rating scale you use has consequences for your statistical model.
As we will see in section <a href="mlm.html#psychometrics">5.8</a>, multi-level models are a good match for multi-item rating scales.
What also matters for the choice of model is whether you have been using a visual analog scale or a binned scale.
Data from visual analog scales is more easily treated, by either a Gaussian <a href="mlm.html#psychometrics">5.8</a> or a Beta linearized model <a href="glm.html#beta-reg">6.4.2</a>.
Both are relatively lean methods and easy to report.
For binned rating scales the complicated beast called ordinal logistic regression <a href="glm.html#ord-logist-reg">6.4.1</a> applies.
My advice would be to use visual analog scales, whenever possible, even if this means to not exactly following the original instructions for the scale.</p>
<p>While rating scales are prevalent for measuring feelings, that does not mean there are no other, more objective, ways.
There has been some buzz about <em>physiological measures</em>, like galvanic skin response or EEG, lately.
In our own lab, I have seen these measures fail more often than succeed for the evaluation of products (such as wine or floor cleaning robots).</p>
<p><em>Implicit measures</em> are means to assess certain attitudes or feelings by means of experimental setups.
For example, We once tried to measure technophile attitude (geekism) using a variant of the classic Stroop task.
In <span class="citation">(Schmettow, Noordzij, and Mundt 2013)</span> we showed pictures of computers to a samnple of students, followed by the Stroop task, which means that participants had to name the ink color of a color-printed word (e.g., “explore” in color Red).
It was conceived that reaction time increases when a participant experiences a strong association, like how good it felt to build a computer all by yourself.
The initial success was soon washed away by a failure to reproduce these results.
Another implicit method sometimes proposed is the Approach-Avoidance task, which has gotten some merits in research on addiction and racism.
In simple terms, participants (or users) are asked to push or pull a joystick and it seems that they pull faster, when they see something they like (a bottle of booze) and push faster when they dislike what they see (a photograph of war victims).
However, I have seen this approach failing to produce relevant results in a design comparison experiment.
Generally, such experiments produce reaction time differences below the 100ms mark and therefore many trials are needed to carve out any differences.
At the same time, I have doubts that the emotional reactions towards, say computer interfaces, play in the same league as the stimuli used in research on addiction or racism research.
Emotional responses in design research may just be too mellow to disturb cognitive processes with a strength that is measurable.</p>
<!-- The problem, I feel, is that too many reseachers base their research on feelings on their own feelings. That is not always wrong, if these feelings are well-reflected, like was the case when the apple fell on Newton's head or when  Mori discovered the Uncanny Valley effect. -->
<!-- ### Designs and Features [TBD] -->
<!-- ### the human factor [TBD] -->
</div>
</div>
<div id="descriptive-stats" class="section level2">
<h2><span class="header-section-number">3.3</span> Descriptive statistics</h2>
<p>In empirical research we systematically gather observations.
Observations of the same kind are usually subsumed as variables.
A set of variables that have been gathered on the same sample are called a data set, which typically is a table with variables in columns.
In the most general meaning, <em>a statistic</em> is a single number that somehow represents relevant features of a data set, such as:</p>
<ul>
<li>frequency: how many measures of a certain kind can be found in the data set?</li>
<li>mean: do measures tend to be located left (weak) or right (strong) on a scale?</li>
<li>variance: are measures close together or widely distributed along the scale?</li>
<li>association: does one variable X tend to change when another variable Y changes?</li>
</ul>
<div id="frequencies" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Frequencies</h3>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="ebs.html#cb166-1"></a><span class="kw">attach</span>(Sec99)</span></code></pre></div>
<p>The most basic statistics of all probably is the number of observations on a variable <span class="math inline">\(x\)</span>, usually denoted by <span class="math inline">\(n_{x}\)</span>.
The number of observations is a rough indicator for the amount of data that has been gathered.
In turn, more data usually results in better accuracy of statistics and higher levels of certainty can be reached.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="ebs.html#cb167-1"></a><span class="kw">length</span>(Ver20<span class="op">$</span>ToT)</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>The number of observations is not as trivial as it may appear at first.
In particular, it is usually not the same as the sample size, for two reasons: First, most studies employ repeated measures to some extent.
You may have invited <span class="math inline">\(N_\textrm{Part} = 20\)</span> participants to your lab, but each participant is tested on, let’s say, <span class="math inline">\(N_\textrm{Task} = 5\)</span> tasks, the number of observations is <span class="math inline">\(N_\textrm{Obs} = N_\textrm{Part}N_\textrm{Task} = 100\)</span>.
Second, taking a valid measure can always fail for a variety of reasons, resulting in <em>missing values (NA)</em>.
For example, in the 99 seconds study, it has happened, that a few participants missed to fill in their age on the intake form.
The researcher is left with fewer measures of age <span class="math inline">\(n_{age}\)</span> than there were participants.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="ebs.html#cb169-1"></a>N_obs &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(x))</span>
<span id="cb169-2"><a href="ebs.html#cb169-2"></a><span class="kw">N_obs</span>(Ver20<span class="op">$</span>age)</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Another important issue is the distribution of observations across groups.
Again, the number of observations in a group is linked to the certainty we can gain on statistics of that group.
Furthermore, it is sometimes important to have the distribution match the proportions in the population, as otherwise biases may occur.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="ebs.html#cb171-1"></a>Ver20 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb171-2"><a href="ebs.html#cb171-2"></a><span class="st">  </span><span class="kw">group_by</span>(Gender) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb171-3"><a href="ebs.html#cb171-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">n</span>())</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Gender</th>
<th align="right">n()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">female</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="left">male</td>
<td align="right">41</td>
</tr>
</tbody>
</table>
<p>The table above shows so called <em>absolute frequencies</em>.
Often, we have to compare frequencies of two groups of different size, it often is more appropriate to report <em>relative frequencies</em> or <em>proportions</em>:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="ebs.html#cb172-1"></a>n_Gender &lt;-<span class="st"> </span><span class="kw">N_obs</span>(Ver20<span class="op">$</span>Gender)</span>
<span id="cb172-2"><a href="ebs.html#cb172-2"></a></span>
<span id="cb172-3"><a href="ebs.html#cb172-3"></a>Ver20 <span class="op">%&gt;%</span></span>
<span id="cb172-4"><a href="ebs.html#cb172-4"></a><span class="st">  </span><span class="kw">group_by</span>(Gender) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb172-5"><a href="ebs.html#cb172-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">rel_freq =</span> <span class="kw">n</span>()<span class="op">/</span>n_Gender)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Gender</th>
<th align="right">rel_freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">female</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">male</td>
<td align="right">0.41</td>
</tr>
</tbody>
</table>
<p>Summarizing frequencies of metric measures, such as time-on-task (ToT) or number of errors is useful, too.
However, a complication arises by the fact that continuous measures do not naturally fall into groups.
Especially in duration measures no two measures are exactly the same.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="ebs.html#cb173-1"></a><span class="kw">length</span>(<span class="kw">unique</span>(Ver20<span class="op">$</span>Gender))</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="ebs.html#cb175-1"></a><span class="kw">length</span>(<span class="kw">unique</span>(Ver20<span class="op">$</span>ToT))</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>The answer to this problem is <em>binning</em>: the scale of measurement is divided into a number of adjacent sections, called bins, and all measures that fall into one bin are counted.
For example, we could use bins of 10 seconds and assess whether the bin with values larger than 90 and smaller or equal to 100 is representative in that it contains a large proportion of values.
If we put such a binned summary of frequencies into a graph, that is called a <em>histogram</em>.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="ebs.html#cb177-1"></a>bin &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">bin_width =</span> <span class="dv">10</span>) <span class="kw">floor</span>(x<span class="op">/</span>bin_width) <span class="op">*</span><span class="st"> </span>bin_width</span>
<span id="cb177-2"><a href="ebs.html#cb177-2"></a>n_ToT &lt;-<span class="st"> </span><span class="kw">N_obs</span>(Ver20<span class="op">$</span>ToT)</span>
<span id="cb177-3"><a href="ebs.html#cb177-3"></a></span>
<span id="cb177-4"><a href="ebs.html#cb177-4"></a>Ver20 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb177-5"><a href="ebs.html#cb177-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bin =</span> <span class="kw">bin</span>(ToT)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb177-6"><a href="ebs.html#cb177-6"></a><span class="st">  </span><span class="kw">group_by</span>(bin) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb177-7"><a href="ebs.html#cb177-7"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">rel_freq =</span> <span class="kw">n</span>()<span class="op">/</span>n_ToT) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb177-8"><a href="ebs.html#cb177-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> bin, <span class="dt">y =</span> rel_freq)) <span class="op">+</span></span>
<span id="cb177-9"><a href="ebs.html#cb177-9"></a><span class="st">  </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-32-1.png" width="90%" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="ebs.html#cb178-1"></a><span class="co"># Ver20 %&gt;% </span></span>
<span id="cb178-2"><a href="ebs.html#cb178-2"></a><span class="co">#   ggplot(aes(x = ToT)) +</span></span>
<span id="cb178-3"><a href="ebs.html#cb178-3"></a><span class="co">#   geom_histogram(binwidth = 10)</span></span></code></pre></div>
<p>Strictly spoken, grouped and binned frequencies are not one statistic, but a vector of statistics.
It approximates what we will later get to know more closely as a <em>distribution</em> <a href="ebs.html#distributions">3.5.2</a>.</p>
</div>
<div id="central-tendency" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Central tendency</h3>
<p>Reconsider the rational design researcher Jane <a href="cases.html#sec99">A.2.2</a>.
When asked about whether users can complete a transaction within 99, she looked at the population average of her measures.
The population average is what we call the <em>(arithmetic) mean</em>.
The mean is computed by summing over all measures and divide by the number of observations.
The mean is probably the most often used measure of central tendency, but two more are being used and have their own advantages: <em>median</em> and <em>mode</em>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="ebs.html#cb179-1"></a>my_mean &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sum</span>(x)<span class="op">/</span><span class="kw">N_obs</span>(x) <span class="co">## not length()</span></span>
<span id="cb179-2"><a href="ebs.html#cb179-2"></a><span class="kw">my_mean</span>(Ver20<span class="op">$</span>ToT)</span></code></pre></div>
<pre><code>## [1] 106</code></pre>
<p><em>Note</em> that I am using function <code>N_obs()</code> @pref(frequencies), not <code>length()</code>, to not accidentally count missing values (<code>NA</code>).</p>
<p>Imagine a competitor of the car rental company goes to court to fight the 99-seconds claim.
Not an expert in juridical matters, my suggestion is that one of the first questions to be regarded in court probably is: what does “rent a car in 99 seconds” actually promise?
One way would be the mean (“on average users can rent a car in 99 seconds”), but here are some other ways to interpret the same slogan:</p>
<p>“50% (or more) of users can …”.
This is called the <em>median</em>.
The median is computed by ordering all measures and identify the the element right in the center.
If the number of observations is even, there is no one center value, and the mean of the center pair is used, instead.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="ebs.html#cb181-1"></a>my_median &lt;-<span class="st"> </span><span class="cf">function</span>(x){ </span>
<span id="cb181-2"><a href="ebs.html#cb181-2"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb181-3"><a href="ebs.html#cb181-3"></a>  center &lt;-<span class="st"> </span>(n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">%/%</span><span class="dv">2</span></span>
<span id="cb181-4"><a href="ebs.html#cb181-4"></a>  <span class="cf">if</span> (n<span class="op">%%</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) </span>
<span id="cb181-5"><a href="ebs.html#cb181-5"></a>    <span class="kw">sort</span>(x, <span class="dt">partial =</span> center)[center]</span>
<span id="cb181-6"><a href="ebs.html#cb181-6"></a>  <span class="cf">else</span> <span class="kw">mean</span>(<span class="kw">sort</span>(x, <span class="dt">partial =</span> center <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">1</span>)[center <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">1</span>])</span>
<span id="cb181-7"><a href="ebs.html#cb181-7"></a>}</span>
<span id="cb181-8"><a href="ebs.html#cb181-8"></a></span>
<span id="cb181-9"><a href="ebs.html#cb181-9"></a><span class="kw">my_median</span>(Ver20<span class="op">$</span>ToT)</span></code></pre></div>
<p>Actually, the median is a special case of so called <em>quantiles</em>.
Generally, an quantiles are based on the order of measures and an X% quantile is that value where X% of measures are equal to or smaller.
The court could decide that 50% of users is too lenient as a criterion and could demand that 75% percent of users must complete the task within 99 seconds for the slogan to be considered valid.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="ebs.html#cb182-1"></a><span class="kw">quantile</span>(Ver20<span class="op">$</span>ToT, <span class="kw">c</span>(.<span class="dv">50</span>, <span class="fl">.75</span>))</span></code></pre></div>
<pre><code>## 50% 75% 
## 108 125</code></pre>
<p>A common pattern to be found in distributions of measures is that a majority of observations are clumped in the center region.
The point of highest density of a distribution is called the <em>mode</em>.
In other words: the mode is the region (or point) that is most likely to occur.
For continuous measures this once again poses the problem that every value is unique.
Sophisticated procedures exist to smooth over this inconvenience, but by the simple method of binning we can construct an approximation of the mode: just choose the center of the bin with highest frequency. This is just a crude approximation. Advanced algorithms for estimating modes can be found in the R package <em>Modeest</em>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="ebs.html#cb184-1"></a>mode &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">bin_width =</span> <span class="dv">10</span>) {</span>
<span id="cb184-2"><a href="ebs.html#cb184-2"></a>  bins &lt;-<span class="st"> </span><span class="kw">bin</span>(x, bin_width)</span>
<span id="cb184-3"><a href="ebs.html#cb184-3"></a>  bins[<span class="kw">which.max</span>(<span class="kw">tabulate</span>(<span class="kw">match</span>(x, bins)))] <span class="op">+</span><span class="st"> </span>bin_width<span class="op">/</span><span class="dv">2</span></span>
<span id="cb184-4"><a href="ebs.html#cb184-4"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="ebs.html#cb185-1"></a><span class="kw">mode</span>(Ver20<span class="op">$</span>ToT)</span></code></pre></div>
<pre><code>## [1] 145</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="ebs.html#cb187-1"></a>Ver20 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb187-2"><a href="ebs.html#cb187-2"></a><span class="st">  </span><span class="kw">group_by</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb187-3"><a href="ebs.html#cb187-3"></a><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb187-4"><a href="ebs.html#cb187-4"></a>    <span class="dt">mean_ToT   =</span> <span class="kw">mean</span>(ToT),</span>
<span id="cb187-5"><a href="ebs.html#cb187-5"></a>    <span class="dt">median_ToT =</span> <span class="kw">median</span>(ToT),</span>
<span id="cb187-6"><a href="ebs.html#cb187-6"></a>    <span class="dt">mode_ToT =</span> <span class="kw">mode</span>(ToT))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">mean_ToT</th>
<th align="right">median_ToT</th>
<th align="right">mode_ToT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">106</td>
<td align="right">108</td>
<td align="right">145</td>
</tr>
</tbody>
</table>
<p>The table above shows the three statistics for central tendency side-by-side.
Mean and median are close together.
This is frequently the case, but not always.
Only if a distribution of measures is completely symmetric, mean and median perfectly coincide.
In section <a href="ebs.html#distributions">3.5.2</a> we will encounter distributions that are not symmetric.
The more a distribution is skewed, the stronger the difference between mean and median increases.</p>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-41-1.png" width="90%" /></p>
<p>To be more precise: for left skewed distributions the mean is strongly influenced by few, but extreme, values in the left tail of the distribution.
The median only counts the number of observations to both sides and is not influenced by how extreme these values are.
Therefore, it is located more to the right.
The mode does not regard any values other than those in the densest region and just marks that peak.
The same principles hold in reversed order for right-skewed distributions.</p>
<p>To summarize, the mean is the most frequently used measure of central tendency, one reason being that it is a so called <em>sufficient statistic</em>, meaning that it exploits the full information present in the data.
The median is frequently used when extreme measures are a concern.
The mode is the point in the distribution that is most typical.</p>
</div>
<div id="dispersion" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Dispersion</h3>
<p>In a symmetric distribution with exactly one peak, mean and mode coincide and the mean represents the most typical value.
But, a value being <em>more</em> typical does <em>not</em> mean it is <em>very</em> typical.
That depends on how the measures are dispersed over the whole range.
In the figure below, the center value of the narrow distribution contains 60% of all measures, as compared to 40% in the wide distribution, and is therefore more representative.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="ebs.html#cb188-1"></a>D_disp &lt;-</span>
<span id="cb188-2"><a href="ebs.html#cb188-2"></a><span class="st">  </span><span class="kw">tribble</span>(<span class="op">~</span>y, <span class="op">~</span>narrow, <span class="op">~</span>wide,</span>
<span id="cb188-3"><a href="ebs.html#cb188-3"></a>        <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb188-4"><a href="ebs.html#cb188-4"></a>        <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb188-5"><a href="ebs.html#cb188-5"></a>        <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">4</span>,</span>
<span id="cb188-6"><a href="ebs.html#cb188-6"></a>        <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb188-7"><a href="ebs.html#cb188-7"></a>        <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb188-8"><a href="ebs.html#cb188-8"></a><span class="st">  </span><span class="kw">gather</span>(Distribution, frequency, <span class="op">-</span>y) </span>
<span id="cb188-9"><a href="ebs.html#cb188-9"></a></span>
<span id="cb188-10"><a href="ebs.html#cb188-10"></a></span>
<span id="cb188-11"><a href="ebs.html#cb188-11"></a>D_disp <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb188-12"><a href="ebs.html#cb188-12"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, </span>
<span id="cb188-13"><a href="ebs.html#cb188-13"></a>             <span class="dt">y =</span> frequency)) <span class="op">+</span></span>
<span id="cb188-14"><a href="ebs.html#cb188-14"></a><span class="st">  </span><span class="kw">facet_grid</span>(Distribution <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></span>
<span id="cb188-15"><a href="ebs.html#cb188-15"></a><span class="st">  </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-42-1.png" width="90%" /></p>
<p>A very basic way to describe dispersion of a distribution is to report the <em>range</em> between the two extreme values, <em>minimum</em> and <em>maximum</em>.
These are easily computed by sorting all values and selecting the first and the last element.
Coincidentally, they are also special cases of quantiles, namely the 0% and 100% quantiles.</p>
<p>A <em>boxplot</em> is a commonly used geometry to examine the shape of dispersion.
Similar to histograms, boxplots use a binning mechanism and are useful for continuous measures.
Whereas histograms use equidistant bins on the scale of measurement, boxplots create four bins based on 25% quantile steps.
These are also called <em>quartiles</em>.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="ebs.html#cb189-1"></a>Ver20 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb189-2"><a href="ebs.html#cb189-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ToT)) <span class="op">+</span></span>
<span id="cb189-3"><a href="ebs.html#cb189-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-43-1.png" width="90%" /></p>
<p>The min/max statistics only uses just these two values and therefore does not fully represent the amount of dispersion.
A statistic for dispersion that exploits the full data is the <em>variance</em>, which is the mean of squared deviations from the mean.
Squaring the deviations makes variance difficult to interpret, as it no longer is on the same scale as the measures.
The <em>standard deviation</em> solves this problem by taking the square root of variance.
By reversing the square the standard deviation is on the same scale as the original measures and can easily be compared to the mean.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="ebs.html#cb190-1"></a>min &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sort</span>(x)[<span class="dv">1</span>]</span>
<span id="cb190-2"><a href="ebs.html#cb190-2"></a>max &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">quantile</span>(x, <span class="dv">1</span>)</span>
<span id="cb190-3"><a href="ebs.html#cb190-3"></a>range &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x)</span>
<span id="cb190-4"><a href="ebs.html#cb190-4"></a>var &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>((<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span>x)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb190-5"><a href="ebs.html#cb190-5"></a>sd  &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">var</span>(x))</span>
<span id="cb190-6"><a href="ebs.html#cb190-6"></a></span>
<span id="cb190-7"><a href="ebs.html#cb190-7"></a>Ver20 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb190-8"><a href="ebs.html#cb190-8"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">min</span>(ToT),</span>
<span id="cb190-9"><a href="ebs.html#cb190-9"></a>            <span class="kw">max</span>(ToT),</span>
<span id="cb190-10"><a href="ebs.html#cb190-10"></a>            <span class="kw">range</span>(ToT),</span>
<span id="cb190-11"><a href="ebs.html#cb190-11"></a>            <span class="kw">var</span>(ToT),</span>
<span id="cb190-12"><a href="ebs.html#cb190-12"></a>            <span class="kw">sd</span>(ToT))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">min(ToT)</th>
<th align="right">max(ToT)</th>
<th align="right">range(ToT)</th>
<th align="right">var(ToT)</th>
<th align="right">sd(ToT)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">15.2</td>
<td align="right">174</td>
<td align="right">158</td>
<td align="right">966</td>
<td align="right">31.1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="ebs.html#cb191-1"></a><span class="kw">detach</span>(Sec99)</span></code></pre></div>
</div>
<div id="associations" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Associations</h3>
<ul>
<li>Are elderly users slower at navigating websites?</li>
<li>How does reading speed depend on font size?</li>
<li>Is the result of an intelligence test independent from gender?</li>
</ul>
<p>In the previous section we have seen how all individual variables can be described by location and dispersion.
A majority of research deals with associations between measures and the present section introduces some statistics to describe them.
Variables represent properties of the objects of research and fall into two categories: <em>Metric variables</em> represent a measured property, such as speed, height, money or perceived satisfaction.
<em>Categorical variables</em> put observations (or objects of research) into non-overlapping groups, such as experimental conditions, persons who can program or cannot, type of education etc.
Consequently, associations between any two variables fall into precisely one of four cases, as shown in the table.
In the following I will explain the different types of associations.</p>
<table style="width:90%;">
<colgroup>
<col width="19%" />
<col width="34%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>categorical</th>
<th>metric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>categorical</td>
<td>frequency cross tables</td>
<td>differences in mean</td>
</tr>
<tr class="even">
<td>metric</td>
<td></td>
<td>covariance, correlation</td>
</tr>
</tbody>
</table>
<div id="cat-associations" class="section level4">
<h4><span class="header-section-number">3.3.4.1</span> Categorical associations</h4>
<p>Categorical variables group observations, and when they are <em>both categorical</em>, the result is just another categorical case and the only way to compare them is relative frequencies.
To illustrate the categorical-categorical case, consider a study to assess the safety of two syringe infusion pump designs, called Legacy and Novel.
All participants of the study are asked to perform a typical sequence of operation on both devices (categorical variable Design) and it is recorded whether the sequence was completed correctly or not (categorical variable Correctness).</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="ebs.html#cb192-1"></a><span class="kw">attach</span>(IPump)</span>
<span id="cb192-2"><a href="ebs.html#cb192-2"></a></span>
<span id="cb192-3"><a href="ebs.html#cb192-3"></a>D_agg <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-4"><a href="ebs.html#cb192-4"></a><span class="st">  </span><span class="kw">filter</span>(Session <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-5"><a href="ebs.html#cb192-5"></a><span class="st">  </span><span class="kw">group_by</span>(Design, completion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-6"><a href="ebs.html#cb192-6"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">frequency =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb192-7"><a href="ebs.html#cb192-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-8"><a href="ebs.html#cb192-8"></a><span class="st">  </span><span class="kw">spread</span>(completion, frequency)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Design</th>
<th align="right">FALSE</th>
<th align="right">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Legacy</td>
<td align="right">21</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Novel</td>
<td align="right">22</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Besides the troubling result that incorrect completion is the rule, not the exception, there is almost no difference between the two designs.
Note that in this study, both professional groups were even in number.
If that is not the case, absolute frequencies are difficult to compare and we better report <em>relative frequencies</em>.
Note how every row sums up to <span class="math inline">\(1\)</span> in the following table:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="ebs.html#cb193-1"></a>D_agg <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb193-2"><a href="ebs.html#cb193-2"></a><span class="st">  </span><span class="kw">filter</span>(Session <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb193-3"><a href="ebs.html#cb193-3"></a><span class="st">  </span><span class="kw">group_by</span>(Design, completion) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb193-4"><a href="ebs.html#cb193-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">frequency =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb193-5"><a href="ebs.html#cb193-5"></a><span class="st">  </span><span class="kw">group_by</span>(Design) <span class="op">%&gt;%</span></span>
<span id="cb193-6"><a href="ebs.html#cb193-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">frequency =</span> frequency<span class="op">/</span><span class="kw">sum</span>(frequency)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb193-7"><a href="ebs.html#cb193-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb193-8"><a href="ebs.html#cb193-8"></a><span class="st">  </span><span class="kw">spread</span>(completion, frequency)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Design</th>
<th align="right">FALSE</th>
<th align="right">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Legacy</td>
<td align="right">0.84</td>
<td align="right">0.16</td>
</tr>
<tr class="even">
<td align="left">Novel</td>
<td align="right">0.88</td>
<td align="right">0.12</td>
</tr>
</tbody>
</table>
<p>In addition, absolute or relative frequencies can be shown in a stacked <em>bar plot</em>:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="ebs.html#cb194-1"></a>D_agg <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb194-2"><a href="ebs.html#cb194-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Design, <span class="dt">fill =</span> completion)) <span class="op">+</span></span>
<span id="cb194-3"><a href="ebs.html#cb194-3"></a><span class="st">  </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-49-1.png" width="90%" /></p>
</div>
<div id="cat-metric-associations" class="section level4">
<h4><span class="header-section-number">3.3.4.2</span> Categorical-metric associations</h4>
<p>Associations between <em>categorical and metric</em> variables are reported by <em>grouped location statistics</em>.
In the case of the two infusion pump designs, the time spent to complete the sequence is compared by the following table.
And as you can see, adding a comparison of variance (or any other statistic) is not a hassle.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="ebs.html#cb195-1"></a>D_agg <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb195-2"><a href="ebs.html#cb195-2"></a><span class="st">  </span><span class="kw">filter</span>(Session <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb195-3"><a href="ebs.html#cb195-3"></a><span class="st">  </span><span class="kw">group_by</span>(Design) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb195-4"><a href="ebs.html#cb195-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_ToT =</span> <span class="kw">mean</span>(ToT),</span>
<span id="cb195-5"><a href="ebs.html#cb195-5"></a>            <span class="dt">sd_ToT =</span> <span class="kw">sd</span>(ToT))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Design</th>
<th align="right">mean_ToT</th>
<th align="right">sd_ToT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Legacy</td>
<td align="right">151.0</td>
<td align="right">62.2</td>
</tr>
<tr class="even">
<td align="left">Novel</td>
<td align="right">87.7</td>
<td align="right">33.8</td>
</tr>
</tbody>
</table>
<p>For the illustration of categorical-metric associations case, <em>boxplots</em> haven proven useful.
Boxplots show differences in central tendency (median) and dispersion (other quartiles) simultaneously.
Here we can observe that Novel design produces shorter ToT and seems to have less dispersion.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="ebs.html#cb196-1"></a>D_agg <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb196-2"><a href="ebs.html#cb196-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Design, <span class="dt">y =</span> ToT)) <span class="op">+</span></span>
<span id="cb196-3"><a href="ebs.html#cb196-3"></a><span class="st"> </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-51-1.png" width="90%" /></p>
</div>
<div id="cov-corr" class="section level4">
<h4><span class="header-section-number">3.3.4.3</span> Covariance and correlation</h4>
<p>For associations between a pair of metric variables, <em>covariance</em> and <em>correlations</em> are commonly employed statistics.</p>
<p>A covariance is a real number that is <em>zero</em> when there really is <em>no association</em> between two variables.
When two variables move into the <em>same direction</em>, covariance gets the <em>positive</em>.
When they move in <em>opposite directions</em>, covariance is <em>negative</em></p>
<p>For an illustration, consider the following hypothetical example of study on the relationship between mental ability and performance in a minimally-invasive surgery (MIS) task. MIS tasks are known to involve a lot of visual-spatial cognition, which means that performance on other visual-spatial tasks should be associated.</p>
<!-- In the Laptrain study, a number of visual-spatial tests were given to participants, such as a mental rotation task (MRT). The Corsi block-tapping task was even taken twice, because the researchers are also interested in how stable over time the scores are. -->
<!-- The data set is contained in package *Asymptote*, which resides on GitHub. -->
<!-- In this experiment, participants were trained in twelve trials, but we only take the last. -->
<!-- ```{r} -->
<!-- attach(asymptote) -->
<!-- D_tests <-  -->
<!--   D_laptrain %>% -->
<!--   filter(trial == 12) %>%  -->
<!--   select(MRT, Corsi1, Corsi2, ToT = Duration) -->
<!-- D_tests %>% sample_n(5) -->
<!-- ``` -->
<p>The following code simulates such a set of measures from a multivariate-normal distribution. The associations are defined as a matrix of correlations and are then up-scaled by the standard error to result in covariances. Later, we will do the reverse to obtain correlations from covariances.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="ebs.html#cb197-1"></a>cor2cov &lt;-<span class="st"> </span><span class="cf">function</span>(cor, sd) <span class="kw">diag</span>(sd) <span class="op">%*%</span><span class="st"> </span>cor <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">diag</span>(sd))</span>
<span id="cb197-2"><a href="ebs.html#cb197-2"></a></span>
<span id="cb197-3"><a href="ebs.html#cb197-3"></a>cor_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.95</span>, <span class="fl">-.5</span>, <span class="fl">.2</span>,</span>
<span id="cb197-4"><a href="ebs.html#cb197-4"></a>                    <span class="fl">.95</span>, <span class="dv">1</span>, <span class="fl">-.5</span>, <span class="fl">.2</span>,</span>
<span id="cb197-5"><a href="ebs.html#cb197-5"></a>                    <span class="fl">-.5</span>, <span class="fl">-.5</span>,  <span class="dv">1</span>, <span class="fl">.15</span>,</span>
<span id="cb197-6"><a href="ebs.html#cb197-6"></a>                    <span class="fl">.2</span>, <span class="fl">.2</span>, <span class="fl">.15</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb197-7"><a href="ebs.html#cb197-7"></a>sd_vec  &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">2</span>, <span class="fl">.2</span>, <span class="dv">40</span>, <span class="dv">2</span>)</span>
<span id="cb197-8"><a href="ebs.html#cb197-8"></a>mean_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">180</span>, <span class="dv">6</span>)</span>
<span id="cb197-9"><a href="ebs.html#cb197-9"></a></span>
<span id="cb197-10"><a href="ebs.html#cb197-10"></a>D_tests &lt;-</span>
<span id="cb197-11"><a href="ebs.html#cb197-11"></a><span class="st">  </span>mvtnorm<span class="op">::</span><span class="kw">rmvnorm</span>(<span class="dv">300</span>, </span>
<span id="cb197-12"><a href="ebs.html#cb197-12"></a>                   <span class="dt">mean =</span> mean_vec, </span>
<span id="cb197-13"><a href="ebs.html#cb197-13"></a>                   <span class="dt">sigma =</span> <span class="kw">cor2cov</span>(cor_mat, sd_vec)) <span class="op">%&gt;%</span></span>
<span id="cb197-14"><a href="ebs.html#cb197-14"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></span>
<span id="cb197-15"><a href="ebs.html#cb197-15"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">MRS_1 =</span> V1, <span class="dt">MRS_2 =</span> V2, <span class="dt">ToT =</span> V3, <span class="dt">Corsi =</span> V4)</span></code></pre></div>
<p>The following function computes the covariance of two variables.
The covariance between the two MRS scores is positive, indicating that they move into the same direction.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="ebs.html#cb198-1"></a>my_cov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y)</span>
<span id="cb198-2"><a href="ebs.html#cb198-2"></a>  <span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">*</span><span class="st"> </span>(y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)))</span>
<span id="cb198-3"><a href="ebs.html#cb198-3"></a></span>
<span id="cb198-4"><a href="ebs.html#cb198-4"></a><span class="kw">my_cov</span>(D_tests<span class="op">$</span>MRS_<span class="dv">1</span>, D_tests<span class="op">$</span>MRS_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.0407</code></pre>
<p>The problem with covariances is that, like variances, they are on a squared scale, which makes them difficult to interpret.
This is why later, we will transform covariances into correlations, but for understanding the steps to go there, we have to understand the link between variance and covariance. The formula for covariance is (with <span class="math inline">\(E(X)\)</span> the mean of <span class="math inline">\(X\)</span>):</p>
<p><span class="math display">\[
\textrm{cov}_{XY} = \frac{1}{n} \sum_{i=1}^n (x_i - E(X)) (y_i - E(Y))
\]</span></p>
<p>Covariance essentially arises by the multiplication of differences to the mean, <span class="math inline">\((x_i - E(X)) (y_i - E(Y)\)</span>.
When for one observation both factors go into the same direction, be it positive or negative, this term gets positive.
If the association is strong, this will happen a lot, and the whole sum gets largely positive.
When the deviations systematically move in opposite direction, such that one factor is always positive and the other negative, we get a large negative covariance.
When the picture is mixed, i.e. no clear tendency, covariance will stay close to zero.
The following illustration uses a geometric interpretation of the multiplication as the area of rectangles.
Rectangles with equal directions (blue) are in the upper-right and lower-left quadrant.
They overwhelm the opposite direction rectangles (red), which speaks for a strong positive association.
The associations between MRT_1 and Corsi, as well as between Corsi and ToT seem to have a slight overhead in same direction, so the covariance is positive, but less strong.
A clear negative association exists between MRS_1 and Corsi.
It seems these two tests have some common ground.</p>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-54-1.png" width="90%" /></p>
<p>If we compare the formulas of covariance and variance, it is apparent that variance is just covariance of a variable with itself (<span class="math inline">\((x_i - E(X))^2 = (x_i - E(X))(x_i - E(X))\)</span>:</p>
<p>That gives rise to a compact form to show all covariances and variances between a bunch of variables at once.
The following table is a <em>variance-covariance matrix</em> produced by the command <code>cov</code>.
It shows the variance of every variable in the diagonal and the mutual covariances in the off-diagonal cells.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="ebs.html#cb200-1"></a><span class="kw">cov</span>(D_tests)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">MRS_1</th>
<th align="right">MRS_2</th>
<th align="right">ToT</th>
<th align="right">Corsi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MRS_1</td>
<td align="right">0.043</td>
<td align="right">0.041</td>
<td align="right">-4.25</td>
<td align="right">0.106</td>
</tr>
<tr class="even">
<td align="left">MRS_2</td>
<td align="right">0.041</td>
<td align="right">0.043</td>
<td align="right">-4.13</td>
<td align="right">0.104</td>
</tr>
<tr class="odd">
<td align="left">ToT</td>
<td align="right">-4.246</td>
<td align="right">-4.127</td>
<td align="right">1515.49</td>
<td align="right">7.615</td>
</tr>
<tr class="even">
<td align="left">Corsi</td>
<td align="right">0.106</td>
<td align="right">0.104</td>
<td align="right">7.62</td>
<td align="right">4.185</td>
</tr>
</tbody>
</table>
<p>As intuitive the idea of covariance is, as unintelligible is the statistic itself for reporting results.
Th problem is that covariance is not a pure measure of association, but is contaminated by the dispersion of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.
For that reason, two covariances can only be compared if the variables have the same variance. As this is usually not the case, it is impossible to compare covariances.
The <em>Pearson correlation coefficient</em> <span class="math inline">\(r\)</span> solves the problem by rescaling covariances by the product of the two standard deviations:</p>
<p><span class="math display">\[
r_XY = \frac{\textrm{cov}_{XY}}{\textrm{sd}_X \textrm{sd}_Y}
\]</span></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="ebs.html#cb201-1"></a>my_cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y)</span>
<span id="cb201-2"><a href="ebs.html#cb201-2"></a>  <span class="kw">cov</span>(x, y)<span class="op">/</span>(<span class="kw">sd</span>(x, <span class="dt">na.rm =</span> T) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(y, <span class="dt">na.rm =</span> T))</span>
<span id="cb201-3"><a href="ebs.html#cb201-3"></a></span>
<span id="cb201-4"><a href="ebs.html#cb201-4"></a><span class="kw">my_cor</span>(D_tests<span class="op">$</span>MRS_<span class="dv">1</span>, D_tests<span class="op">$</span>MRS_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.952</code></pre>
<p>Due to the standardization of dispersion, <span class="math inline">\(r\)</span> will always be in the interval <span class="math inline">\([-1,1]\)</span> and can be used to evaluate or compare strength of association, independent of scale of measurement.</p>
<p>That makes it the perfect choice when associations are being compared to each other or to an external standard.
In the field of psychometrics, correlations are ubiquitously employed to represent <em>reliability</em> and <em>validity</em> of psychological tests (<a href="mlm.html#psychometrics">5.8</a>).
<em>Test-retest stability</em> is one form to measure reliability and it is just the correlation of the same test taken on different days.
For example, we could ask whether mental rotation speed as measured by the mental rotation task (MRT) is stable over time, such that we can use it for long-term predictions, such as how likely someone will become a good surgeon.
Validity of a test means that it represents what it was intended for, and that requires an external criterion that is known to be valid.
For example, we could ask how well the ability of a person to become a minimally invasive surgeon depends on spatial cognitive abilities, like mental rotation speed.
Validity could be assessed by taking performance scores from exercises in a surgery simulator and do the correlation with mental rotation speed.
A correlation of <span class="math inline">\(r = .5\)</span> would indicate that mental rotation speed as measured by the task has rather limited validity.
Another form is called <em>discriminant validity</em> and is about how specific a measure is.
Imagine another test as part of the surgery assessment suite.
This test aims to measure another aspect of spatial cognition, namely the capacity of the visual-spatial working memory (e.g., the Corsi block tapping task).
If both tests are as specific as they claim to be, we would expect a particularly low correlation.</p>
<p>And similar to covariances, correlations between a set of variables can be put into a correlation table.
This time, the diagonal is the correlation of a variable with itself, which is perfect correlation and therefore equals 1.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="ebs.html#cb203-1"></a>D_tests <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">MRS_1</th>
<th align="right">MRS_2</th>
<th align="right">ToT</th>
<th align="right">Corsi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MRS_1</td>
<td align="right">1.000</td>
<td align="right">0.952</td>
<td align="right">-0.526</td>
<td align="right">0.250</td>
</tr>
<tr class="even">
<td align="left">MRS_2</td>
<td align="right">0.952</td>
<td align="right">1.000</td>
<td align="right">-0.513</td>
<td align="right">0.245</td>
</tr>
<tr class="odd">
<td align="left">ToT</td>
<td align="right">-0.526</td>
<td align="right">-0.513</td>
<td align="right">1.000</td>
<td align="right">0.096</td>
</tr>
<tr class="even">
<td align="left">Corsi</td>
<td align="right">0.250</td>
<td align="right">0.245</td>
<td align="right">0.096</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<p>Another way to illustrate a bunch of correlations is produced by the following command from the <em>GGally</em> package, showing</p>
<ul>
<li>the association between a pair of variables as a scatter plot and a the correlation coefficient</li>
<li>the observed distribution of every measure as a density plot</li>
</ul>
<p>(In earlier versions of the command, correlations were given without p-values. It was not a good choice to change that)
<!-- #28 --></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="ebs.html#cb204-1"></a>D_tests <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb204-2"><a href="ebs.html#cb204-2"></a><span class="st">  </span>GGally<span class="op">::</span><span class="kw">ggpairs</span>(<span class="dt">upper =</span> )</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-58-1.png" width="90%" /></p>
<p>Correlations give psychometricians a comparable standard for the quality of measures, irrespective on what scale they are.
In exploratory analysis, one often seeks to get a broad overview of how a bunch of variables is associated.
Creating a correlation table of all variables is no hassle and allows to get a broad picture of the situation.</p>
<p>While correlations are ubiquitous in data analysis, they do have limitations: First, a correlation only uncovers linear trends, whereas the association between two variables can take any conceivable form.
The validity of correlations depends on how salient the feature of linear trend is.
In the example below, <span class="math inline">\(Y_1\)</span> reveals a strong parabolic form, which results in zero correlation.
The curvature of an exponentially rising function is only captured insufficiently.
For that reason, I recommend that correlations are always cross-checked by a scatterplot.
Another situation where covariances and correlations fail is when there simply is no variance. It is almost trivial, but for observing how a variable <span class="math inline">\(Y\)</span> changes when <span class="math inline">\(X\)</span> moves is that both variables actually vary. There simply is no co-variance without variance.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="ebs.html#cb205-1"></a><span class="kw">tibble</span>(<span class="dt">x =</span>  (<span class="dv">0</span><span class="op">:</span><span class="dv">100</span>)<span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb205-2"><a href="ebs.html#cb205-2"></a>           <span class="dt">y_1 =</span> <span class="kw">rnorm</span>(<span class="dv">101</span>, <span class="kw">exp</span>(x)<span class="op">/</span><span class="dv">100</span>, x <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb205-3"><a href="ebs.html#cb205-3"></a>           <span class="dt">y_2 =</span> <span class="kw">rnorm</span>(<span class="dv">101</span>, (x <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb205-4"><a href="ebs.html#cb205-4"></a><span class="st">  </span><span class="kw">ggpairs</span>(<span class="dt">lower=</span><span class="kw">list</span>(<span class="dt">continuous=</span><span class="st">&quot;smooth&quot;</span>))</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-59-1.png" width="90%" /></p>
<p>As we have seen, for every combination of two categorical and metric variables, we can produce summary statistics for the association, as well as graphs.</p>
<!-- The second part of this book really is about statistical models that extend association statistics in two ways: first, we will see that linear models \@ref(lm) can capture the associations between more than just two variables. Line -->
<!-- Second, by Bayesian estimation, we can derive statements of uncertainty. -->
<p>While it could be tempting to primarily use summary statistics and rather omit statistical graphs, the last example makes clear that some statistics like correlation are making assumptions on the shape the association.
The different graphs we have seen are much less presupposing and can therefore be used to check the assumptions of statistics and models.</p>
<!-- 31
With covariance and correlations we covered linear trends between metric variables. But, how would we represent associations between groups and metric variables?
-->
<!--


+ There are at least some users who can (which clearly is the case). That would be the *minimum value*.
+ Half of the users or more can, which is a statistic called the *median*.
+ Most users can in around 99s, which is called the *mode*.

All the above, including the  mean, are numbers that summarize the observations. A single number that summarizes a set of observations is called *a statistic*, formally it is just

$s = f_s(D)$

with $s$ being a statistic on data $D$, defined by the function $f_s$. Characterizing a data set by appropriate statistics is called *descriptive statistics*. 

Most commonly used statistics fall in three classes: cardinality, central tendency (or location) of data and data dispersion. Cardinality statistics give the number of units of a class in a data set. The most common cardinalities are  the number of observed performance measures $n_{Obs}$, the number of individual participants $n_{Part}$ in the study. 

Reporting the calculated mean of time-on-task in two designs is descriptive. It summarizes the data set in a reasonable way. It is informative in so far as one learns which design to prefer, but coarsely. Consider a case where two designs were just slight variations, come at precisely the same costs, and the researcher has collected performance measures on five subjects per group, without the option of inviting more participants.
-->
</div>
</div>
</div>
<div id="bayes-prob-theory" class="section level2">
<h2><span class="header-section-number">3.4</span> Bayesian probability theory</h2>
<!--Probability is an elusive concept and a source of mental suffering and heated debates, especially when people rely to much  intuition. The reason is that in the human mind, probability can be rooted in two different ways: in frequentist thinking, probability is represented by relative frequencies, whereas in Bayesian school of thought it is the level of certainty for some event to happen.-->
<!-- This is a Bayesian book and the following considerations are meant to convince the reader that the Bayesian use of probability has a wider domain of application than the frequentist. I also see this as one of the more rare situations where introducing some formalism is supportive in that it dissolves the subtle preoccupations that often accompany intuitive (or, I'd rather say: exemplified) understanding. In addition, the mathematical definition is bare of any real world notions, like observed frequencies or experienced certainties and  (figuratively speaking) makes the different perspectives converge. The algebraic definition of probability is given by the three Kolmogorov axioms. Before we come to that, let me undertake one intermediate step: introducing some set-theoretic concepts, which at the same time is meant as a deep bow to the discipline of thought that is so awe inspiring on the one hand a source of mental suffering for many on the other hand. -->
<p>Mathematics is emptiness.
In its purest form, it does not require or have any link to the real world.
That makes math so difficult to comprehend, and beautifully strange at the same time.
Sometimes a mathematical theory describes real world phenomena, but we have no intuition about it.
A classic example is Einstein’s General Relativity Theory, which assumes a curved space, rather than the straight space our senses are tuned to.
Our minds are Newtonian and the closest to intuitive understanding we can get is the imagination of the universe as a four-dimensional mollusk, thanks to Einstein.</p>
<p>Math can also be easy, even appear trivial, if mathematical expressions directly translate into familiar ideas and sensations.
I recall how my primary school teacher introduced the sum of two numbers as removing elements from one stack and place it on second (with an obvious stop rule).
Later, as a student, I was taught how the sum of two numbers is defined within the Peano axiomatic theory of Natural Numbers.
As it turned out, I knew this already, because they just formalized the procedure I was taught as a kid.
The formal proof for <span class="math inline">\(1 + 1 = 2\)</span> is using just the same elements as me shifting blocks between towers.</p>
<!-- ####  MAKE FIGURE -->
<!-- ```{r include = F} -->
<!-- Theories <- tribble(~Theory, ~intuitive, -->
<!--                     "Natural Numbers", .1, -->
<!--                     "Basic set theory", .15, -->
<!--                     "Probability theory", .2, -->
<!--                     "Curved spacetime", .9, -->
<!--                     "Quantum mechanics", .95) -->
<!-- Theories %>%  -->
<!--   ggplot(aes(x = intuitive, y = 0, yend = 0, xend = intuitive, label = Theory)) + -->
<!--   geom_segment() + -->
<!--   geom_point() + -->
<!--   geom_text(angle = 45) + -->
<!--   geom_hline(yintercept=0,size=1,color='purple') + -->
<!--   scale_y_continuous(limits = c(-0.1,0.1), breaks = 0, labels = NULL, name = NULL) + -->
<!--   scale_x_continuous(limits = c(0,1), breaks = 1, labels = NULL, name = "Intuition") -->
<!-- ``` -->
<!-- intuitive --------------------------------- a total math -->
<!-- |   |  | |                                 |    | -->
<!-- Peano   -->
<!-- Set_theory  -->
<!-- probability -->
<!-- Curved space time -->
<!-- Quantum mechanics -->
<!-- #### HERE -->
<p>In this section I will introduce <em>Probability theory</em>, which is largely based on another mathematical theory that many people find intuitive, <em>Set theory</em>.
The formal theory of probability, the Kolmogorov axioms may be somewhat disappointing from an ontological perspective, as it just defines rules for when a set of numbers can be regarded probabilities.
But calculating actual probabilities is rather easy and a few R commands will suffice to start playing with set theory and probability.
The most tangible interpretation of probabilities is that the probability of an event to happen, say getting a Six when rolling a dice, coincides with the relative frequency of Six in a (very long) sequence of throws.
This is called the <em>frequentist interpretation</em> of probability and this is how probability will be introduced in the following.
While thinking in terms of relative frequency in long running sequences is rather intuitive, it has limitations.
Not all events we want to assign a probability can readily be imagined as a long running sequence, for example:</p>
<ul>
<li>the probability that your house burns down (you only have this one)</li>
<li>the probability that a space ship will safely reach Mars (there’s only this one attempt)</li>
<li>the probability that a theory is more true than another (there’s only this pair)</li>
</ul>
<p>The <em>Bayesian interpretation</em> of probability is essentially the same as the frequentist, but is more relaxed as it does <em>not</em> require that all probabilities are measured through relative frequencies in long running sequences.
Bayesian thinking includes the idea that probabilities can also be a <em>degree of belief</em>, which can, but doesn’t have to be grounded in long-running series.
In the following I will present in broad strokes how the theory of probability emerges from set theory and can be set into motion by computing relative frequencies of sets and subsets.
Then, I will introduce the <em>likelihood</em>, which is a concept equally used in classic and Bayesian statistics.
After clarifying the differences between frequentist and Bayesian ideas of measuring probability, <em>Bayes theorem</em> is introduced as the formal underpinning of all Bayesian statistics.
We will see how the likelihood and idea of <em>certainty as probability</em> combines to a scientific framework that emphasizes the incremental updating of our knowledge about the world we measure.</p>
<div id="set-theory" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Some set theory</h3>
<p>The mathematical concept of probability can most intuitively be approached by thinking in terms of relative frequency in long-running sequences.
Actually, it is not even required to think of a sequence (where events have an order).
It suffices to assume a set of events that emerge from one experiment.</p>
<p>A mathematical <em>set</em> is a collection of elements taken from a domain (or universe, more dramatically).
These can either be defined by stating all the elements, like <span class="math inline">\(S = \{\textrm{red}, \textrm{yellow}, \textrm{green}, \textrm{off}\}\)</span> or by a characterizing statement, like:</p>
<p><span class="math inline">\(S := \textrm{possible states of a Dutch traffic light}\)</span></p>
<p>The elements should be clearly identified, but need not have a particular order.
(If they do, this is called an <em>ordered set</em>, the set of natural numbers is an example).
Sets can have all possible sizes, which is called the <em>cardinality</em> of a set:</p>
<ul>
<li>finite (and countable) like the states of a traffic light</li>
<li>empty like “all opponents who can defeat Chuck Norris”, <span class="math inline">\(\{\}\)</span> or <span class="math inline">\(\oslash\)</span></li>
<li>infinite, but countable, like the natural numbers <span class="math inline">\(N\)</span></li>
<li>infinite, uncountable, like the real numbers <span class="math inline">\(R\)</span></li>
</ul>
<p>You may wonder now, whether you would ever need such a strange concept as uncountable infinite sets in your down-to-earth design research.
Well, the set of primary interest in every design study is the possible outcomes.
Sometimes, these are finite, like <span class="math inline">\(\{\textrm{success}, \textrm{failure}\}\)</span>, but when you measure durations or distances, you enter the realm of real numbers.
We will set this issue aside for the moment and return to it later in the context of continuous distributions of randomness.</p>
<p>In order to introduce the mathematical concept of probability, we first have to understand some basic operations on sets.
For an illustration, imagine a validation study for a medical infusion pump, where participants were given a task and the outcome was classified by the following three criteria:</p>
<ul>
<li>was the task goal achieved successfully?</li>
<li>was the task completed timely (e.g., one minute or below)?</li>
<li>were there any operation errors along the way with potentially harmful consequences?</li>
</ul>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="ebs.html#cb206-1"></a>D_sets</span></code></pre></div>
<p>Note how the data table makes use of logical values to assign each observation a membership (or not) to each of the three sets.
We can use the filter command to create all kinds of subsets and actually that would carry us pretty far into set theory.
In the following I will introduce set theory thze Programming way, but use the package Sets, as it most closely resembles the mathematical formalism, it replaces.
We begin with loading the package, which unfortunately uses the <code>%&gt;%</code> operator for its own purpose.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="ebs.html#cb207-1"></a><span class="kw">library</span>(sets)</span>
<span id="cb207-2"><a href="ebs.html#cb207-2"></a><span class="co">## masks %&gt;% operator. don&#39;t use in conjunction with dplyr</span></span></code></pre></div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="ebs.html#cb208-1"></a>All      &lt;-<span class="st"> </span><span class="kw">as.set</span>(D_sets<span class="op">$</span>Obs)</span>
<span id="cb208-2"><a href="ebs.html#cb208-2"></a>Success  &lt;-<span class="st"> </span><span class="kw">as.set</span>(<span class="kw">filter</span>(D_sets, Success)<span class="op">$</span>Obs)</span>
<span id="cb208-3"><a href="ebs.html#cb208-3"></a>Harmful  &lt;-<span class="st"> </span><span class="kw">as.set</span>(<span class="kw">filter</span>(D_sets, Harmful)<span class="op">$</span>Obs)</span>
<span id="cb208-4"><a href="ebs.html#cb208-4"></a>Timely   &lt;-<span class="st"> </span><span class="kw">as.set</span>(<span class="kw">filter</span>(D_sets, Timely)<span class="op">$</span>Obs)</span></code></pre></div>
<!-- 33 -->
<!-- 34 add set notation-->
<p>Once there is more than one set in the game, set operators can be used to create all kinds of new sets.
We begin with the <em>set difference</em>, which removes elements of one set from another (if they exist), for example the set of all successful tasks that were not completed in time.
Note how the Sets package uses the minus operator to remove elements of one set (Timely) from another (Success).</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="ebs.html#cb209-1"></a>Success <span class="op">-</span><span class="st"> </span>Timely</span></code></pre></div>
<pre><code>## {24L, 25L, 26L, 27L, 28L, 29L}</code></pre>
<p>Using the set difference, we can produce <em>complementary set</em> which include all elements that are not included in a set.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="ebs.html#cb211-1"></a>Failure  &lt;-<span class="st"> </span>All <span class="op">-</span><span class="st"> </span>Success</span>
<span id="cb211-2"><a href="ebs.html#cb211-2"></a>Harmless &lt;-<span class="st"> </span>All <span class="op">-</span><span class="st"> </span>Harmful</span>
<span id="cb211-3"><a href="ebs.html#cb211-3"></a>Delayed  &lt;-<span class="st"> </span>All <span class="op">-</span><span class="st"> </span>Timely</span></code></pre></div>
<p>In probability theory this corresponds with the probability of an event (Success) and its <em>counter-event</em> (Failure).
A set and its complementary set taken together produce the <em>universal set</em>, which in probability theory is the <em>sure event</em> with a probability of One.
To show that we can use <em>set union</em>, which collects the elements of two separate sets into one new set, for example re-uniting a set with its complementary,</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="ebs.html#cb212-1"></a>Success <span class="op">|</span><span class="st"> </span>Failure <span class="op">==</span><span class="st"> </span>All</span></code></pre></div>
<pre><code>## {7L, 8L, 9L, 10L, 11L, 12L, 13L,
##  14L, 15L, 16L, 17L, 18L, 24L, 25L,
##  26L, 27L, 28L, 29L, FALSE}</code></pre>
<p>or creating the set of all observations that were failure or delayed (or both):</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="ebs.html#cb214-1"></a>Failure <span class="op">|</span><span class="st"> </span>Delayed</span></code></pre></div>
<pre><code>## {1L, 2L, 3L, 4L, 5L, 6L, 19L, 20L,
##  21L, 22L, 23L, 24L, 25L, 26L, 27L,
##  28L, 29L, 30L}</code></pre>
<p>Another commonly used set operator is the <em>intersect</em>, which produces a set that contains only those elements present in both original sets, like the set of timely and successful task completions.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="ebs.html#cb216-1"></a>Success <span class="op">&amp;</span><span class="st"> </span>Timely</span></code></pre></div>
<pre><code>## {7L, 8L, 9L, 10L, 11L, 12L, 13L,
##  14L, 15L, 16L, 17L, 18L}</code></pre>
<p>Turns out all successful observations are also harmless.
But not all harmless observations were successful.
In set theory Success is therefore a <em>subset</em> of Harmless.
The subset operator differs from those discussed so far, in that it does not produce a new set, but a truth value (also called logical or Boolean).
Per definition, two <em>equal</em> sets are also subsets of each other.
The <code>&lt;</code> operator is more strict and it means a <em>proper subsets</em>, where being a subset has just one direction.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="ebs.html#cb218-1"></a><span class="co"># subset</span></span>
<span id="cb218-2"><a href="ebs.html#cb218-2"></a>Success <span class="op">&lt;=</span><span class="st"> </span>Harmless</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="ebs.html#cb220-1"></a><span class="co"># proper subset</span></span>
<span id="cb220-2"><a href="ebs.html#cb220-2"></a>Success <span class="op">&lt;</span><span class="st"> </span>Harmless</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="ebs.html#cb222-1"></a><span class="co"># set equality</span></span>
<span id="cb222-2"><a href="ebs.html#cb222-2"></a>Success <span class="op">==</span><span class="st"> </span>Harmless</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="ebs.html#cb224-1"></a>Success <span class="op">==</span><span class="st"> </span>(All <span class="op">-</span><span class="st"> </span>Failure)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The example above demonstrates the, figuratively, smallest concept of set theory.
The <em>empty set</em> has the special property of being a subset of all other set:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="ebs.html#cb226-1"></a><span class="kw">set</span>() <span class="op">&lt;</span><span class="st"> </span>Success</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The empty set is important for the intersect operator to work properly.
It may happen that two sets do not share any elements at all.
It would be problematic, if the intersect operator only worked if common elements truly existed.
In such a case, the intersection of two sets is the empty set.
Sets that have an empty intersection are called <em>disjunct sets</em> (with complementary sets as a special case).
The package Sets, which defines all operators on sets so far is lacking a dedicated function for disjunctness, but this is easily defined using the intersect function:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="ebs.html#cb228-1"></a>is_disjunct &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) <span class="kw">set_is_empty</span>(x <span class="op">&amp;</span><span class="st"> </span>y)</span>
<span id="cb228-2"><a href="ebs.html#cb228-2"></a><span class="kw">is_disjunct</span>(Success, Harmful)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>So far, we have only seen sets of atomic elements, where all elements are atomic, i.e. they are not sets themselves.</p>
<p>With a little more abstraction, we can also conceive a set that has other sets as its elements.
The set of sets that are defined by the three performance criteria and their complementary sets is an obvious example:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="ebs.html#cb230-1"></a><span class="kw">set</span>(Success, Failure, Harmful, Harmless, Timely, Delayed)</span></code></pre></div>
<pre><code>## {&lt;&lt;set(9)&gt;&gt;, &lt;&lt;set(10)&gt;&gt;,
##  &lt;&lt;set(12)&gt;&gt;, &lt;&lt;set(18)&gt;&gt;,
##  &lt;&lt;set(20)&gt;&gt;, &lt;&lt;set(21)&gt;&gt;}</code></pre>
<p>For the formal introduction of probability, we need two concepts related to sets of sets: First, a <em>partition of a set</em> is a set of non-empty subsets such that every element is assigned to exactly one subset.
The subsets of successes and its complementary set, all failures, is such a partition.
Second, the <em>power set</em> is the set of all possible subsets in a set.
Even with a rather small set of 20 elements, this is getting incredibly large, so let’s see it on a smaller example:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="ebs.html#cb232-1"></a>S &lt;-<span class="st"> </span><span class="kw">set</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb232-2"><a href="ebs.html#cb232-2"></a>P &lt;-<span class="st"> </span><span class="kw">set_power</span>(S)</span>
<span id="cb232-3"><a href="ebs.html#cb232-3"></a>P</span></code></pre></div>
<pre><code>## {{}, {1}, {2}, {3}, {1, 2}, {1, 3},
##  {2, 3}, {1, 2, 3}}</code></pre>
<p>The power set is tantamount for the definition of probability that follows, because it has two properties: first, for every subset of <code>S</code> it also contains the complementary set.
That is called <em>closed under complementarity</em>.
Second, for every pair of subsets of <code>S</code>, <code>P</code> it also contains the union, it is <em>closed under union</em>.
In the same way, power sets are also <em>closed under intersection</em>.
Generally, all sets of subsets that fulfill these three requirements are called <span class="math inline">\(\Sigma\)</span> algebras.
The mathematical theory of <span class="math inline">\(\Sigma\)</span> algebras is central for the mathematical definition of all measures.</p>
<p>Without going into to much depth on measurement theory, a measure is a mapping from the domain of empirical observations to the domain of numbers, such that certain operations in the domain of measurement work conistently with numerical operations.
One example is the following: if you have to towers of blocks, L and R, next to each other and you look at them from one side, then the following rule applies for translating between the world of sensations and the world of sets:</p>
<p><code>L L   R    &lt;-- Observer L   R L   R</code> If you can see the top of tower L, when looking from the right side, then tower L is larger than tower R is build with <em>more</em> blocks than tower R.
Probabilities are measures and in the next section we will see how numerical operations on probabilities relate to set operations in a <span class="math inline">\(\Sigma\)</span> algebra.
We will also see that relative frequencies are measures of probability.</p>
</div>
<div id="probability" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Probability</h3>
<p>In the following I will outline the formal theory of probability and use the same fictional validation study to illustrate the relevant concepts.
introduced in the previous section.
Performance of participants was classified by the three two-level criteria, success, harm and timeliness.
Every recorded outcome therefore falls into one of eight possible sets and a purposeful way to summarize the results of the study would be relative frequencies (<span class="math inline">\(\pi\)</span>, <code>pi</code>):</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="ebs.html#cb234-1"></a>N_sets &lt;-<span class="st"> </span><span class="kw">nrow</span>(D_sets)</span>
<span id="cb234-2"><a href="ebs.html#cb234-2"></a></span>
<span id="cb234-3"><a href="ebs.html#cb234-3"></a>D_freq &lt;-</span>
<span id="cb234-4"><a href="ebs.html#cb234-4"></a><span class="st">  </span>D_sets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb234-5"><a href="ebs.html#cb234-5"></a><span class="st">  </span><span class="kw">group_by</span>(Success, Harmful, Timely) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb234-6"><a href="ebs.html#cb234-6"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb234-7"><a href="ebs.html#cb234-7"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb234-8"><a href="ebs.html#cb234-8"></a><span class="st">  </span><span class="kw">complete</span>(Success, </span>
<span id="cb234-9"><a href="ebs.html#cb234-9"></a>           Harmful, </span>
<span id="cb234-10"><a href="ebs.html#cb234-10"></a>           Timely, </span>
<span id="cb234-11"><a href="ebs.html#cb234-11"></a>           <span class="dt">fill =</span> <span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># adds empty events</span></span>
<span id="cb234-12"><a href="ebs.html#cb234-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pi =</span> n<span class="op">/</span><span class="kw">sum</span>(n))</span>
<span id="cb234-13"><a href="ebs.html#cb234-13"></a></span>
<span id="cb234-14"><a href="ebs.html#cb234-14"></a>D_freq</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Success</th>
<th align="left">Harmful</th>
<th align="left">Timely</th>
<th align="right">n</th>
<th align="right">pi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0.033</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="right">2</td>
<td align="right">0.067</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="right">3</td>
<td align="right">0.100</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">6</td>
<td align="right">0.200</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">6</td>
<td align="right">0.200</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="right">12</td>
<td align="right">0.400</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">0</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<p>Let’s examine on an abstract level, what has happened here:</p>
<ol style="list-style-type: decimal">
<li>The set of events has been partitioned into eight non-overlapping groups, which cover the three-way intersections. The first row, for example, is the intersect of the three sets Failure, Harmless and Delayed (see previous section).</li>
<li>All subsets got a real number assigned, by the operation of relative frequencies which produces numbers between (and including) Zero and One.</li>
<li>A hidden property is that, if we unite all sets, we get the universal set and, not coincidentally, if we sum over the frequencies the result is One:</li>
</ol>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="ebs.html#cb235-1"></a><span class="kw">sum</span>(D_freq<span class="op">$</span>pi)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Back to formal: The mathematical theory of probability departs from a set of <em>outcomes</em> <span class="math inline">\(\Omega\)</span> and a <span class="math inline">\(\Sigma\)</span> algebra <span class="math inline">\(F\)</span> defined on <span class="math inline">\(\Omega\)</span>.
An element <span class="math inline">\(E\)</span> of <span class="math inline">\(F\)</span> therefore is a set of outcomes, which is called an <em>event</em>.</p>
<p>The eight threeway interaction sets above are a partition of <span class="math inline">\(\Omega\)</span>, but not a <span class="math inline">\(\Sigma\)</span>-algebra.
As disjunct sets they are closed under intersection for trivial reasons, but they are not closed under union.
For that we had to add a lot of possible outcomes, all counter-sets to start with.
The point is that we can construct all these subsets using filter commands and produce relative frequencies, like above.</p>
<p>Probability as an axiomatic theory is defined by the three <em>Kolmogorov axioms</em>:</p>
<p>The <em>first Kolmogorov axiom</em> states that a probability is a non-negative real number assigned to every event.
The computation of relative frequencies satisfies this condition hands down.</p>
<p>The first axiom defines a lower border of Zero for a probability measure, the <em>second Kolmogorov axiom</em> is taking care of an upper limit of One.
This happens indirectly by stating that the set of all observations <span class="math inline">\(\Omega\)</span> (which is an element of <span class="math inline">\(F\)</span>) is assigned a probability of One.
In the table of relative frequencies that is not yet covered, but we can easily do so:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="ebs.html#cb237-1"></a>D_sets <span class="op">%&gt;%</span></span>
<span id="cb237-2"><a href="ebs.html#cb237-2"></a><span class="st">  </span><span class="co"># no group_by</span></span>
<span id="cb237-3"><a href="ebs.html#cb237-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">pi =</span> <span class="kw">n</span>()<span class="op">/</span>N_sets) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb237-4"><a href="ebs.html#cb237-4"></a><span class="st">  </span><span class="kw">c</span>()</span></code></pre></div>
<pre><code>## $pi
## [1] 1</code></pre>
<p>So far, the theory only cared for assigning numbers to events (subsets), but provides no means to operate on probabilities.
The <em>third Kolmogorov axiom</em> establishes a relation between the union operator on sets and the sum operator on probabilities by stating that the probability of a union of disjunct events is the sum of the individual probabilities.
We can approve this to be true for the relative frequencies.
For example, the question could be: Is the set of all successful observations the union of successful timely observations.
Indeed, the relative frequency of all successful events is the sum of the two and satisfies the third axiom:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="ebs.html#cb239-1"></a>D_sets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb239-2"><a href="ebs.html#cb239-2"></a><span class="st">  </span><span class="kw">group_by</span>(Success) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb239-3"><a href="ebs.html#cb239-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb239-4"><a href="ebs.html#cb239-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pi =</span> n<span class="op">/</span><span class="kw">sum</span>(n))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Success</th>
<th align="right">n</th>
<th align="right">pi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">12</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="right">18</td>
<td align="right">0.6</td>
</tr>
</tbody>
</table>
<p>The Kolmogorov axioms establish a probability measure and lets us do calculations on disjunct subsets.
That would be a meager toolbox to do calculations with probabilities.
What about all the other set operators and their possible counterparts in the realm of numbers?
It is one of greatest wonders of the human mind that the rich field of reasoning about probabilities spawns from just these three axioms and a few set theoretic underpinnings.
To just give one very simple example, we can derive that the probability of the complement of a set <span class="math inline">\(A\)</span> is <span class="math inline">\(P(\Omega/A) = 1 - P(A)\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>From set theory follows that a set <span class="math inline">\(A\)</span> and its complement <span class="math inline">\(\Omega/A\)</span> are disjunct, hence axiom 3 is applicable: <span class="math inline">\(P(A \cup \Omega/A) = P(A) + P(\Omega/A)\)</span></p></li>
<li><p>From set theory follows that a set <span class="math inline">\(A\)</span> and its complement <span class="math inline">\(\Omega/A\)</span> form a partition on <span class="math inline">\(\Omega\)</span>.
Using axiom 2, we can infer:</p></li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp;&amp;A \cup \Omega/A &amp;=&amp; \Omega\\ 
&amp;\Rightarrow &amp;P(A) + P(\Omega/A) = P(\Omega) &amp;=&amp; 1\\ 
&amp;\Rightarrow &amp;P(\Omega/A) &amp;=&amp; 1 - P(A)
\end{aligned}
\]</span></p>
<!-- However, we may want to calculate the probability of events that are not disjunct, speaking of sets that is they overlap. If we just add -->
<p>The third axiom tells us how to deal with probabilities, when events are disjunct.
As we have seen, it applies for defining more general events.
How about the opposite direction, calculating probabilities of more special events?
In our example, two rather general events are Success and Timely, whereas the intersection event Success <em>and</em> Timely is more special.
The probability of two events occurring together is called <em>joint probability</em> <span class="math inline">\(P(\textrm{Timely} \cap \textrm{Success})\)</span>.
The four joint probabilities on the two sets and their complements are shown in the following table.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="ebs.html#cb240-1"></a>D_sets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb240-2"><a href="ebs.html#cb240-2"></a><span class="st">  </span><span class="kw">group_by</span>(Success, Timely) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb240-3"><a href="ebs.html#cb240-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">pi =</span> <span class="kw">n</span>()<span class="op">/</span>N_sets) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb240-4"><a href="ebs.html#cb240-4"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Success</th>
<th align="left">Timely</th>
<th align="right">pi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">0.133</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="right">0.267</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="right">0.200</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">0.400</td>
</tr>
</tbody>
</table>
<p>As joint probability asks for simultaneous occurrence it treats both involved sets symmetrically: <span class="math inline">\(P(\textrm{Timely} \cap \textrm{Success}) = P(\textrm{Successes} \cap \textrm{Timely})\)</span>.
What if you are given one piece of information first, such as “this was a successful outcome” and you have to guess the other “Was it harmful?”.
That is called <em>conditional probability</em> and in this case, it is Zero.
But what is the conditional probability that, when you know an event was a failure, it really caused harm?</p>
<p><span class="math inline">\(P(\textrm{Harmful}|\textrm{Success})\)</span></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="ebs.html#cb241-1"></a>D_sets <span class="op">%&gt;%</span></span>
<span id="cb241-2"><a href="ebs.html#cb241-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>Success) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-3"><a href="ebs.html#cb241-3"></a><span class="st">  </span><span class="kw">group_by</span>(Harmful) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-4"><a href="ebs.html#cb241-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-5"><a href="ebs.html#cb241-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pi =</span> n<span class="op">/</span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-6"><a href="ebs.html#cb241-6"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Harmful</th>
<th align="right">n</th>
<th align="right">pi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">3</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="right">9</td>
<td align="right">0.75</td>
</tr>
</tbody>
</table>
<p>In the manner of a speed-accuracy trade-off, there could be a relationship between Timely and Harm.
Participants who rush through the task are likely to make more harmful errors.
We would then expect a different distribution of probability of harm by whether or not task completion was timely.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="ebs.html#cb242-1"></a>D_sets <span class="op">%&gt;%</span></span>
<span id="cb242-2"><a href="ebs.html#cb242-2"></a><span class="st">  </span><span class="kw">group_by</span>(Timely, Harmful) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb242-3"><a href="ebs.html#cb242-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb242-4"><a href="ebs.html#cb242-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pi =</span> n<span class="op">/</span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb242-5"><a href="ebs.html#cb242-5"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Timely</th>
<th align="left">Harmful</th>
<th align="right">n</th>
<th align="right">pi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">7</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="right">3</td>
<td align="right">0.3</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="right">14</td>
<td align="right">0.7</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">6</td>
<td align="right">0.3</td>
</tr>
</tbody>
</table>
<p>See how conditional probabilities sum up to one <em>within</em> their condition.
In this case, the conditional probabilities for harm are the same for successes and failures.
As a consequence, it is also the same as the overall probability, hence:</p>
<p><span class="math display">\[
\begin{aligned}
P(\textrm{Harm} | \textrm{Timely}) = P(\textrm{No harm} | \textrm{Timely}) =
P(\textrm{Timely})
\end{aligned}
\]</span></p>
<p>This situation is called <em>independence of events</em> and it means that knowing about one variable does not help in guessing the other.
In Statistics, <em>conditional probability</em> and <em>independence of events</em> are tightly linked to <em>likelihoods</em> and <em>Bayes theorem</em> <a href="ebs.html#bayes-theorem">3.4.5</a>.</p>
<!-- <!-- #39 elaborate the role of independence -> -->
<!-- #### COMPLETE ME -->
<!-- + joint probability -->
<!-- + conditional probability (events in a sequence -> knowledge of A is knowledge of B) -->
<!-- + independence -->
<!-- + Bayes theorem -->
<!-- Other definitions and basic numerical operations on probabilities can be inferred in similar ways.  -->
<!-- <!-- 35 -> -->
<!-- The basic operations on probability then give rise to more advanced laws of probability: -->
<!-- <!-- 36 -> -->
<!--The two endpoints of the probability scale we can call the *impossible event*, $P(A) = 0$ and the *inevitable event* $P(A) = 1$. For example, it is impossible that any task a researcher throws at a participant is completed in a negative time: $P(ToT < 0) = 0$. At the same time, it is certain that the participant either correctly completes the task or not, $P(\textrm{correct } or \textrm{ incorrect}) = 1$. You may find the latter example trivial, but, in fact it points to another element of probability, namely, *the probability of all possible mutually exclusive events sums to 1*, for example:

+ tomorrow it rains or is doesn't
+ all people carrying zero or more Y chromosomes
+ the duration is a positive number

Have you noticed the frequent occurrence of the word *or* in the above examples? In probability space, this little word precisely denotes an event 

On the other hand, *and* means that two events occur together. 


+ 
+ probabilities of independent events multiply


What are those events in design research and how do we assign them those numbers called probabilities? -->
<!--32-->
<!--To some confusion, but also underlining the emptiness of math, several types of measures are true probabilities themselves. Consider a validation study for a medical device. A sample of nurses is asked to complete a series of similar tasks. The performance measure of interest is the *relative frequency $\pi$* of failures. Generally, classifications of outcomes are probabilities, when the classification is unambiguous and exhaustive, such that every event falls into exactly one class. When the criterion for success is crisp enough, these requirements are fulfilled. They are also fulfilled by the relative frequencies by which you see green, yellow, red or dark when approaching a Dutch traffic light.

Especially for readers with some theoretical grounding in frequentist statistics it may be helpful to see that also continuous variables can be probabilities, namely proportions. Imagine a novel behavioral screening test on alcohol influence. The client is asked to walk 10 meters on a curved path. Using a set of smart sensors, that continuously assess whether the clients center of gravity is inside or outside the path. The *proportions* of relative distances inside or outside the path are probabilities (without being countable events).-->
</div>
<div id="likelihood" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Likelihood</h3>
<p>In the previous section we have seen how to create probabilities from relative frequencies in data how to do basic calculations with those probabilities.
Using these concept, we will see in teh following how data can be used for inference.
Inference means to draw conclusions about theoretical models.
In the following this will be illustrated at the example of rolling dices, where the default theory is that the dice is fair, hence the probability of Six is assumed to be <code>\pi_{Six}</code>.
For the matter here, we take the theory of the dice being fair into the equantion, as a condittional probability, in words: “Conditional on this dice being fair, the chance of rolling Six is <span class="math inline">\({1/6}\)</span>”.</p>
<p><span class="math display">\[
P(y = \textrm{Six}|\pi_\textrm{Six} = {1/6})
\]</span></p>
<p>When such a standard standard dice is rolled twice, how likely is an outcome of two times Six?
We use probability theory: It is one dice but the results of the rolls are otherwise independent; for example, the probability to roll a Six does not wear off over time or anything like that.</p>
<!-- $P(y_1 = \textrm{Six}|\pi = {1/6}) = P(y_2 = \textrm{Six}  = {1/6})$.  -->
<p>Because of independence, the joint probability of rolling two times Six is just the product:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;P(y_1 = \textrm{Six} \textrm{ and } y_2 = \textrm{Six}|\pi = {1/6})\\
= &amp;P(y_1 = \textrm{Six}|\pi = {1/6}) \times P(y_2 = \textrm{Six}|\pi = {1/6})\\
 = &amp;{1/36}
\end{aligned}
\]</span></p>
<p>The joint probability of all data points is called the <em>Likelihood</em> and generalizes to situations where the probabilities of events are not the same, for example: What is the probability of the one dice being a Four, the second a five and the third a Three or a Six?</p>
<p><span class="math display">\[
\begin{aligned}
P(y_1 = \textrm{Four} \textrm{ and } y_2 = \textrm{Five} \textrm{ and } y_3 = \textrm{Three} \textrm{ or } \textrm{Six}) = \frac{1}{6} \times \frac{1}{6} \times \frac{1}{3} = \frac{1}{108}
\end{aligned}
\]</span></p>
<p>Notice how the likelihood gets smaller in the second example.
In fact, likelihoods are products of numbers between zero and one and therefore become smaller with every observation that is added.
In most empirical studies, the number of observations is much larger than two or three and the likelihood becomes inexpressibly small.
Consider the following results from 16 rolls.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="ebs.html#cb243-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb243-2"><a href="ebs.html#cb243-2"></a>Events &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;One&quot;</span>, <span class="st">&quot;Two&quot;</span>, <span class="st">&quot;Three&quot;</span>, <span class="st">&quot;Four&quot;</span>, <span class="st">&quot;Five&quot;</span>, <span class="st">&quot;Six&quot;</span>)</span>
<span id="cb243-3"><a href="ebs.html#cb243-3"></a>Result &lt;-<span class="st"> </span><span class="kw">sample</span>(Events, <span class="dv">16</span>, <span class="dt">replace =</span> T)</span>
<span id="cb243-4"><a href="ebs.html#cb243-4"></a>pi =<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">6</span></span>
<span id="cb243-5"><a href="ebs.html#cb243-5"></a>Likelihood &lt;-<span class="st"> </span>pi<span class="op">^</span><span class="kw">length</span>(Result)</span></code></pre></div>
<p>The likelihood of this result, given that it is a fair dice, is <span class="math inline">\(\frac 1 6^{16} = 3.545\times 10^{-13}\)</span>.
Therefore, one usually reports the <em>logarithm of the likelihood (log-likelihood)</em>.
This results in “reasonable” negative numbers.
Why negative?
Because all Likelihoods are fractions of One (the identity element of multiplication), which results in a negative logarithm.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="ebs.html#cb244-1"></a>(logLik &lt;-<span class="st"> </span><span class="kw">log</span>(Likelihood))</span></code></pre></div>
<pre><code>## [1] -28.7</code></pre>
<!-- The negative log likelihood is central concept in Bayesian and classic model estimation, as we will see. When estimating a model, a likelihood is computed a myriad of times. With a little mathematical trick, the negative log-likelihood can be calculated as sum of logarithms, instead of a logarithm of products. -->
<!-- $$ -->
<!-- \log(a \times b) = \log(a) + log(b) -->
<!-- $$ -->
<!-- ```{r} -->
<!-- -sum(rep(log(1/6), 16)) -->
<!-- ``` -->
<!-- For the human mind, summing over numbers is much easier than products. And the same goes for computers. The following code measures the computing time (ms) for a likelihood of ten thousand dice rolls. On my computer, summing over logarithms almost cuts the computing time in half. -->
<!-- ```{r} -->
<!-- Rolls <- rep(1/6, 10000) -->
<!-- bind_rows( -->
<!--   microbenchmark::microbenchmark(-prod(Rolls)), -->
<!--   microbenchmark::microbenchmark(-sum(log(Rolls))) -->
<!-- ) -->
<!-- ``` -->
<p>The dice rolling example above has a twist.
assumed that we may enter <span class="math inline">\(\pi = 1/6\)</span>, because we <em>believe</em> that it is a fair dice, without further notice.
In other words, we needed no data, because of overwhelming prior knowledge (or theory, if you will).
And now we will come to see, why I took the effort to write the probabilities above as conditional probabilities.
A likelihood is the probability of the data, given a parameter value.
The basic idea of likelihoods is to consider data constant, and vary the parameter.
In such a way, we can see how the likelihood changes when we assume different values for <span class="math inline">\(\pi_\textrm{Six}\)</span>.</p>
<p>Imagine we have been called in to uncover fraud with biased dices in a casino.
There is suspicion, that the chance of rolling a Six is lower than <span class="math inline">\(1/6\)</span>.
So, what is the most likely chance of rolling a Six?
In the following simulation, 6000 rolls have been recorded:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="ebs.html#cb246-1"></a>n_Rolls &lt;-<span class="st"> </span><span class="dv">6000</span></span>
<span id="cb246-2"><a href="ebs.html#cb246-2"></a></span>
<span id="cb246-3"><a href="ebs.html#cb246-3"></a>Biased_dice &lt;-<span class="st"> </span></span>
<span id="cb246-4"><a href="ebs.html#cb246-4"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">Side =</span> <span class="kw">as_factor</span>(Events),</span>
<span id="cb246-5"><a href="ebs.html#cb246-5"></a>         <span class="dt">pi =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="fl">.02</span>, <span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">6</span>, <span class="dv">4</span>), <span class="dv">1</span><span class="op">/</span><span class="dv">6</span> <span class="op">-</span><span class="st"> </span><span class="fl">.02</span>))</span>
<span id="cb246-6"><a href="ebs.html#cb246-6"></a>  </span>
<span id="cb246-7"><a href="ebs.html#cb246-7"></a>  </span>
<span id="cb246-8"><a href="ebs.html#cb246-8"></a>  </span>
<span id="cb246-9"><a href="ebs.html#cb246-9"></a><span class="kw">set.seed</span>(<span class="dv">41</span>)</span>
<span id="cb246-10"><a href="ebs.html#cb246-10"></a>Rolls &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Roll =</span> <span class="dv">1</span><span class="op">:</span>n_Rolls,</span>
<span id="cb246-11"><a href="ebs.html#cb246-11"></a>                   <span class="dt">Result =</span> <span class="kw">sample</span>(Biased_dice<span class="op">$</span>Side, </span>
<span id="cb246-12"><a href="ebs.html#cb246-12"></a>                                   <span class="dt">prob    =</span> Biased_dice<span class="op">$</span>pi, </span>
<span id="cb246-13"><a href="ebs.html#cb246-13"></a>                                   <span class="dt">size    =</span> n_Rolls, </span>
<span id="cb246-14"><a href="ebs.html#cb246-14"></a>                                   <span class="dt">replace =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb246-15"><a href="ebs.html#cb246-15"></a><span class="st">  </span><span class="kw">as_tbl_obs</span>()</span>
<span id="cb246-16"><a href="ebs.html#cb246-16"></a></span>
<span id="cb246-17"><a href="ebs.html#cb246-17"></a>Rolls</span></code></pre></div>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="ebs.html#cb247-1"></a>Rolls <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb247-2"><a href="ebs.html#cb247-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Result)) <span class="op">+</span></span>
<span id="cb247-3"><a href="ebs.html#cb247-3"></a><span class="st">  </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-86-1.png" width="90%" /></p>
<p>The result is shown in the figure above and just for simplicity we just focus on the events of rolling a Six.
If we have no prior suspicion about the dice, the estimated probability is simply the relative frequency of Six.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="ebs.html#cb248-1"></a>Rolls <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-2"><a href="ebs.html#cb248-2"></a><span class="st">  </span><span class="kw">group_by</span>(Result) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-3"><a href="ebs.html#cb248-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">pi =</span> <span class="kw">n</span>()<span class="op">/</span>n_Rolls)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Result</th>
<th align="right">pi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">One</td>
<td align="right">0.189</td>
</tr>
<tr class="even">
<td align="left">Two</td>
<td align="right">0.177</td>
</tr>
<tr class="odd">
<td align="left">Three</td>
<td align="right">0.163</td>
</tr>
<tr class="even">
<td align="left">Four</td>
<td align="right">0.160</td>
</tr>
<tr class="odd">
<td align="left">Five</td>
<td align="right">0.164</td>
</tr>
<tr class="even">
<td align="left">Six</td>
<td align="right">0.147</td>
</tr>
</tbody>
</table>
<p>In this case, we can simply note down that the <em>most likely value</em> is <span class="math inline">\(\pi_{Six} =.147\)</span>, which is lower than the fair 0.167.
But, note the slight ruggedness of the bar chart.
Not a single bar is read as exactly <span class="math inline">\(1/6\)</span>, so the deviation of Six could have happened by chance.
One way to approach this question is comparing the likelihoods <span class="math inline">\(P(\text{Result = Six}|\pi = {1/6})\)</span> and <span class="math inline">\(P(\text{Result = Six}|\pi = {.147})\)</span>.
For that purpose, we create a new event variable <code>Six</code>, that indicates whether a roll is a Six (<code>TRUE</code>) or not (<code>FALSE</code>).
Further, a <em>distribution function</em> is required that assigns these events their probabilities.
Distribution functions can take very complicated forms <a href="ebs.html#distributions">3.5.2</a>, but in the case here it is the rather simple <em>Bernoulli distribution</em>.</p>
<!-- $$ -->
<!-- d_\text{Bern}(p) =  -->
<!--   \begin{cases} -->
<!--     \text{Six} ,& p\\ -->
<!--     \text{not Six},& 1 - p -->
<!--   \end{cases} -->
<!-- $$ -->
<p>The log-likelihood function of the Bernoulli distribution is just the sum of log-probabilities of any roll <span class="math inline">\(y_i\)</span>.</p>
<p><span class="math display">\[
LL_\text{Bern}(Y|\pi) = \sum_i{\log(d_\text{Bern}(y_i, \pi))}
\]</span></p>
<p>Now, we can determine the <em>ratio of likelihoods LR</em> with different values for <span class="math inline">\(\pi\)</span>.
Note that on the logarithmic scale, what was a ratio, becomes a difference.</p>
<p><span class="math display">\[
LR = \exp(LL_\text{Bern}(\text{Rolls}, .147) - LL_\text{Bern}(\text{Rolls}, \frac 1 6)
\]</span></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="ebs.html#cb249-1"></a>Rolls &lt;-<span class="st">  </span>Rolls <span class="op">%&gt;%</span></span>
<span id="cb249-2"><a href="ebs.html#cb249-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Six =</span> (Result <span class="op">==</span><span class="st"> &quot;Six&quot;</span>))</span>
<span id="cb249-3"><a href="ebs.html#cb249-3"></a></span>
<span id="cb249-4"><a href="ebs.html#cb249-4"></a>dbern &lt;-<span class="st"> </span><span class="cf">function</span>(y, pi) <span class="kw">if_else</span>(y, pi, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pi)</span>
<span id="cb249-5"><a href="ebs.html#cb249-5"></a>LL_bern &lt;-<span class="st"> </span><span class="cf">function</span>(pi) <span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dbern</span>(Rolls<span class="op">$</span>Six, pi)))</span>
<span id="cb249-6"><a href="ebs.html#cb249-6"></a></span>
<span id="cb249-7"><a href="ebs.html#cb249-7"></a>pi_fair =<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">6</span></span>
<span id="cb249-8"><a href="ebs.html#cb249-8"></a>pi_est  =<span class="st"> </span><span class="fl">.147</span></span>
<span id="cb249-9"><a href="ebs.html#cb249-9"></a></span>
<span id="cb249-10"><a href="ebs.html#cb249-10"></a><span class="kw">exp</span>(<span class="kw">LL_bern</span>(pi_est) <span class="op">-</span><span class="st"> </span><span class="kw">LL_bern</span>(pi_fair))</span></code></pre></div>
<pre><code>## [1] 4846</code></pre>
<p>Now, recall what a likelihood is: the probability of the observed data, under a certain model.
Here, the data is almost 5000 times more likely with <span class="math inline">\(p = .147\)</span>.
In classic statistics, such likelihood ratios are routinely been used for comparison of models.</p>
<p>Previously, I have indicated that the relative frequency gives us the most likely value for parameter <span class="math inline">\(\pi\)</span> (the case of a Bernoulli distributed variable), the <em>maximum likelihood estimate (MLE)</em>.
The MLE is that point in the parameter range (here <span class="math inline">\([0;1]\)</span>), which maximizes the likelihood.
It is the point, where the data is most likely.
In a similar way, the mean of Gaussian distributed measures is the maximum likelihood estimate for the distribution parameter <span class="math inline">\(\mu\)</span>.
But, more advanced models do not have such a closed form, i.e., a formula that you can solve.
Parameter estimation in classic statistics heavily grounds on numerical procedures to find <em>maximum likelihood estimates</em>, which I will outline now:</p>
<p>The probability function <span class="math inline">\(d_\text{Bern}(y_i, \pi)\)</span> has two parameters that vary, the result of a roll <span class="math inline">\(y_i\)</span> and the assumed chance <span class="math inline">\(pi\)</span>.
The likelihood function, as we use it here, in contrast, takes the data as fixed and only varies on parameter <span class="math inline">\(\pi\)</span>.
By varying the parameter and reading the resulting likelihood of data, we can numerically interpolate the MLE.
The most basic numerical interpolation method is a grid search, which starts at the left boundary of parameter range, zero in this case, and walks in small steps along a grid to the right boundary (one).
By convention, maximum likelihood estimation is performed by <em>minimizing the negative log-likelihood</em>.
For the convenience, the following likelihood function has been vectorized, to make it work smoothly in a tidy processing chain.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="ebs.html#cb251-1"></a>LL_bern &lt;-<span class="st"> </span><span class="cf">function</span>(pi) <span class="kw">map_dbl</span>(pi, <span class="cf">function</span>(x) <span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dbern</span>(Rolls<span class="op">$</span>Six, x))))</span>
<span id="cb251-2"><a href="ebs.html#cb251-2"></a></span>
<span id="cb251-3"><a href="ebs.html#cb251-3"></a><span class="kw">LL_bern</span>(<span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.2</span>))</span></code></pre></div>
<pre><code>## [1] -2572 -2563</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="ebs.html#cb253-1"></a>LL_grid &lt;-<span class="st"> </span></span>
<span id="cb253-2"><a href="ebs.html#cb253-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">pi =</span> <span class="kw">seq</span>(.<span class="dv">01</span>, <span class="fl">.99</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb253-3"><a href="ebs.html#cb253-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nlogLik =</span> <span class="op">-</span><span class="kw">LL_bern</span>(pi),</span>
<span id="cb253-4"><a href="ebs.html#cb253-4"></a>         <span class="dt">rank =</span> <span class="kw">min_rank</span>(nlogLik),</span>
<span id="cb253-5"><a href="ebs.html#cb253-5"></a>         <span class="dt">MLE =</span> (rank <span class="op">==</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb253-6"><a href="ebs.html#cb253-6"></a></span>
<span id="cb253-7"><a href="ebs.html#cb253-7"></a>LL_grid  <span class="op">%&gt;%</span><span class="st">          </span></span>
<span id="cb253-8"><a href="ebs.html#cb253-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pi, <span class="dt">y =</span> nlogLik)) <span class="op">+</span></span>
<span id="cb253-9"><a href="ebs.html#cb253-9"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb253-10"><a href="ebs.html#cb253-10"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">filter</span>(LL_grid, MLE), <span class="dt">color =</span> <span class="st">&quot;Red&quot;</span>) <span class="op">+</span></span>
<span id="cb253-11"><a href="ebs.html#cb253-11"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> <span class="kw">filter</span>(LL_grid, MLE), <span class="dt">label =</span> <span class="st">&quot;MLE&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Red&quot;</span>, <span class="dt">nudge_y =</span> <span class="dv">-500</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-89-1.png" width="90%" /></p>
<p>Because we use the <em>negative</em> log-likelihood, the value for <span class="math inline">\(\pi\)</span> with maximum likelihood is the minimum of the likelihood curve.
Here, <span class="math inline">\(\pi_\text{MLE} = 0.15\)</span>, which is very close to the relative frequency we obtained above.
The slight deviation is due to the limited resolution of the grid, but it is always possible to be more accurate by using a finer grid.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="ebs.html#cb254-1"></a>(MLE &lt;-<span class="st"> </span><span class="kw">filter</span>(LL_grid, MLE))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">pi</th>
<th align="right">nlogLik</th>
<th align="right">rank</th>
<th align="left">MLE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.15</td>
<td align="right">2507</td>
<td align="right">1</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>In classic statistics MLE is one of the most common methods for estimating parameters from models.
However, most of the time, data is more abundant and there is more than one parameter.
It is possible to extend the grid method to as many parameters as the model contains by just creating multi-dimensional grids and walk through them by the likelihood function.
However, already a two-dimensional grid of rather coarse <span class="math inline">\(100 \times 100\)</span> would require the computation of 10.000 likelihoods.
Classic statisticians have therefore developed optimization methods to identify the MLE more efficiently.
Soon, we will turn our attention to Bayesian estimation, where the Likelihood plays a central role in estimation, too <a href="ebs.html#bayes-estimation">3.6</a>.</p>
</div>
<div id="bayes-freq-prob" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Bayesian and frequentist probability</h3>
<!-- Inferential statistics serves rational decision making under uncertainty by attaching information on the *level of certainty* to a parameter of interest. A central difference between frequentist and Bayesian statistical theory is how the elusive concept of *certainty* emerges. -->
<!-- Let us for a moment return to how probability was axiomatically defined by Kolmogorov's axioms. The axioms themselves only speak of relations between sets and probability. There is not a trace of any algorithm that would let you construct a set of numbers that actually *qualifies* as probabilities. There is one theory everyone agrees with: relative frequencies satisfy the three Kolmogorov axioms. That can be demonstrated, as I did in section <a href="#Probability"><strong>??</strong></a>, and there is mathematical proof for that, more precisely: if you repeat a random experiment an infinite number of times, relative frequencies are measures for probability. And since not all mathematical theory has such an intuitive interpretation, we can call ourselves lucky. And at the same time it is obvious, because Kolmogorov, like Peano, sat down to formalize something most people intuitively understand.  -->
<p>All statisticians believe that relative frequencies satisfy Kolmogorov’s axioms, but not everyone thinks that this is the only way to measure probability.
This is where frequentist and Bayesian statistics diverge: Frequentists believe that <em>only relative frequencies</em> are valid measures for probability, whereas Bayesians believe that <em>certainty</em> is a measure of probability, too.
As subtle this may sound, it has remarkable consequences in context with Bayes theorem.</p>
<blockquote>
<blockquote>
<p>QUESTION: What is the chance that this dice will fall on Six?</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>FREQUENTIST: I can only answer this question after a long-running series of dice rolls.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>BAYESIAN: I am 50% certain that this is a trick question, so I’d say 50% it never falls on Six.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>If this is not a trick question, this seems to be a dice from a well-known manufacturer, so I’d say 1/6.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>FREQUENTIST (rolles eyes): And how does the manufacturer know?</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>BAYESIAN (sighs): … by a long-running series of experiments.</p>
</blockquote>
</blockquote>
<p>The frequentist in the caricature is someone sticking to the principles: every probability must be produced by relative frequencies, which must be produced in repetitions of the same experiment.
The Bayesian has no problem with long running sequences, but feels confident to use other sources of information.
In a strictly frequentist view, this is like pulling numbers, just in the unit interval, out of the thin air.
But, as we will see, Bayes theorem is amazingly useful, when we allow for probabilities that don’t derive from long-running sequences.
These are called <em>prior probabilities</em> and they can be used to factor in prior knowledge about the world.</p>
<!-- It is our intuition that makes it almost inevitable to think of probability of a set $A$ as relative frequencies, i.e. the ratio of the cardinality of A divided by the cardinality of the universal set $\Omega$. Relative frequency precisely is the frequentist definition of probability: -->
<!-- $$ -->
<!-- P(A) = {|A| \over |\Omega|} -->
<!-- $$ -->
<p>Consequently, a Bayesian also accepts that levels of certainty after the experiment can be reported as probabilities.
In contrast, a frequentist must insist that certainty can be interpreted as long-running series.
In frequentist statistics, a common way to express ones level of certainty is the infamous p-value.
And this is its definition: <em>A result is called statistically significant on level</em> <span class="math inline">\(\alpha = .05\)</span>, if drawing from the null distribution (an infinite number of times) will produce the observed result or a larger result in no more than 5% of cases.</p>
<p>Another, and more preferable way of expressing ones certainty about a parameter (say, the population mean) is the <em>95% confidence interval</em>, which is expressed as two endpoints:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="ebs.html#cb255-1"></a><span class="kw">attach</span>(Sec99)</span></code></pre></div>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="ebs.html#cb256-1"></a>Ver20 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-2"><a href="ebs.html#cb256-2"></a><span class="st">  </span><span class="kw">lm</span>(ToT <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-3"><a href="ebs.html#cb256-3"></a><span class="st">  </span><span class="kw">confint</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">99.8</td>
<td align="right">112</td>
</tr>
</tbody>
</table>
<p>It is common to say: “we can be 95% certain that the true values is between these bounds”, but the 95% confidence interval really is defined by assuming an (infinite) set of replications of the very same experiment and using relative frequencies: <em>The 95% confidence interval is constructed in such a way that, if the same experiment were repeated an infinite number of times, in 95% of these repetitions the true value is contained in the interval.</em></p>
<p>You are not alone when you lack intuition of what the definition says and when you feel at unease about where all these experiments are supposed to come from.
It seems as if a a true frequentist cannot imagine the future other than by a series of long-running experiments.
In Bayesian statistics, the level of certainty is expressed as a <em>proposition about one’s state of knowledge</em>, like : <em>Based on my data I am 95% sure that there is a difference</em>.
Equating level of certainty with probability directly, without taking the detour via relative frequencies, may be a little lax, but it leads to remarkably intuitive statements on uncertainty.
In Bayesian statistics the <em>credibility interval</em> is defined as: <em>With a probability of 95%, the true value is contained.</em> Since there seems to be no external criterion (such as a series of experiments, imagined or not), Bayesian statistics often faced the criticism of being subjective.
In fact, if we imagine a certainty of 95% as some number in the researchers mind, that might be true.
But, it is quite easy to grasp certainty as an objective quantity, when we assume that there is something at stake for the researcher and that she aims for a rational decision.
In the previous chapter I have illustrated this idea by the example of carrying an umbrella with you (or not) and the 99 seconds claim.
Generally, it helps to imagine any such situation as a gamble: if you bet 1 EUR that the true population mean is outside the 95% credibility interval, as a rational person I would put 19 EUR against.</p>
<p>In effect, the Bayesian certainty is a probability in mathematical terms, without the necessity to implement it as a relative frequency.
That liberates our reasoning from the requirement to think of long-running series.
In particular, it allows us to enter non-frequentist probabilities into Bayes theorem, resulting a statistical framework that captures the dynamics of belief in science <a href="ebs.html#dynamics-belief">3.4.6</a>.
Before we come to that, I will explain Bayes theorem in another context of updating knowledge, medical diagnostics.</p>
</div>
<div id="bayes-theorem" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Bayes theorem</h3>
<p>Bayes’ theorem emerges from formal probability theory and therefore is neither Bayesian nor frequentist.
Essentially, the theorem shows how to calculate a conditional probability of interest <span class="math inline">\(P(A|B)\)</span> from a known conditional probability <span class="math inline">\(P(B|A)\)</span> and two marginal probabilities <span class="math inline">\(P(A)\)</span> and <span class="math inline">\(P(B)\)</span>:</p>
<p><span class="math display">\[
P(A|B) = \frac{P(A)P(B|A)} {P(B)}
\]</span></p>
<p>The proof of the theorem is rather simple and does not require repetitiuon here.
But, Bayes’ theorem can lead to rather surprising conclusions, which can be illustrated by example of a medical screening test, as follows:</p>
<p>In the 1980, the human immunodeficiency virus (HIV) was discovered and since then has become a scourge for humanity.
Given that the first outbursts of the disease raged among homosexual men, it is not really surprising that some conservative politicians quickly called for action an proposed a mandatory test for every one, with the results to be registered in a central data base.
Without much of a stretch it may seem justifiable to store (and use) the information that someone is carrying such a dangerous disease.
The problem is with those people who do not carry it, but could be mis-diagnosed.
These are called <em>false-positives</em>.
Let#s assume the power of a screening test has been assessed by examining samples of participants where it is fully known whether someone is a carrier of the virus <span class="math inline">\(C+\)</span> or not <span class="math inline">\(C-\)</span>.
The result is a <em>specificity</em> of 95%, meaning that 95% of <span class="math inline">\(C-\)</span> are diagnosed correctly (<span class="math inline">\(P(T-|C-)\)</span>), and a <em>sensitivity</em> of 99%, meaning that 99% with <span class="math inline">\(C+\)</span> are diagnosed correctly (<span class="math inline">\(P(T+|C+)\)</span>).
The question that Bayes’ theorem can answer in such a situation is <em>How many citizens would be registered as HIV carrying, although they are not?</em>.
For this to work, we must also know the probability that someone randomly chosen from the population is a carrier (<span class="math inline">\(P(C+)\)</span>) and the proportion of positive test results <span class="math inline">\(P(T+)\)</span>.</p>
<!-- # Explain marginal probability p(A) = p(B)p(A|B) + p(-B)p(A|-B), weighted average of probabilities -->
<p><span class="math display">\[
\begin{aligned}
&amp;P(C+) &amp;&amp;&amp;=&amp; .0001\\
&amp;P(C-) &amp;=&amp; 1 - P(C+) &amp;=&amp; .9999\\
&amp;P(T+|C+) &amp;&amp;&amp;=&amp; .99\\
&amp;P(T-|C+) &amp;=&amp; 1 - P(T-|C+) &amp;=&amp; .01\\
&amp;P(T-|C-) &amp;&amp;&amp;=&amp; .95\\
&amp;P(T+|C-) &amp;=&amp; 1 - P(T-|C-) &amp;=&amp; .05\\
&amp;P(T+) &amp;=&amp; P(C+)P(T+|C+) + P(C-)P(T+|C-) &amp;\approx &amp; .05\\
&amp;P(T-) &amp;=&amp; 1 - P(T+) &amp;\approx &amp; .95 
\end{aligned}
\]</span></p>
<p>How do these numbers arise?
The first, <span class="math inline">\(P(C+)\)</span>) is the proportions of HIV carriers in the whole population.
If you have no test at all, that is your best guess for whether a random person has the virus, your <em>prior knowledge</em>.
Then, the validation study of the test provides us with more <em>data</em>.
The study examined the outcome of the test (<span class="math inline">\(T+\)</span> or <span class="math inline">\(T-\)</span>) in two groups of participants, those that were knowingly carriers <span class="math inline">\(C+\)</span> and those that were not <span class="math inline">\(C-\)</span>.
This is where the four conditional probabilities come from.
Finally, we need the expected proportion of positive test results <span class="math inline">\(P(T+)\)</span>, which we compute as a marginal probability over the two conditions.
Because non-carriers <span class="math inline">\(C-\)</span> dominate the population by so much, the marginal probability for a positive test is almost the same as the probability for a positive test amomg non-carriers <span class="math inline">\(P(T+|C-)\)</span>.</p>
<p>All conditional probabilities here emerge from a validation study, where it is known upfront whether someone is a carrier or not.
What matters for the application of the screening test is the reverse: what is learned by test about carrier status?
In the following the test is being characterized by two types of errors that can occur: false alarms and misses.</p>
<ul>
<li>False alarms: What is the probability that someone will be registered as carrier, although being a non-carrier? That is: <span class="math inline">\(P(C-|T+)\)</span>. When the false alarm rate is low, the test is called to have good <em>specificity</em>.</li>
<li>Misses: Which proportion of the tested population are carriers, but have a negative test result (and act accordingly)? That is: <span class="math inline">\(P(C+|T-)\)</span>. When the probability of misses is low, the test is called to have good <em>sensitivity</em>.</li>
</ul>
<p>Using Bayes’ theorem, we obtain the following probability for false alarms:</p>
<p><span class="math display">\[
\begin{aligned}
P(C-|T+) &amp;= \frac{P(C-)P(T+|C-)}{P(T+)}\\
&amp;\approx \frac{.9999 \times .05}{05}\\
&amp;\approx .9999
\end{aligned}
\]</span></p>
<p>Obviously, testing the whole population with the screening test would result in disaster.
Practically everyone who is registered as carrier in the data base is really a non-carrier.
In turn, the probability that a person has the virus despite a negative test result is:</p>
<p><span class="math display">\[
\begin{aligned}
P(C+|T-) &amp;= \frac{P(C+)P(T-|C+)}{P(T-)}\\
&amp;\approx \frac{.0001 \times .01}{.95}\\
&amp;\approx .000001
\end{aligned}
\]</span></p>
<p>We see a strong asymmetry in how useful the test is in the two situations.
Specificity of the test is rather low and stands no chance against the over-whelming prevalence of non-carriers.
In the second use case, prevalence and high test sensitivity work in the same direction, which results in a fantastically low risk to err.
That is what Bayes’ theorem essentially does: it combines prior knowledge (prevalence, <span class="math inline">\(P(C+)\)</span>) against obtained evidence and produces <em>posterior</em> knowledge.
In the following section we will see how this makes Bayes’ theorem a very useful tool in a context that is all about updating knowledge, like in science.
In the case of medical diagnostics, the probabilty <span class="math inline">\(P(C+|T+)\)</span> can be called a posterior probability, but it becomes prior knowledge in teh very moment that new data arrives and we can update our knowledge once again.
A reasonable strategy arises from the asymmetry of certainties: a negative test almost certainly coincides with being a non-Carrier, whereas identifying true carriers remains problematic.
Follow-up research should therefore capitalize on reducing false alarms and use a test with extreme specificity (= absence of false alarms) at the expense of sensitivity.</p>
<!-- It is well-known that common people have problems to really grasp the mechanism of Bayes' theorem. As Gerd Gigerenzer argues from an evolutionary perspective, our mind is much better at understanding probability laws such as Bayes' theorem if it sees  *frequencies* and not bare probabilities. <a href="#REF"><strong>??</strong></a> (Gigerenzer argues that our brains might even be Bayesian machines that operate on frequencies in our personal history with encounters of this and that type.) In fact, the probabilities above once were frequencies in the first place, when the evaluation study was conducted. Specificity and sensitivity are statistics that arise when relative frequencies are presented , i.e. summaries of *2x2 frequency tables*.  -->
<!-- We simulate the situation with a population of 100.000.000: -->
<!-- ```{r} -->
<!-- n_HIV <- 100000000 -->
<!-- set.seed(42) -->
<!-- D_HIV_pop  <-  -->
<!--   tibble(Carrier = as.logical(rbinom(n_HIV, size = 1, prob = .0001))) %>%  -->
<!--   mutate(prob = if_else(Carrier, .99, .05), -->
<!--          Test = as.logical(rbinom(n_HIV, size = 1, prob = prob))) %>%  -->
<!--   group_by(Carrier, Test) %>%  -->
<!--   summarize(N = n()) %>%  -->
<!--   print() -->
<!-- ``` -->
<!-- #### [HERE] -->
<!-- The table below comes in long format and computes the posterior probability in just two steps. First, it takes the frequencies of all positive and negative tests. These are the *margin sums* of Test. -->
<!-- ```{r} -->
<!-- D_HIV_pop %>%  -->
<!--   group_by(Test) %>%  -->
<!--   mutate(margin_Test = sum(N)) %>%  -->
<!--   ungroup() %>% -->
<!--   group_by(Carrier) %>%  -->
<!--   mutate(margin_Carrier = sum(N)) %>%  -->
<!--   ungroup() %>% -->
<!--   mutate(posterior_prob = N /margin_Test, -->
<!--          log_posterior_prob = log(posterior_prob)) %>%  -->
<!--   print() -->
<!-- ``` -->
<!-- <!-- # correct numbers in formulas -> -->
<!-- Now, we clearly see how it happens: Despite to the gigantic sample size, only 108 persons were actually carriers, due to the low prevalence of the virus. Only 1 in 949906 is a carrier with a negative test result. At the same time, almost everybody who has a positive test is not a carrier, just because almost everybody is a non-carrier. To be fair, part of the magic is an assumption we made: the evaluation study is fully representative as it reflects the true distribution of carriers in the full population. Probably, a real study would be conducted with a biased sample, say 100 carriers and 100 non-carriers. That is not a problem, if we first adjust for prevalence and then carry out the same procedure: -->
<!-- ```{r} -->
<!-- TestEval <-  -->
<!--   tribble(~Carrier,   ~Test,  ~prevalence, ~N, -->
<!--           T,          T,      .0001,       99,       -->
<!--           T,          F,      .0001,        1, -->
<!--           F,          T,      .9999,        5, -->
<!--           F,          F,      .9999,       95) %>%  -->
<!--   group_by(Test) %>%  -->
<!--   mutate(margin_Test = sum(N)) %>%  -->
<!--   ungroup() %>%  -->
<!--   mutate(prob = (N /margin_Test)) %>%  -->
<!--   print() -->
<!-- ``` -->
<!-- ```{r opts.label = "future"} -->
<!-- M_TestEval <- -->
<!--   stan_glm(cbind(freq,sum_Test) ~ 0 + Carrier : Test,  -->
<!--            family = "binomial", -->
<!--            data = TestEval) -->
<!-- ``` -->
<!-- ```{r opts.label = "future"} -->
<!-- M_TestEval -->
<!-- ``` -->
<!-- <!-- find correct term for testAbundnc -> -->
</div>
<div id="dynamics-belief" class="section level3">
<h3><span class="header-section-number">3.4.6</span> Bayesian dynamics of belief</h3>
<!-- ##### REWORK -->
<!-- As the procedure of testing everyone for HIV may seem reasonable at first, it turned out to be impractical. That is an example of how a principally intuitive theories like Probability Theory can result in counter-intuitive, but correct, answers. These are the most valuable answers, actually. -->
<!-- In Bayesian statistics -->
<!-- $$\text{posterior}\ \propto \text{prior}\times\text{likelihood}$$ -->
<!-- <!-- #24 -> -->
<!-- Note that $\propto$ here means *proportional to*. In very plain words this is: -->
<!-- > what you believe now is a combination of what you knew before and what you have just seen in the data. -->
<p>Bayes’ formula is just a law that follows directly from probability theory.
It can easily be illustrated in terms of frequencies: If the number of false alarms is very small in a small group, it gets large in a very large group.
What makes such an innocent formula the patron of Bayesian Statistics?</p>
<p>Bayes’ formula can be seen as a sort of knowledge processing device.
At the example of HIV test, what we want to know is how likely it is that someone is infected.
That is something we can already do without any test, if we have an idea about the prevalence of infections.
It already helps to know that only 1 in 10.000 has it.
It is a rare desease, so usually no reason to get paranoid!
In contrast, if you are running blood bank, knowledge of prevalence is just not good enough and a test is required.
This test is used not to make up our minds, but to update our minds.
Bayes’ formula is just a rational way of updating knowledge by combing what one knew before and what one learns from the present data.
A Bayesian estimation takes <em>prior knowledge</em> <span class="math inline">\(P(\theta)\)</span> and the <em>likelihood</em> <span class="math inline">\(P(\text{Data}|\theta)\)</span>, representing the data as input and the output is <em>posterior knowledge</em> <span class="math inline">\(P(\theta|\text{Data})\)</span>:</p>
<p><span class="math display">\[
P(\theta|\text{Data}) = 
\frac{ P(\theta) P(\text{Data}|\theta)}{P(\text{Data})}
\]</span></p>
<p>As it turns out the marginal likelihood <span class="math inline">\(P(Data)\)</span> cannot be known or easily estimated.
The reason why we can still use Bayes rule for estimation is that this term does not depend on the parameter vector <span class="math inline">\(\theta\)</span>, which is our search space, meaning that it is practically a constant.
For parameter estimation, Bayes rule can be reduced to saying that the posterior certainty is <em>proportional to</em> the product of prior certainty and evidence:</p>
<p><span class="math display">\[
\text{posterior}\ \propto \text{prior}\times\text{likelihood}
\]</span></p>
<p>Recall that the likelihood is the probability of the data at hand, given parameter <span class="math inline">\(\theta\)</span>.
This is typical for frequentist statistics, which assumes that there is one true value and all randomness is caused by fluctuations in the set of possible samples.
Your data is just one fish from the pond.
Bayesians typically feel that data is the real thing and that parameter <span class="math inline">\(\theta\)</span> is never really true, but represents teh current state of knowledge.</p>
<p>Brains process data, too, and some argue that the behaviour of brains can be described as Bayesian engines.
It is true that prior knowledge is something we use everyday, and many things we do know because of our genes.
For example, parents sometimes report that their toddlers abruptly start to reject food that is green.
This is often perceived as stubborn behaviour, because of vitamines, fiber, lack of sugar and the greenhouse effect.
If it is true, that our ancestors headed their ways through a savannah, the child may actually be right.
Savannah flora’s worst enemy are vegetarian savannah animals, and in an arms race, plants have developed an abundance of weapons, such as a tough structure, scarcity of nutriants, thorns, blades and poisons.
The child knows that green stuff usually is not edible or even dangerous.
This prior knowledge is so over-whelming, that it costs modern parents a lot of patience to update their childrens knowledge of food, and reportedly many fail.
A Bayesian statistician would call this a <em>strong prior</em>.</p>
<p>Science is what only some central nervous systems do, but the principle is the same: we have a theory which we are unsure about; data is collected and after that we may find this theory more likely or reject it.
Testing theories is not a one-shot.
Some theories have been tested many times For example, in the famous Stroop effect, participants have to name the ink color of a word.
When the word is itself a color word and refers to a different color, response times typically increase.
This effect has been replicated in many dozens of published studies and, probably, thousands of student experiments.
Cumulative evidence is so strong that, would someone repeat the experiment another time and find the reverse effect, no one would seriously take this as a full debunk of decades of research.
In Bayes’ formula, prior and posterior are both probabilities, which means we can use the posterior from experiment <span class="math inline">\(n\)</span> as prior for experiment <span class="math inline">\(n + 1\)</span>, or:</p>
<!-- from data are both of the same kind, which means that the   -->
<!-- The previous section closed with the remark that more research could solve the dilemma of testing diseases with a very low prevalence, and the same goes here: Even just one negative result on teh Stroop effect can raise some mild suspicions about the effect's  universalality and someone may feel that another  replication is required. One  principle of Bayesian thinking is: -->
<blockquote>
<p>Today’s posterior is tomorrow’s prior.</p>
</blockquote>
<p>There is no principled difference between prior and posterior knowledge.
They are just degrees of belief at different points in time, expressed as probabilities.
Both can differ in strength: prior knowledge can be firm when it rests on an abundance of past evidence.
But, prior knowledge can also be over-ruled when a lot of data disproves it.
Evidence in data varies in strength: for example, the more observations, the larger the (negative) likelihood becomes, which means stronger evidence.
If measures are more accurate (and less disturbed by randomness), smaller sample sizes suffice to reach conclusions of similar strength.
This is why larger sample sizes are preferred and why researchers try to improve their methods.</p>
<!-- Prior belief and evidence by data can be congruent or contradict each other. When they are congruent, prior belief is just strengthened by the data. When they are contradicting each other, prior belief is over-ruled to some degree, depending on the strength of (counter-) evidence. Updating our knowledge is essential for individual decision makers, but in particular applies for scientific progress. -->
<!-- That is something people do all the time, if they are not too stubborn. And not just people: most, if not all, biological brains update their image of the environment in order to act for the benefit of their fitness.  -->
<!-- This mechanism of updating states of beliefs is what sets Bayesian statistics apart and it reverbs with what happens in the real world and in science: -->
<!-- + Someone skeptical of climate change may change their view after a couple of very hot summers. -->
<!-- + When almost everyone believed in Newton's Mechanics as ground truth, some people got curious when it turned out that light speed is constant for every observer. -->
<!-- Note how these examples all have the same dynamics: a prior belief is updated when new data arrives.  -->
<!-- Brains process data, too, and some argue that the behaviour of brains can be described as Bayesian engines. It is true that prior knowledge is something we use everyday, and many things we do know because of our genes. For example, parents sometimes report that their toddlers abruptly start to reject food that is green. This is often perceived as stubborn behaviour, because of vitamines, fiber, lack of sugar and the greenhouse effect. If it is true, that our ancestors headed their ways through a savannah, the child may actually be right. Savannah flora's worst  enemy are vegetarian savannah animals, and in an arms race, plants have developed an abundance of weapons, such as a tough structure, scarcity of nutriants, thorns, blades and poisons. The child knows that green stuff usually is not edible or even dangerous. This prior knowledge is so over-whelming, that it costs modern parents a lot of patience to update their childrens knowledge of food, and reportedly many fail. -->
<!-- In the previous section we have seen an application of Bayes theorem where it served to evaluate a diagnostic procedure. We saw that the very low prevalence for HIV required an extreme specificity for the test to be useful.  -->
<!-- In Bayesian statistics, certainty (or strength of belief, state of knowledge, credibility) is assumed to follow all rules of probability theory. We may still think of it in terms of frequencies or illustrate it as a gamble, whatever fits the context better.  -->
<!-- In this equation, the only probability that has been measured by frequencies is the *likelihood* $P(\theta|\text{Data})$, where $\theta$ is the parameters to be estimated  (e.g. $\pi$ of Bernoulli distributions). This likelihood carries *evidence from data*. $P(\theta|\text{Data})$ is the *posterior certainty*, or how much we believe in a parameter position, after seeing the data. Posterior certainty turns out to be proportional to the product of *prior certainty* $P(\theta)$ and likelihood. This is the place where prior knowledge and strength of evidence are weighed against each other, for example how strongly we belive that a dice is fair. $P(\text{Data})$ is called the *marginal likelihood*. -->
<!-- In section [#likelihood] it was explained how parameters can be estimated by maximum likelihood estimation. This procedure compared the likelihood over a range of parameter values to determine the position that makes the observed data most likely. In the context of parameter estimation, a model is just such a position in parameter space. Bayesian estimation does it very similar, but operates on posterior probability, which includes prior knowledge.  -->
<!-- The second possible meaning of Model is that it denotes a particular likelihood function. As we will see in the second part of this book, the likelihood function is where we express our theories as mathematical relations between measured variables. For example, we can imagine that time-on-task (ToT) in a design evaluation study is related to age, which we would express by the following linear models ($M_\text{LRM}$), or it is not ($M_\text{GMM}$) -->
<!-- $$ -->
<!-- M_\text{GMM}: y_i = \text{Gaus}(\beta_0, \sigma_\epsilon)\\ -->
<!-- M_\text{LRM}: y_i = \text{Gaus}(\beta_0 + \beta_1 x_\text{age}, \sigma_\epsilon) -->
<!-- $$ -->
<!-- If we can solve Bayes rule for these two models, we would be able to compare them by which is called the *Bayes Factor*: -->
<!-- $$ -->
<!-- BF(M_1, M_2) =  -->
<!-- {P(M_1|\text{Data}) P(M_2)  \over P(M_2|\text{Data}) P(M_1)} -->
<!-- $$ -->
<!-- A Bayes Factor larger than 1 indicates that model $M_1$ is the one to be believe in more.  -->
<!-- Bayes Factor is a great tool to assign certanties, meaning real probabilities,  to models, or even theories, but there is one problem: in most cases, Bayes rule cannot be solved, because  -->
<!-- #24 -->
<!-- Note that $\propto$ here means *proportional to*. In very plain words this is: -->
<!-- or in plain words: -->
<!-- > what you believe now is a combination of what you knew before and what you have just seen in the data. -->
<!--#25-->
<p>The problem with frequentist statistics is that it has not developed general methods to incorprorate prior knowledge in the analysis.
It is even worse: When practicing null hypothesis significance testing, which is very common among frequentists, you strictly <em>must not update</em> your degree of belief during the study and act accordingly.
Neither is there a way to express one’s prior belief when doing a t-test, nor may you adjust sample size ad hoc until satisfactory certainty is reached.
Classic data analysis pretends as if no one has ever done any such an experiment before.
Also, it is strictly forbidden to invite further participants to the lab, when the evidence is still to weak.
If you planned the study with, say, <span class="math inline">\(N = 20\)</span>, this is what you must do, no less no more.
If you reach your goal with less participants, you must continue testing.
If you are unsatisfied with the level of certainty, the only permissible action is dump your data and start over from zero.
The frequentist denial of incremental knowledge is not just counter-intuitive in all science, it is a millstone around the neck of every researcher.</p>
<!-- To get to a practical example, reconsider Jane and Andrew [#decision_making]. What did they know about the current state of affairs when running a particular session? Using some time-on-task measures they disproved the claim "rent a car in 99 seconds". Recall how the question was phrased, precisely: on average, users had to be able to complete the transaction in 99 seconds. The statistic of interest is the mean. This was debunked with almost no effort, by calculating: -->
<!-- $$\hat M_{ToT} = 1 \over n * \sum{ToT} = 105.975$$ -->
<!-- But how about the updated slogan: "rent a car in 111 seconds".  Can we be sure it holds, when someone repeats the study? We can only to a degree. It could still happen, that the belligerent  competitor comes to a different result, just because they have a different sample of participants. Even if they would test a fully matching sample of participants, the measures will differ, simply because an array of smaller and larger impact factors is continuously  hitting the central and peripheral nervous systems of your participants. The result is randomness in the data. Fortunately, randomness is often found to be well-behaved in that recurrent patterns emerge. These patterns are called distributions of randomness and I will introduce a whole bunch of them later in this chapter @\ref().  -->
<!--


So, if everybody would just do descriptive statistics, we were done, here: Identify the quantitative summary that suits your situation and compute it. However, what happens the field of statistics strongest contribution is that the level of uncertainty can also be quantified. 


Inferential statistics is required, whenever there is imperfect evidence and when there is skin-in-the-game.


This uncertainty arises from incomplete knowledge: only a small fraction of potential users have been tested, whereas the claim is about the whole population. Notice that I have not written the sample mean as $M$, but put a "hat" on it. That is to denote that the sample mean is an *estimate* for the population mean. The term estimate usually denotes that it is reasonable (intuitive, as well strictly mathematical) to assume that the statistic obtained from the sample is useful for making claims about the whole population. At the same time, every sample of users carries only partial information on the whole population, such that the estimate is imperfect.

A consequence of imperfection is that when another sample is drawn, one usually does not obtain the precise same estimate. The fluctuation of samples from an unknown population is what classic frequentist statistics draws upon. In the case of Jane and Andrew, a frequentist statistician would ask the question:

> How certain can you be that in the population of users $M_{ToT} <= 99$?

For frequentist thinkers the idea of the sample is central and the mathematical underpinning rests on an experiment of thought: how would all other possible samples look like? Here, following the Bayesian approach, and the fluctuation in sample statistics we consider a consequence of uncertainty. All of them carrying incomplete information, and inferential Bayesian statistics centers around full quantification of uncertainty. As we have seen, uncertainty about a future ivent to occur, is crucial for decision making on rational grounds.


-->
</div>
</div>
<div id="statmod" class="section level2">
<h2><span class="header-section-number">3.5</span> Statistical models</h2>
<p>It is a scientific, maybe even naturalistic, principle that every event to happen has its causes (from the same universe).
The better these causes are understood, the better will be all predictions of what is going to happen the next moment, given that one knows the complete state of the universe and the laws of physics.
<em>Laplace demon</em> is a classic experiment of thought on the issue: the demon is said to have perfect knowledge of laws of physics and about the universe’s current state.
Within naturalistic thinking, the demon should be able to perfectly predict what is going to happen in the next moment.
Of course, such an entity could never exist, because it would actually be a computer that matches the universe in size (and energy consumption).
In addition, there are limits to how precisely we can measure the current state, although physicist and engineers have pushed the limits very far.
Behavioural science frequently lacks this precision, which results in rather imperfect knowledge about the state.
We are often left with a good amount of uncertainty.</p>
<p>When Violet did her experiment to prove the superiority of design B, the only two things she knew about the state of affairs was that the participant sitting in front of her is member of a very loose group of people called the “typical user” and the design her or she was exposed to.
That is painstakingly little information on what’s currently going on in the participant’s central nervous system.
Her lack of knowledge is profound but still not a problem as the research question was on a gross scale itself, too.
Not what happens to individual users needed to be described, but just the difference in <em>average</em> duration.</p>
<p>Imagine Violet and a colleague had invented a small game where they both guess the time-on-task of individual participants as they enter the lab.
Who comes closest wins.
As both players are smart people, they do not just randomly announce numbers, but let themselves guide by data of previous sessions.
A very simple but reasonable approach would be to always guess what the average ToT in all previous sessions has been.
In <a href="lm.html#gmm">4.1</a>, we will call this a grand mean model.</p>
<p>Of course, Violet would never expect her grand mean model to predict the accurate outcome of a session.
Still, imagine a device that has perfect knowledge of the website, the complete current neural state of a the participant and the physical environment both are in.
As an all-knowing device it would also have complete knowledge on how neural states change.
With this device, Jane could always make a perfect prediction of the outcome.
Unfortunately, real design researchers are far from Laplace demonism.
Routinely borrowing instruments from social sciences, precision of measurement is humble and the understanding of neural processes during web navigation is highly incomplete.
Participants vary in many complex ways in their neural state and this makes a myriad of <em>small unmeasured forces (SMURF)</em> that can steer an individual users towards or away from the average.
Laplace demon would have perfect knowledge of all forces and would produce a perfect prediction.
Violet, in contrast, is completely ignorant of any SMURFs and her predictions will be way off many times.</p>
<p>A common way to conceive this situation is that all measures are composed of a <em>structural part</em>, that captures the relation between known and measured forces and a <em>random part</em>, that serves as a bucket for unmeasured forces.</p>
<p><span class="math display">\[
\text{Measure}_i = \text{structural part} + \text{random part}_i
\]</span></p>
<p><em>Note</em> that Measure and Random part both have an observation-level index <span class="math inline">\(i\)</span>, which means they are <em>unique</em> per observation <span class="math inline">\(i\)</span>.
The structural part does not have such an index, because it is usually designed as a <em>universal</em> statement, a proposition that holds for all the observations.
If this were different, there would be no way to make predictions from the model.
After a minimally sufficient introduction to the matter, the remainder of this section will focus on the random part and we will discover that randomness is <em>not</em> completely arbitrary, but falls into certain <em>shapes of randomness</em>.
And for the scope of this book, a <em>statistical model</em> is defined as a <em>mechanism that separates the structural from the random part</em> to some extent.</p>
<div id="structural-part" class="section level3">
<h3><span class="header-section-number">3.5.1</span> The structural part</h3>
<p>Generally, statistical models consist of these two parts: a structural part that describes the association between measures and the random part, which is the sum of all small unmeasured forces (SMURFs).
The structural part of statistical models is called so, because it describes what all observations supposedly have in common.
The structural part is what encodes the structure of a study and the dependencies between measures.</p>
<p>The most simple structure is just that an observation was taken on a member of a population.
If we speak of a population (rather than a set), we typically imply that members of the population have something in common.
The most simple structural part is therefore taking the mean of the population, which is also called a Grand Mean Model <a href="lm.html#gmm">4.1</a>.
From here on, <span class="math inline">\(\mu_i\)</span> is the result of the structural part for one observation, which for a GMM, is just a constant <span class="math inline">\(\beta_0\)</span>.</p>
<p><span class="math display">\[
\mu_i = \beta_0
\]</span></p>
<p>We will see throughout chapters <a href="lm.html#lm">4</a> and <a href="mlm.html#mlm">5</a>, how the structural part encodes complex dependencies between measures.</p>
<p>The structural part makes a universal statement about the relation between measures.
This can basically be anything.
However, in many (if not most) statistical models, it is common to separate the set of measure into exactly one <em>response</em> (or outcome, or dependent variable) and a set of predictor variables.
In the GMM above, there are no predictors, just a constant value.</p>
<p>In the guessing game, Violet could try to improve her guesses, by also taking age of participants into account.
Older people tend to be slower.
Violet could create a plot from past records.
The ellipsoid form of the point cloud indicates that ToT is somehow depending on age.
Violet draws a straight line with an upward slope to approximate the relationship.
It seems that zero year old persons has an average ToT of around 45 seconds, which increases to around 120 seconds for 50 year old.
Arithmetically, this is an increase of around 1.5 seconds per year of age.</p>
<pre><code>## 
## Call:
## lm(formula = ToT ~ age, data = Sec99$Ver20)
## 
## Coefficients:
## (Intercept)          age  
##       45.31         1.46</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="ebs.html#cb258-1"></a>Sec99<span class="op">$</span>Ver20 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-2"><a href="ebs.html#cb258-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> ToT)) <span class="op">+</span></span>
<span id="cb258-3"><a href="ebs.html#cb258-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb258-4"><a href="ebs.html#cb258-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">fullrange =</span> T) <span class="op">+</span></span>
<span id="cb258-5"><a href="ebs.html#cb258-5"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>,<span class="dv">60</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-94-1.png" width="90%" /></p>
<p>Violet can use this information to improve her chance of winning.
Instead of stoically calling the population mean, she uses a linear function as predictor: $45 + ( ) 1.5 $.
This is called a <em>linear association</em> and the general notation is</p>
<p><span class="math display">\[
\mu_i = \beta_0 + \beta_1x_{1i}
\]</span></p>
<p>where <span class="math inline">\(\beta_0\)</span> is the intercept value, <span class="math inline">\(X_1\)</span> is a measure (age) and <span class="math inline">\(\beta_1\)</span> is a <em>coefficient</em>.
The primary purpose of using a model on data is to estimate the coefficients.</p>
<!-- The structural part of a model connects the *expected value* $\mu$ with *observed variables* $x_{i1}, x_{i2}, ..., x_{ik}$, and (to be estimated) parameters, e.g. $\beta_0, \beta_1$. The likelihood function is often called the *deterministic part* of a model, because its prediction strictly depends on the observed values and the predictors, but nothing else. For example, two persons of age 30 will always be predicted to use up 90 seconds. Apparently, this is not the case for real data. -->
<p>Linear models are very common in statistical modeling, but the structural part of a model can basically take all mathematical forms.
For example:</p>
<ul>
<li>two predictors with a linear relationship: <span class="math inline">\(\mu_i = \beta_0 + \beta_1x_{1i} + \beta_1x_{2i}\\\)</span></li>
<li>a parabolic relationship: <span class="math inline">\(\mu_i = \beta_0 + \beta_1x_{1i} + \beta_2x_{2i}^2\)</span></li>
<li>a nonlinear learning curve: <span class="math inline">\(\mu_i = \beta_\textrm{asym} (1 + \exp(-\beta_\textrm{rate}(x_\textrm{training} + \beta_\textrm{pexp})))\)</span></li>
<li>the difference between groups A and B, where <span class="math inline">\(x_1\)</span> is a membership (dummy) variable coded as <span class="math inline">\(A\rightarrow x_1:=0, B\rightarrow x_1:=1\)</span>: <span class="math inline">\(\mu_i = \beta_0 + \beta_1x_{1i}\)</span></li>
</ul>
<p>In the vast majority of cases, the structural part is the one of interest, as this is where researchers transform their theoretical considerations or practical questions into a mathematical form.
The parameters of the likelihood function are being estimated and answer the urging questions, such as:</p>
<ul>
<li>Is the design efficient enough? (<span class="math inline">\(\beta_0\)</span>)</li>
<li>By how much does performance depend on age? (<span class="math inline">\(\beta_1\)</span>)</li>
<li>Under which level of arousal does performance peak? (determining the stationary point of the parabola)</li>
<li>How fast people learn by training (<span class="math inline">\(\beta_\textrm{rate}\)</span>)</li>
<li>By how much design B is better than A (<span class="math inline">\(\beta_1\)</span>)</li>
</ul>
<p>A subtle, but noteworthy feature of structural part is that <span class="math inline">\(\mu_i\)</span> and <span class="math inline">\(x_i\)</span> have indicators <span class="math inline">\(i\)</span>.
Every observation <span class="math inline">\(i\)</span> has their own measures and therefore the realization of the structural part gets a unique expected value.
In contrast, the coefficients <span class="math inline">\(\beta_0, \beta_1\)</span> asf.
are universal values that apply for all observations at once.</p>
<!-- In fact, we can conceive statistical models as operating on multiple levels, where there is always the two: the observation level and the population level. When introducing multi-level models, we will see how this principle extends to more than these two levels. Another related idea is that parameters summarizes patterns found in data. Any summary implies repetition and that is what the likelihood expresses: the pattern that repeats across observations and is therefore predictable. -->
<p>When all all measures <span class="math inline">\(y\)</span>, <span class="math inline">\(x\)</span> are known and all coefficients <span class="math inline">\(\beta_.\)</span> have been estimated, we can solve the structural part and obtain a unique value <span class="math inline">\(\mu_i\)</span> for all observations.
Considering that <span class="math inline">\(y_i = \mu_i + \text{random part}\)</span>, that means we can also view model estimation of a model as a separation of structural part and random part.
Unfortunately, it is not sufficient to just have measures and a structural part.
We also need to know the shape of randomness and put this into the model.</p>
</div>
<div id="distributions" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Distributions: shapes of randomness</h3>
<!--
+ spell out R code hidden in figures and formulas to teach Rs distribution commands along the way
+ change trials to attempts for binomial distributions to not confuse with experimental trails
- discrete or continuous
- cumulative probability
- sums to one
- density intervals
- probability and density
+ range of support
+ parameters
- location and dispersion
+ in R
-->
<p>Review the formula <span class="math inline">\(\text{Measure}_i = \text{structural part} + \text{random part}_i\)</span>.
What do we actually have?
It turns out that the only part we know for sure are measures <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_{.i}\)</span>.
The structural part contains the answer to our research question, so this is what we want to estimate.
Unfortunately, there is another unknown, the <span class="math inline">\(random part\)</span>, which we literally need to subtract to get to our answers.
Obviously, this would never work if the random part were random in the sense of being completely arbitrary.
Fortunately, randomness is not arbitrary, but has a shape, which is described as a probability (or density) distribution.
These distributions typically belong to a certain family of distribution functions, e.g.
Poisson disributions or Gaussian distributions.
By assuming a certain shape of randomness, we know a lot more about the random component, which will make it possible to flesh out the structure.
Choosing the most appropriate distribution therefore is a crucial step in creating a valid statistical model.
In this section I will introduce in more depth how probability and density distributions describe the shape of randomness.</p>
<div id="prob-density-dist" class="section level4">
<h4><span class="header-section-number">3.5.2.1</span> Probability mass and density</h4>
<p>The random part of a statistical model contains all (small) unmeasured forces on the response <span class="math inline">\(y_i\)</span>.
When using the grand mean model, the only information we are using is that the person is from the target population.
Everything else is left to the unobserved SMURFs and that goes into the random part of the model.
Fortunately, SMURFs don’t work completely arbitrary and in practice there is just a small number of recognizable shapes randomness can take.
These patterns can be formulated mathematically as either <em>probability mass functions (PMF)</em> or <em>probability density functions (PDF)</em>. The difference between PMF and CDF is that PMF only work for discrete measures, such as anything that is countable, whereas CDF also apply for continuous measures, such as ToT. In general, any PMF can also be called a CDF, but it is instructive to start with a case of discrete measures.</p>
<p>In the case of discrete measaures, a PMF assigns <em>probabilities to possible outcomes</em>.
Let’s see an example: A participant is asked to complete three tasks of constant difficulty, that is a chance of <span class="math inline">\(.3\)</span> to be solved.
The outcome variable of interest is the number of correct results, which can take the values 0, 1, 2 or 3.
Under idealized conditions (but not removing randomness), a Binomial distribution assigns every possible outcome a probability to occur, it is given as:</p>
<p><span class="math display">\[
P(y|p,k) = {k  \choose y}p^y(1-p)^{k-y}
\]</span></p>
<p>A Binomial distribution with probability of success <span class="math inline">\(p = .3\)</span> and <span class="math inline">\(k = 3\)</span> tasks looks like the following:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="ebs.html#cb259-1"></a>D_three_tasks &lt;-<span class="st"> </span></span>
<span id="cb259-2"><a href="ebs.html#cb259-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">y =</span> <span class="dv">-1</span><span class="op">:</span><span class="dv">4</span>,</span>
<span id="cb259-3"><a href="ebs.html#cb259-3"></a>             <span class="dt">outcome =</span> <span class="kw">as.character</span>(y),</span>
<span id="cb259-4"><a href="ebs.html#cb259-4"></a>             <span class="dt">probability =</span> <span class="kw">dbinom</span>(y, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>),</span>
<span id="cb259-5"><a href="ebs.html#cb259-5"></a>             <span class="dt">cumul_prob     =</span> <span class="kw">pbinom</span>(y, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>))</span>
<span id="cb259-6"><a href="ebs.html#cb259-6"></a></span>
<span id="cb259-7"><a href="ebs.html#cb259-7"></a></span>
<span id="cb259-8"><a href="ebs.html#cb259-8"></a>D_three_tasks <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb259-9"><a href="ebs.html#cb259-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> outcome, <span class="dt">y =</span> probability)) <span class="op">+</span></span>
<span id="cb259-10"><a href="ebs.html#cb259-10"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb259-11"><a href="ebs.html#cb259-11"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb259-12"><a href="ebs.html#cb259-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-95-1.png" width="90%" /></p>
<p>As we can see, there exist four possible outcomes for a sequence of three tasks: zero, one, two and three tasks correct.
We also see that the most likely outcome is one correct task, which occurs with a probability of <span class="math inline">\(P(y = 1) = 0.441\)</span>.
At the same time, it is surprisingly likely to fail at all tasks, <span class="math inline">\(P(y = 0) = 0.343\)</span>.
We may also look at <em>combined events</em>, say the probability for less than two correct.
That is precisely the sum <span class="math inline">\(P(y \leq 1) = P(y = 0) + P(y = 1) = 0.784\)</span>.
We can bundle basic events by adding up the probabilities.
An extreme case of that is the universal event that includes all possible outcomes.
You can say with absolute certainty that the outcome is, indeed, within zero and three and certainty means the probability is 1, or: <span class="math inline">\(P(0 \leq y \leq 3) = 1\)</span>.
Simply in order to comply with the third Kolmogorov axiom, all PMF have <em>probability mass of One</em>.
More precisely, the area covered by the function must be exactly One.
Another extreme outcome is that four out of three tasks are correct, which is impossible, or <span class="math inline">\(P(y &gt; 3) = 0\)</span>.</p>
<p>Number of successes is a countable measure, and are therefore called <em>discrete</em>.
If we want to obtain the probability of combined events, we just have to sum probabilities over all the included events, which is like stacking the blocks in the figure above.
This approach fails, if the outcome is not discrete, but <em>continuous</em>.
On a continuous scale, every outcome is a one-dimensional line, in the strictly geometrical sense.
Because it has an area of zero, the probability mass of any such point is zero.
For example, the probability that the outcome of a continuous measure is <em>exactly</em> 42.18 is zero.</p>
<p>when the measure is continuous, rather than discrete, we cannot assign non-zero probabilities to exact outcomes.
But, we can give non-zero probabilities to <em>ranges of outcome</em>.
Consider the distribution of intelligence quotients (IQ) scores.
Strictly spoken, the IQ is not continuous, but for instructional reasons, let us assume it were and we can give the IQ with arbitrary precision, for example <span class="math inline">\(115.0\)</span>, <span class="math inline">\(100.00010...\)</span> or <span class="math inline">\(\pi * 20\)</span>..</p>
<p>IQ scores are <em>designed to follow the Gaussian</em> distribution with a mean of 100 and a standard distribution of 15, so we can easily simulate some data for 200 participants undergoing an IQ test.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="ebs.html#cb260-1"></a>D_IQ &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">IQ =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">2000</span><span class="op">/</span><span class="dv">10</span>,</span>
<span id="cb260-2"><a href="ebs.html#cb260-2"></a>               <span class="dt">density =</span> <span class="kw">dnorm</span>(IQ, <span class="dv">100</span>, <span class="dv">15</span>),</span>
<span id="cb260-3"><a href="ebs.html#cb260-3"></a>               <span class="dt">cdf =</span> <span class="kw">pnorm</span>(IQ, <span class="dv">100</span>, <span class="dv">15</span>),</span>
<span id="cb260-4"><a href="ebs.html#cb260-4"></a>               <span class="dt">SE =</span> (IQ <span class="op">&gt;</span><span class="st"> </span><span class="dv">85</span> ) <span class="op">*</span><span class="st"> </span>(IQ <span class="op">&lt;=</span><span class="st"> </span><span class="dv">115</span>) <span class="op">*</span><span class="st"> </span>density,</span>
<span id="cb260-5"><a href="ebs.html#cb260-5"></a>               <span class="dt">around_100 =</span> (IQ <span class="op">&gt;=</span><span class="st"> </span><span class="dv">99</span> ) <span class="op">*</span><span class="st"> </span>(IQ <span class="op">&lt;=</span><span class="st"> </span><span class="dv">101</span>) <span class="op">*</span><span class="st"> </span>density,</span>
<span id="cb260-6"><a href="ebs.html#cb260-6"></a>               <span class="dt">PDF_085 =</span> (IQ <span class="op">&lt;</span><span class="st"> </span><span class="dv">85</span>) <span class="op">*</span><span class="st"> </span>density,</span>
<span id="cb260-7"><a href="ebs.html#cb260-7"></a>               <span class="dt">PDF_115 =</span> (IQ <span class="op">&lt;</span><span class="st"> </span><span class="dv">115</span>) <span class="op">*</span><span class="st"> </span>density,</span>
<span id="cb260-8"><a href="ebs.html#cb260-8"></a>               <span class="dt">label =</span> <span class="kw">str_c</span>(<span class="st">&quot;P(IQ &lt; &quot;</span>, IQ, <span class="st">&quot;)&quot;</span>))</span>
<span id="cb260-9"><a href="ebs.html#cb260-9"></a></span>
<span id="cb260-10"><a href="ebs.html#cb260-10"></a>D_IQ <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb260-11"><a href="ebs.html#cb260-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> IQ, <span class="dt">y =</span> density)) <span class="op">+</span></span>
<span id="cb260-12"><a href="ebs.html#cb260-12"></a><span class="st">  </span><span class="kw">geom_area</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-96-1.png" width="90%" /></p>
<p>We observe that the most likely IQ is 100 and that almost nobody reaches scores higher than 150 or lower than 50.
But, how likely is it to have an IQ of exactly 100?
The answer is Zero.
With continuous measures, we can no longer think in blocks that have a certain area.
In fact, the probability of having an IQ of <em>exactly</em> <span class="math inline">\(100.00...0\)</span> is exactly zero.
That is why continuous outcome variables cannot be stated to have a PMF, but a <em>probability density distribution (PDF).</em> At the example of the above Gaussian distribution, we can still identify the point of highest density (IQ = 100), but the density scale is <em>not probabilities</em>.
What CDFs share with PDFs is that the area under the curve is always exactly One.
In addition, probabilities still arise from density when taking intervals of values, which is nothing but combined events.
Before we return to that, another way of specifying statistical distributions must be introduced.</p>
<p>A cumulative distribution function is the <em>integral</em> of a PDF or CDF.
<em>Cumulative distribution functions (CDF)</em> render how probability mass increases when moving steadily from left to right over the outcome scale.
Because probability and density are non-negative, a CDF always is <em>monotonously increasing</em>.
Below we see the CDF of the three-tasks situation.
The function starts at Zero, then moves upwards in increments and reaches One at the right end of the scale.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="ebs.html#cb261-1"></a>D_three_tasks <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb261-2"><a href="ebs.html#cb261-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> cumul_prob)) <span class="op">+</span></span>
<span id="cb261-3"><a href="ebs.html#cb261-3"></a><span class="st">  </span><span class="kw">geom_step</span>() <span class="op">+</span></span>
<span id="cb261-4"><a href="ebs.html#cb261-4"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-97-1.png" width="90%" /></p>
<p>Using the CDF, the probability for any outcome to be in a certain range can be written as the difference between the upper and the lower limit of cumulative probability.
For example, the probability of having zero or one tasks correct is</p>
<p><span class="math inline">\(P(\text{correct} \le 1) = \text{CDF}_{Binom}(x = 2, k = 3, p = .3)\)</span></p>
<p>or</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="ebs.html#cb262-1"></a><span class="kw">pbinom</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="fl">.3</span>)</span></code></pre></div>
<pre><code>## [1] 0.784</code></pre>
<p>On the PDF, we calculated the probability of combined events by summing.
With the PDF, we can calculate the probability for any range by subtracting the lower limit from the upper limit.
The probability of more than one tasks correct is:</p>
<p><span class="math inline">\(P(\text{correct} \ge 2) = \text{CDF}_{Binom}(x = 3, k = 3, p = .3) - \text{CDF}_{Binom}(x = 1, k = 3, p = .3)\)</span></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="ebs.html#cb264-1"></a><span class="kw">pbinom</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">.3</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pbinom</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="fl">.3</span>)</span></code></pre></div>
<pre><code>## [1] 0.216</code></pre>
<!-- *Note* that the lower limit must be included and strictly spoken, the second term in the difference is the *largest outcome value not included*. Owing to their extensionlessness this does not matter for continuous outcomes. -->
<p>With this method, we can also treat PDFs and obtain probabilities for intervals of values.
Practically, nobody is really interested in infinite precision, anyhow.
When asking <em>“what is the probability of IQ = 100?”</em>, the answer is <em>“zero”</em>, but what was really meant was: <em>“what is the probability of an IQ in a close interval around 100?”</em>.
Once we speak of intervals, we clearly have areas larger than zero.
The graph below shows the area in the range of 99 to 101.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="ebs.html#cb266-1"></a>D_IQ <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb266-2"><a href="ebs.html#cb266-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> IQ, <span class="dt">y =</span> density)) <span class="op">+</span></span>
<span id="cb266-3"><a href="ebs.html#cb266-3"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb266-4"><a href="ebs.html#cb266-4"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">y =</span> around_<span class="dv">100</span>))</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-100-1.png" width="90%" /></p>
<p>The size of the area is precisely the probability of such an event (IQ between 85 and 115).
But, how large is this area exactly?
As the distribution is curved, we can no longer simply stack virtual blocks.
It is the CDF giving the us probability mass up to a certain value, i.e. the area under the curve up to a point.
Continuous distributions have no PDFs CDFs, too, and the the graph below shows the CDF for the IQs.
We observe how the curve starts to rise from zero at around 50, has its steepest point at 100, just to slow down and run against 1.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="ebs.html#cb267-1"></a>D_IQ <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-2"><a href="ebs.html#cb267-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> IQ, <span class="dt">y =</span> cdf)) <span class="op">+</span></span>
<span id="cb267-3"><a href="ebs.html#cb267-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb267-4"><a href="ebs.html#cb267-4"></a><span class="st">  </span><span class="kw">geom_step</span>(<span class="dt">data =</span> <span class="kw">filter</span>(D_IQ, </span>
<span id="cb267-5"><a href="ebs.html#cb267-5"></a>                          IQ <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">85</span>, <span class="dv">115</span>, <span class="dv">200</span>)), </span>
<span id="cb267-6"><a href="ebs.html#cb267-6"></a>            <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb267-7"><a href="ebs.html#cb267-7"></a><span class="st">  </span><span class="kw">geom_label</span>(<span class="dt">data =</span> <span class="kw">filter</span>(D_IQ, </span>
<span id="cb267-8"><a href="ebs.html#cb267-8"></a>                           IQ <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">85</span>, <span class="dv">115</span>, <span class="dv">200</span>)), </span>
<span id="cb267-9"><a href="ebs.html#cb267-9"></a>             <span class="kw">aes</span>(<span class="dt">label =</span> label), </span>
<span id="cb267-10"><a href="ebs.html#cb267-10"></a>             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb267-11"><a href="ebs.html#cb267-11"></a>             <span class="dt">hjust =</span> <span class="st">&quot;left&quot;</span>) <span class="op">+</span></span>
<span id="cb267-12"><a href="ebs.html#cb267-12"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">250</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-101-1.png" width="90%" /></p>
<p>Underneath the smooth CDF, a discrete probability function reduces the continuum into three horizontal intervals, that have a certain total height associated, as well as a stepsize.
The height is the total probability up to this point, whereas stepsize is the probability for an IQ measure to fall within an interval.
No that the functionb is block-ified, we can assign probabilities to intervals of values, by simple subtractions on the CDF:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;CDF(IQ \geq 99) &amp;=&amp; 0.473\\
&amp;CDF(IQ \leq 101) &amp;=&amp; 0.527\\
&amp;CDF(99 \leq IQ \leq 101) &amp;=&amp; P(IQ \leq 101) - P(IQ \leq 99) \\
&amp;&amp;=&amp; 0.683
\end{aligned}
\]</span></p>
<p>To summarize, a probability density function (PDF) is a function that covers an area of exactly One.
A probability mass function (PDF) is a discrete density function, where the area is composed of discrete blocks.
A PDF has the special property to return plain probabilities at any given point.
With continuous measures this does not work.
By using the CDF, we can extract probabilities of intervals of values.</p>
<!-- Probability and density distributions usually take a few forms, that can be expressed as mathematical functions. For example, the function for the discrete case of task completion is the binomial probability distribution, which gives the probability for $y$ successes in $k$ trials when the success rate is $p$: -->
<!-- $$ -->
<!-- Pr(y|p,k) = {k  \choose y}p^y(1-p)^{k-y} -->
<!-- $$ -->
<!-- In most cases where a *binomial distribution* applies, base probability $p$ is the parameter of interest, whereas the number of  trials is known beforehand and therefore does not require estimation. For that reason, the binomial distribution is commonly taken as a one-parameter distribution. When discussing the binomial in more detail, we will learn that $p$ determines the location of the distribution, as well as how widely it is dispersed.  -->
<!-- The distribution that approximated the IQs is called the Gaussian distribution (or Normal distribution). The Gaussian distribution function takes two parameters, $mu$ determines the location of the distribution, say average IQ being 98, 100 or 102 and $sigma$ which gives the amount of dispersion as standard deviation (e.g. 15). -->
</div>
<div id="features-shape" class="section level4">
<h4><span class="header-section-number">3.5.2.2</span> Features of shape</h4>
<p>Density distributions can take a variety of shapes.
Most distributions are shaped as one hill, like the two distributions covered in the previous section.
This means that there is just one maximum point of density and is called a <em>unimodal</em> function.
Besides discreteness or continuity, as covered in the previous section, unimodal distributions can have several other features:</p>
<ol style="list-style-type: decimal">
<li>range of support</li>
<li>location on the x axis</li>
<li>dispersion</li>
<li>skew</li>
</ol>
<p>In this book I advocate the thoughtful choice of density distributions rather than doing batteries of goodness-of-fit to confirm that one of them, often the Gaussian, is an adequate approximation.
It usual is straight-forward to determine whether a measure is discrete (like everything that is counted) or (quasi)continuous and that is the most salient feature of distributions.
A second, nearly as obvious, feature of any measure is its range.
Practically all physical measures, such as duration, size or temperature have natural lower bounds, which typically results in scales of measurement which are non-negative.
Counts have a lower boundary, too (zero), but there can be a known upper bound, such as the number of trials.
<em>Range of support</em> will be an important feature when we approach Generalized Linear Models <a href="glm.html#glm">6</a> and is covered there in more detail.
For now, it suffices to say that all standard density distributions fall into one of three classes:</p>
<ol style="list-style-type: decimal">
<li><em>unbound</em> distributions range from minus to plus infinity and are suitable for measures that are practically unbound. One example is using the Gaussian distributions for IQ scores.</li>
<li>distributions <em>bound at zero</em> cover the range from Zero up to plus infinity. It is suitable for measures that have a natural lower boundary (of Zero) and no upper boundary for practical reasons. An example is the number of errors during the execution of a complex task.</li>
<li><em>double-bound</em> distributions have a lower and an upper limit. Typically the lower limit is Zero. And example is the distribution of task success that we saw in the previous section.</li>
</ol>
<p><em>Location</em> of a distribution is the most important feature for almost all statistical models covered later in this book.
When we say: “Time-on-task increases by 1.5 seconds per year of age”, this translates into a shift on the x-axis.
The mean of the ToT distribution is 90 for a 30-year old, 91.5 for a 31-year old and 120 for a 50 year old person.
When an experimenter asks for the difference of two designs in ToT, this is purely about location.
In the class of models covered in this book, location is always indicated by the arithmetic mean.
Still, it can theoretically also be represented by the median or the mode (in case of uni-modality).</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="ebs.html#cb268-1"></a><span class="kw">tibble</span>(<span class="dt">location =</span> <span class="kw">c</span>(<span class="dv">90</span>, <span class="fl">91.5</span>, <span class="dv">120</span>), <span class="dt">sd =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb268-2"><a href="ebs.html#cb268-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> location)) <span class="op">+</span></span>
<span id="cb268-3"><a href="ebs.html#cb268-3"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb268-4"><a href="ebs.html#cb268-4"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">90</span>, <span class="dt">sd =</span> <span class="dv">10</span>),</span>
<span id="cb268-5"><a href="ebs.html#cb268-5"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Gaus(mean=90, sd=10)&quot;</span>)) <span class="op">+</span></span>
<span id="cb268-6"><a href="ebs.html#cb268-6"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb268-7"><a href="ebs.html#cb268-7"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="fl">91.5</span>, <span class="dt">sd =</span> <span class="dv">10</span>), </span>
<span id="cb268-8"><a href="ebs.html#cb268-8"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Gaus(mean=91.5, sd=10)&quot;</span>)) <span class="op">+</span></span>
<span id="cb268-9"><a href="ebs.html#cb268-9"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb268-10"><a href="ebs.html#cb268-10"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">120</span>, <span class="dt">sd =</span> <span class="dv">10</span>), </span>
<span id="cb268-11"><a href="ebs.html#cb268-11"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Gaus(mean=120, sd=10)&quot;</span>)) <span class="op">+</span></span>
<span id="cb268-12"><a href="ebs.html#cb268-12"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">40</span>, <span class="dv">150</span>) <span class="op">+</span></span>
<span id="cb268-13"><a href="ebs.html#cb268-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour=</span><span class="st">&quot;Location shift of Gaussian distributions&quot;</span>, </span>
<span id="cb268-14"><a href="ebs.html#cb268-14"></a>       <span class="dt">x =</span> <span class="st">&quot;outcome&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-102-1.png" width="90%" /></p>
<p><em>Dispersion</em> represents the level of <em>variation</em> around the center of the distribution.
In Gaussian distributions, this is given by the standard deviation (or variance).
The most significant impact of dispersion is that spreading out a distribution reduces its overall density at any point.
In uni-modal distributions, we can think of the mode as the most typical value, the one you should place your bet on.
With more variance, the density at this point is reduced, and you should not bet to hard on it any more.
IQ measures usually have a mode at a value of 100, with a standard deviation of 15.
The density of a usual IQ distribution at an IQ of 100 is 0.027.
If IQs had a standard deviation of 30, the density at 100 would be reduced to 0.013.
If you were in game to guess an unfamiliar persons IQ, in both cases 100 would be the best guess, but you had a considerable higher chance of being right, when variance is low.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="ebs.html#cb269-1"></a><span class="kw">tibble</span>(<span class="dt">location =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb269-2"><a href="ebs.html#cb269-2"></a><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> location)) <span class="op">+</span></span>
<span id="cb269-3"><a href="ebs.html#cb269-3"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb269-4"><a href="ebs.html#cb269-4"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">15</span>), </span>
<span id="cb269-5"><a href="ebs.html#cb269-5"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Gaus(mean=100, sd=15)&quot;</span>)) <span class="op">+</span></span>
<span id="cb269-6"><a href="ebs.html#cb269-6"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb269-7"><a href="ebs.html#cb269-7"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">30</span>), </span>
<span id="cb269-8"><a href="ebs.html#cb269-8"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Gaus(mean=100, sd=30)&quot;</span>)) <span class="op">+</span></span>
<span id="cb269-9"><a href="ebs.html#cb269-9"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">200</span>) <span class="op">+</span></span>
<span id="cb269-10"><a href="ebs.html#cb269-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour=</span><span class="st">&quot;Dispersion of Gaussian distributions&quot;</span>, </span>
<span id="cb269-11"><a href="ebs.html#cb269-11"></a>       <span class="dt">x =</span> <span class="st">&quot;outcome&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-103-1.png" width="90%" /></p>
<!-- The perspective of uncertainty routinely occurs in the experimental comparison of conditions, e.g. design A compared to design B. What causes experimenters worry is when the *residual distributions* in their models is widely spread, which means that measures compose into a small structural part and a large random part. The source of this variation is unknown and usually called *measurement error*.  -->
<p>Large location shifts (between experimental conditions) are usually a delight for researchers, as most often research questions are about location changes.
In contrast, large dispersion is often associated with uncertainty (or imperfect measures).
In Gaussian models this uncertainty or error is directly represented as the standard deviation of residuals, also called the <em>standard error</em>.
We will re-encounter this idea when turning to model criticism <a href="wwm.html#model-criticism">7.1</a>.</p>
<p>Dispersion also plays a role as a measure for <em>variation within a population</em>, such as the differences in IQ.
This is most prominent in psychometrioc situations, where we want to discern between individuals.
A psychometric tool, such as the IQ test, must produce dispersion, otherwise it would not discern between individuals We will re-encounter this idea when turning to multi-level models <a href="mlm.html#mlm">5</a>.</p>
<p>Most distributions routinely used in statistics have one or two parameters.
Generally, if there is one parameter this determines both, location and dispersion, with Poisson distributions being one example.
Two-parameter distributions can vary location and dispersion, to some extent.
However, for most distributions, both parameters are tied to location and dispersion, simultaneously, and in sometimes convoluted ways.
The Gaussian distribution is a special case as parameter <span class="math inline">\(\mu\)</span> purely does location, whereas <span class="math inline">\(\sigma\)</span> is just dispersion.</p>
<p>As was said above, most statistical models use the mean of a distribution to render differences between situations.
The mean is but one measure of central tendency, with the median and the model being alternatives.
If a distribution is symmetric, such as Gaussian distributions, these three parameters are the same.
The mean divides the distribution into two areas of same size, and it is the point of highest density.
The Gaussian distribution owes its symmetry to the fact, that it has the same range of support in both directions, looking from the mean of the distribution.
That is different for zero-bound distributions, which run to plus infinity to the right, but hit a hard limit to the left.
These distributions are asymmetric, which typically means that the left side runs steeper than the right side.
Such distributions are called to be left-skewed.
An example is the Poisson distribution, which will be covered in more detail below.
Double-bound distributions, such as Binomial distributions, can also be right skewed, when the mean of the distribution is approaching the right boundary.
When moving the mean from left to right, the distribution starts left-skewed, takes a symmetric form in the center of the range and then continues with increasing right skew.
The following illustration shows that for the Beta distribution, which has range of support between (not including) Zero and One.
At the same time, this illustration conveys another important relationship between features of shape: a distribution that approaches a boundary also is less dispersed.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="ebs.html#cb270-1"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(<span class="dt">location =</span> <span class="kw">c</span>(.<span class="dv">25</span>, <span class="fl">.5</span>, <span class="fl">.75</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> location)) <span class="op">+</span></span>
<span id="cb270-2"><a href="ebs.html#cb270-2"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, </span>
<span id="cb270-3"><a href="ebs.html#cb270-3"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">8</span>),</span>
<span id="cb270-4"><a href="ebs.html#cb270-4"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Beta(mean = .25)&quot;</span>)) <span class="op">+</span></span>
<span id="cb270-5"><a href="ebs.html#cb270-5"></a><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, </span>
<span id="cb270-6"><a href="ebs.html#cb270-6"></a>                 <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">5</span>, <span class="dt">shape2 =</span> <span class="dv">5</span>),</span>
<span id="cb270-7"><a href="ebs.html#cb270-7"></a>              <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Beta(mean = .5)&quot;</span>)) <span class="op">+</span></span>
<span id="cb270-8"><a href="ebs.html#cb270-8"></a><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, </span>
<span id="cb270-9"><a href="ebs.html#cb270-9"></a>                 <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">8</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>),</span>
<span id="cb270-10"><a href="ebs.html#cb270-10"></a>              <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Beta(mean = .75)&quot;</span>)) <span class="op">+</span></span>
<span id="cb270-11"><a href="ebs.html#cb270-11"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb270-12"><a href="ebs.html#cb270-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour=</span><span class="st">&quot;Location shift of Gaussian distributions&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;outcome&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-104-1.png" width="90%" /></p>
<p>A frequent problem in statistical modelling is to choose a symmetric distribution, in particular the Gaussian, when the distribution is highly skewed.
This will be treated in more depth in chapter <a href="glm.html#glm">6</a>.</p>
<p>Many dozens distribution functions are known in statistical science and are candidates to choose from.
In first orientation, our choice can ground on obvious characteristics of measures, such as discrete/continuous or range, but that is sometimes not sufficient.
For example, the pattern of randomness in three-tasks falls into a binomial distribution only, when all trials have the same chance of success.
If the tasks are very similar in content and structure, learning is likely to happen and the chance of success differs between trials.
Using the binomial distribution when chances are not constant leads to mistaken statistical models.</p>
<p>For most distributions, strict mathematical descriptions exist for under which circumstances randomness takes this particular shape.
Frequently, there is one or more natural phenomena that accurately fall into this pattern, such as the number of radioactive isotope cores decaying in a certain interval (Poisson distributed) or the travel of a particle under Brownian motion (Gaussian).
This is particularly the case for the canonical four random distributions that follow: Poisson, Binomial, Exponential and Gaussian.
My goal here is not to bother anyone with formalism, but to introduce my readers to think about distributions as arising from data generating processes.</p>
<!--
However, 


Imagine, standing slightly elevated in front of a moving crowd and choose one pedestrian to follow with your eyes. The task is easier when the target person is tall, moves straight on while the rest of the crowd is moving in random curly patterns. This method also works to identify the waiter in a crowded bar. 


The theorists answer is twofold: first, they are exponential .... second, they are lowest entropy.




Random distributions: 

+ discrete or continuous
+ probability and density
+ range of support
+ parameters
+ location and dispersion
+ data generating process
-->
</div>
<div id="binomial-dist" class="section level4">
<h4><span class="header-section-number">3.5.2.3</span> Binomial distributions</h4>
<p>A very basic performance variable in design research is task success.
Think of devices in high risk situations such as medical infusion pumps in surgery.
These devices are remarkably simple, giving a medication at a certain rate into the bloodstream for a given time.
Yet, they are operated by humans under high pressure and must therefore be extremely error proof in handling.
Imagine, the European government would set up a law that manufacturers of medical infusion pump must prove a 90% error-free operation in routine tasks.
A possible validation study could be as follows: a sample of <span class="math inline">\(N = 30\)</span> experienced nurses are invited to a testing lab and asked to complete ten standard tasks with the device.
The number of error-free task completions per nurse is the recorded performance variable to validate the 90% claim.
Under somewhat idealized conditions, namely that all nurses have the same proficiency with the device and all tasks have the success chance of 90%, the outcome follows a <em>Binomial distribution</em> and the results could look like the following:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="ebs.html#cb271-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb271-2"><a href="ebs.html#cb271-2"></a></span>
<span id="cb271-3"><a href="ebs.html#cb271-3"></a><span class="kw">tibble</span>(<span class="dt">succs =</span> <span class="kw">rbinom</span>(<span class="dv">30</span>, <span class="dv">10</span>, <span class="fl">.9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-4"><a href="ebs.html#cb271-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> succs)) <span class="op">+</span></span>
<span id="cb271-5"><a href="ebs.html#cb271-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb271-6"><a href="ebs.html#cb271-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">11</span>))</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-105-1.png" width="90%" /></p>
<p>Speaking about the Binomial distribution in terms of <em>successes in a number of attempts</em> is common.
As a matter of fact, <em>any</em> binary classification of outcomes is amenable for Binomial modeling, like on/off, red/blue, male/female.</p>
<p>An example in web design research is the rate of visitor return, resulting in a variable, that has two possible outcomes: : <span class="math inline">\(0\)</span> for one-timers and <span class="math inline">\(1\)</span> for returners.
This is in fact, a special case of the Binomial distribution with <span class="math inline">\(k = 1\)</span> attempts (the first visit is not counted) and is also called <em>Bernoulli distribution</em>.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="ebs.html#cb272-1"></a>mascutils<span class="op">::</span><span class="kw">expand_grid</span>(<span class="dt">k =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">20</span>), </span>
<span id="cb272-2"><a href="ebs.html#cb272-2"></a>                       <span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>), </span>
<span id="cb272-3"><a href="ebs.html#cb272-3"></a>                       <span class="dt">succs =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span></span>
<span id="cb272-4"><a href="ebs.html#cb272-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">probability =</span> <span class="kw">dbinom</span>(succs, k, p)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb272-5"><a href="ebs.html#cb272-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> succs, <span class="dt">y =</span> probability)) <span class="op">+</span></span>
<span id="cb272-6"><a href="ebs.html#cb272-6"></a><span class="st">  </span><span class="kw">geom_step</span>() <span class="op">+</span></span>
<span id="cb272-7"><a href="ebs.html#cb272-7"></a><span class="st">  </span><span class="kw">facet_grid</span>(k <span class="op">~</span><span class="st"> </span>p) <span class="op">+</span></span>
<span id="cb272-8"><a href="ebs.html#cb272-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;number of successes&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-106-1.png" width="90%" /></p>
<p>Binomial distributions have two parameters: <span class="math inline">\(p\)</span> is the chance of success and <span class="math inline">\(k\)</span> is the number of attempts.
<span class="math inline">\(p\)</span> is a probability and therefore can take values in the range from zero to one.
Probability of success determines the location of a distribution in that With larger <span class="math inline">\(p\)</span> the distribution moves to the right.
The mean of Binomial distributions is the probability scaled by number of attempts, <span class="math inline">\(\textrm{Mean} = kp\)</span>.
Logically, there cannot be more successes then <span class="math inline">\(k\)</span>, but with larger <span class="math inline">\(k\)</span> the distribution gets wider, where the variance is the odds scaled by number of attempts, <span class="math inline">\(\textrm{Var} = kp(1-p)\)</span>.
As mean and variance depend on the exact same parameters, they cannot be set independently.
In fact, the relation is parabolic, so that variance is largest at <span class="math inline">\(p = .5\)</span>, but decreases towards both boundaries.
A Binomial distribution with, say <span class="math inline">\(k=10\)</span> and <span class="math inline">\(p = .4\)</span> always has mean <span class="math inline">\(4\)</span> and variance <span class="math inline">\(2.4\)</span>.
This means, in turn, that an outcome with a mean of <span class="math inline">\(4\)</span> and a variance of <span class="math inline">\(3\)</span> is not Binomially distributed.
This occurs frequently, when the success rate is not identical across trials.
A common solution is to use plugin distributions, where the parameter <span class="math inline">\(p\)</span> itself is distributed, rather than fixed.
A common distribution for <span class="math inline">\(p\)</span> is the <em>beta</em> distribution and the <em>logit-normal</em> distribution is an alternative.</p>
<p>The Binomial distribution has two boundaries, zero below and number of attempts <span class="math inline">\(k\)</span> above.
Hence, Binomial distributions also require that there is a clearly defined numner of attempts.
For example, the number of times a customer returns to the a website does not have a natural interpretation of number of attempts, because attempts can happen at any moment.
Literally, every single moment is an opportunity to go online and hire a car, even many times a day, if you are a holiday planner.
At the same time, for a typical customer the per-day chance to hire a car is miniscule.
Under these conditions, we get an infinite number of attempts, or painstakingly large, at least, say <span class="math inline">\(k = 365\)</span> days.
At the same time the rate is very small, e.g. <span class="math inline">\(p = 1.5/365\)</span>.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="ebs.html#cb273-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb273-2"><a href="ebs.html#cb273-2"></a><span class="kw">tibble</span>(<span class="dt">rentals_per_year =</span> <span class="kw">rbinom</span>(<span class="dv">1000</span>, </span>
<span id="cb273-3"><a href="ebs.html#cb273-3"></a>                                 <span class="dt">size =</span> <span class="dv">365</span>, </span>
<span id="cb273-4"><a href="ebs.html#cb273-4"></a>                                 <span class="dt">prob =</span> <span class="fl">1.5</span><span class="op">/</span><span class="dv">365</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb273-5"><a href="ebs.html#cb273-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> rentals_per_year)) <span class="op">+</span></span>
<span id="cb273-6"><a href="ebs.html#cb273-6"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-107-1.png" width="90%" /></p>
<p>This is a workable solution to display the number of events per period, but it remains a little odd, because the question really is about events per timespan, not success per attempt.
When events per timespan is the question, the process is better covered by <em>Poisson distributions</em>.</p>
<p>the variable is more neatly summarized by <em>Poisson distributions</em>.</p>
</div>
<div id="poisson-dist" class="section level4">
<h4><span class="header-section-number">3.5.2.4</span> Poisson distributions</h4>
<p>Poisson distributions can mathematically be derived from Binomial distributions with very small probability of success with infinite attempts.
This implies that Poisson distributions have no upper limit.
In design research, a number of measures have no clearly defined upper limit:</p>
<ul>
<li>number of erroneous actions</li>
<li>frequency of returns</li>
<li>behavioral events, e.g. showing exploratory behavior</li>
<li>physiological events, such as number of peaks in galvanic skin response</li>
</ul>
<p>These measures can often be modeled as <em>Poisson distributed</em>.
A useful way to think of unbound counts, is that they can happen at every moment, but with a very small chance.
Think of a longer interaction sequence of a user with a system, where errors are recorded.
It can be conceived as an almost infinite number of opportunities to err, with a very small chance of something to happen.</p>
<p>Poisson distributions possess only one parameter <span class="math inline">\(\lambda\)</span> (lambda), that is strictly positive and determines mean and variance of the distribution alike: <span class="math inline">\(\lambda = \textrm{Mean} = \textrm{Var}\)</span>.
As a result, distributions farther from Zero are alwwayas more dispersed.
Because Poisson distributions have a lower boundary, they are <em>asymmetric</em>, with the left tail always being steeper.
Higher <span class="math inline">\(\lambda\)</span>s push the distribution away from the boundary and the skew diminishes.
Poisson distributions with a large mean can therefore be approximated by Gaussian distributions:</p>
<p><span class="math display">\[
Y \sim 
\textrm{Pois}(\lambda) \Rightarrow 
Y \mathrel{\dot\sim} \textrm{Gaus}(\mu = \lambda, \sigma = \sqrt \lambda) 
\]</span></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="ebs.html#cb274-1"></a>mascutils<span class="op">::</span><span class="kw">expand_grid</span>(<span class="dt">lambda =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>),</span>
<span id="cb274-2"><a href="ebs.html#cb274-2"></a>                       <span class="dt">count =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span></span>
<span id="cb274-3"><a href="ebs.html#cb274-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">probability =</span> <span class="kw">dpois</span>(count, lambda)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb274-4"><a href="ebs.html#cb274-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> count, <span class="dt">y =</span> probability)) <span class="op">+</span></span>
<span id="cb274-5"><a href="ebs.html#cb274-5"></a><span class="st">  </span><span class="kw">geom_step</span>() <span class="op">+</span></span>
<span id="cb274-6"><a href="ebs.html#cb274-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(lambda<span class="op">~</span>.)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-108-1.png" width="90%" /></p>
<p>For an illustration, consider a video game, <em>subway smurfer</em>, where the player jumps and runs a little blue avatar on the roof of a train and catches items passing by.
Many items have been placed into the game, but catching a single one is very difficult.
The developers are aware that a too low success rate would demotivate players as much as when the game is made to easy.
In this experiment, only one player is recorded, and in wonderful ways this player never suffers from fatigue, or is getting better with training.
The player plays a 100 times and records the catches after every run.
In this idealized situation, the distribution of catches would, approximately, follow a Poisson distribution.</p>
<p>Because mean and variance are tightly linked, only a certain amount of randomness can be contained at a location.
If there is more randomness, and that is almost certainly so in real data, Poisson distributions are not appropriate.
One speaks of <em>over-dispersion</em> in such a case.
For understanding over-dispersion, consider a variation of the experiment with 1000 players doing one game and less restrictive rules.
Players come differently equipped to perform visual search tasks and coordinate actions at high speeds. The chance of catching varies between players, which violates the assumption of Poisson distribution, which it borrows from the Binomial family, a constant chance of success. The following data simulation shows what happens to a count distribution when individuals vary in <span class="math inline">\(\lambda\)</span>. While the overall mean stays the same, variation in measures increases.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="ebs.html#cb275-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb275-2"><a href="ebs.html#cb275-2"></a>N_obs =<span class="st"> </span><span class="dv">200</span></span>
<span id="cb275-3"><a href="ebs.html#cb275-3"></a></span>
<span id="cb275-4"><a href="ebs.html#cb275-4"></a>D_single &lt;-<span class="st"> </span></span>
<span id="cb275-5"><a href="ebs.html#cb275-5"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">Part =</span> <span class="dv">1</span>,</span>
<span id="cb275-6"><a href="ebs.html#cb275-6"></a>         <span class="dt">lambda =</span> <span class="dv">20</span>,</span>
<span id="cb275-7"><a href="ebs.html#cb275-7"></a>         <span class="dt">catches =</span> <span class="kw">rpois</span>(N_obs, lambda))</span>
<span id="cb275-8"><a href="ebs.html#cb275-8"></a></span>
<span id="cb275-9"><a href="ebs.html#cb275-9"></a></span>
<span id="cb275-10"><a href="ebs.html#cb275-10"></a>D_multi &lt;-</span>
<span id="cb275-11"><a href="ebs.html#cb275-11"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">Part =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>N_obs) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb275-12"><a href="ebs.html#cb275-12"></a>         <span class="dt">part_variation =</span> <span class="kw">log</span>(<span class="kw">rnorm</span>(N_obs, <span class="dv">0</span>, <span class="dv">5</span>)),</span>
<span id="cb275-13"><a href="ebs.html#cb275-13"></a>         <span class="dt">lambda =</span> <span class="dv">20</span>,</span>
<span id="cb275-14"><a href="ebs.html#cb275-14"></a>         <span class="dt">catches =</span> <span class="kw">rpois</span>(N_obs, lambda <span class="op">*</span><span class="st"> </span>part_variation))</span>
<span id="cb275-15"><a href="ebs.html#cb275-15"></a></span>
<span id="cb275-16"><a href="ebs.html#cb275-16"></a><span class="kw">grid.arrange</span>(<span class="kw">qplot</span>(D_single<span class="op">$</span>catches, </span>
<span id="cb275-17"><a href="ebs.html#cb275-17"></a>                   <span class="dt">xlab =</span> <span class="st">&quot;Catches of single participant, constant lambda&quot;</span>,</span>
<span id="cb275-18"><a href="ebs.html#cb275-18"></a>                   <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)),</span>
<span id="cb275-19"><a href="ebs.html#cb275-19"></a>             <span class="kw">qplot</span>(D_multi<span class="op">$</span>catches, </span>
<span id="cb275-20"><a href="ebs.html#cb275-20"></a>                   <span class="dt">xlab =</span> <span class="st">&quot;Catches of multiple participants, varying lambda&quot;</span>,</span>
<span id="cb275-21"><a href="ebs.html#cb275-21"></a>                   <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)))</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-109-1.png" width="90%" /></p>
<p>Another area for trouble can be Poisson distributions’ lower boundary of exactly Zero.
Often this works well, a person can perform a sequence with no errors, catch zero items or have no friends on social media.
But, you cannot complete an interaction sequence in zero steps, have a conversation with less than two statements or be a customer with zero customer contacts.
If the lower bound is obvious, such as the minimum necessary steps to complete a task.
In such a case, a count that starts at zero can be created easily:</p>
<p><span class="math display">\[
\textrm{additional steps} = \textrm{steps} - \textrm{neccessary steps}
\]</span></p>
<p>Another frequent problem at the lower bound bound is zero-inflation.
In traffic research, the frequency of going by bus can be an interesting variable to measure acceptance of public transport.
If we would make such a survey, e.g. “How many times have you taken the bus the last seven days?”, it is not unlikely, that we get a distribution like the following:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="ebs.html#cb276-1"></a><span class="kw">tibble</span>(<span class="dt">uses_public_transport =</span> <span class="kw">rbernoulli</span>(<span class="dv">1000</span>, <span class="fl">.8</span>),</span>
<span id="cb276-2"><a href="ebs.html#cb276-2"></a>       <span class="dt">bus_rides =</span> <span class="kw">rpois</span>(<span class="dv">1000</span>, uses_public_transport <span class="op">*</span><span class="st"> </span><span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb276-3"><a href="ebs.html#cb276-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> bus_rides)) <span class="op">+</span></span>
<span id="cb276-4"><a href="ebs.html#cb276-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-110-1.png" width="90%" /></p>
<p>In this scenario, the population is not homogenous, but falls into two classes, those who use public transport and those who just never do.
The result is a <em>zero-inflated</em> distribution.
A way to deal with this are hurdle models, which are called as such, because you first have to jump over the hurdle to use public transport, before you are in the game.</p>
</div>
<div id="exponential-dist" class="section level4">
<h4><span class="header-section-number">3.5.2.5</span> Exponential distribution</h4>
<p>Exponential distributions apply for measures of duration.
Exponential distributions have the same generating process as Poisson distributions, except, that the <em>duration between events to happen</em> is the variable of interest, rather than number of events in a given time.
Under the idealized conditions of a Subway Smurfer player with constant ability to catch items, the duration between any two catches is exponentially distributed.</p>
<p>Just like Poisson distributions, Exponential distributions have one parameter, called rate and frequently written as <span class="math inline">\(\lambda\)</span>.
The following figure illustrates Exponential distributions with varying rates.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="ebs.html#cb277-1"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb277-2"><a href="ebs.html#cb277-2"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, </span>
<span id="cb277-3"><a href="ebs.html#cb277-3"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>), </span>
<span id="cb277-4"><a href="ebs.html#cb277-4"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Exp(1/2)&quot;</span>)) <span class="op">+</span></span>
<span id="cb277-5"><a href="ebs.html#cb277-5"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, </span>
<span id="cb277-6"><a href="ebs.html#cb277-6"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>), </span>
<span id="cb277-7"><a href="ebs.html#cb277-7"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Exp(1/4)&quot;</span>)) <span class="op">+</span></span>
<span id="cb277-8"><a href="ebs.html#cb277-8"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, </span>
<span id="cb277-9"><a href="ebs.html#cb277-9"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>), </span>
<span id="cb277-10"><a href="ebs.html#cb277-10"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Exp(1/8)&quot;</span>)) <span class="op">+</span></span>
<span id="cb277-11"><a href="ebs.html#cb277-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour=</span><span class="st">&quot;Exponential distributions&quot;</span>, </span>
<span id="cb277-12"><a href="ebs.html#cb277-12"></a>       <span class="dt">x =</span> <span class="st">&quot;outcome&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-111-1.png" width="90%" /></p>
<p>Durations are common measures in design research, most importantly, time-on-task and reaction time.
Unfortunately, the exponential distribution is a poor approximation of the random pattern found in duration measures.
That is for three reasons: first, Exponential distributions have just one parameter, which means that mean and variance are tightly linked as <span class="math inline">\(\textrm{Mean} = 1/\lambda\)</span> and <span class="math inline">\(\textrm{Var} = 1/\lambda^2\)</span>.
Like with Poisson distributions, this it does not allow extra variance, e.g. between participants.
Second, the distribution always starts at zero, whereas human reactions always require some basic processing, and be this just the velocity of signals travelling nerve cells, which is far below speed of sound (in air).
And third, the exponential process has one special property, which is called <em>memoryless-ness</em>.
That basically means, that the probability for an event to happen is completely independent of how long one has been waiting for it.
In basic physical systems, like nucleus decay, this is the truly the case.
But, if a person works on a task, the chance of task completion usually increases when time progresses.</p>
<p>The one thing that exponential distribtions are getting right about durations (in contrast to the frequently employed Gaussian distribution), is the asymmetry.
Durations have a lower boundary and that will always produce some skew.
For the stated reasons, pure exponential distributions themselves are rarely used in statistical modelling, but two- and three parameter distributions, like Gamma or Exponential-Gaussian are extensions of Exponential distributions.
Gamma distributions provide a scale parameter for incorporating extra variance, whereas Exponential-Gauss distributions can be used, when the lower boundary is not Zero, but positive <a href="glm.html#duration-measures">6.3</a>.</p>
</div>
<div id="gauss-dist" class="section level4">
<h4><span class="header-section-number">3.5.2.6</span> Gaussian distributions</h4>
<p>The best known distributions are <em>Gaussian distributions</em> or <em>Normal distributions</em>.
These distributions arise mathematically under the assumption of a myriad of small unmeasured forces (SMURF) pushing performance (or any other outcome) up or down.
As SMURFs work in all directions independently, their effects often average out and the majority of observations stays clumped together in the center, more or less.
The physical process associated with Gaussian distribution is Brownian motion, the movement of a small particles caused by bumping into molecules of a warm fluid.
Imagine, you are standing blind-folded in the middle of a tunnel, which is frequented by blind-folded passengers moving uncoordinated in both directions of the tunnel.
Passengers will randomly bump into you from both directions, and this pushes you sometimes forward, sometimes backwards.
The total travel caused by many of these small pushes is approximately Gaussian distributed.
By tendency, the small pushes cancel each other out, such that the most likely position after, say 100 bumps will be close to where you started (Zero).
When this experiment is repeated very often, a Gaussian distribution arises:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="ebs.html#cb278-1"></a><span class="kw">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb278-2"><a href="ebs.html#cb278-2"></a>rtravel &lt;-<span class="st"> </span><span class="cf">function</span>(n, <span class="dt">bumps =</span> <span class="dv">100</span>) </span>
<span id="cb278-3"><a href="ebs.html#cb278-3"></a>  <span class="kw">map_int</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(x) <span class="kw">as.integer</span>(<span class="kw">sum</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), x, <span class="dt">replace =</span> T))))</span>
<span id="cb278-4"><a href="ebs.html#cb278-4"></a></span>
<span id="cb278-5"><a href="ebs.html#cb278-5"></a>D_Tunnel &lt;-<span class="st"> </span></span>
<span id="cb278-6"><a href="ebs.html#cb278-6"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">Part =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, </span>
<span id="cb278-7"><a href="ebs.html#cb278-7"></a>         <span class="dt">travel =</span> <span class="kw">rtravel</span>(<span class="dt">n =</span> <span class="dv">1000</span>))</span>
<span id="cb278-8"><a href="ebs.html#cb278-8"></a></span>
<span id="cb278-9"><a href="ebs.html#cb278-9"></a>D_Tunnel <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb278-10"><a href="ebs.html#cb278-10"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x  =</span> travel)) <span class="op">+</span></span>
<span id="cb278-11"><a href="ebs.html#cb278-11"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">stat =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-113-1.png" width="90%" /></p>
<p>Gaussian distributions take two parameters: <span class="math inline">\(\mu\)</span> marks the location of the mean of the distribution.
Because distributions are symmetric, the mean coincides with median and mode of the distribution.
The second parameter <span class="math inline">\(\sigma\)</span> represents the dispersion of the random pattern.
When randomness is pronounced, the center of the distribution gets less mass assigned, as the tails get thicker.
Different to Poisson and Binomial distributions, mean and variance of the distribution can be set independently and therefore over-dispersion is never an issue.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="ebs.html#cb279-1"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb279-2"><a href="ebs.html#cb279-2"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb279-3"><a href="ebs.html#cb279-3"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>), </span>
<span id="cb279-4"><a href="ebs.html#cb279-4"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Gaus( 0, 1)&quot;</span>)) <span class="op">+</span></span>
<span id="cb279-5"><a href="ebs.html#cb279-5"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb279-6"><a href="ebs.html#cb279-6"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="fl">-1.5</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>), </span>
<span id="cb279-7"><a href="ebs.html#cb279-7"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Normal(-1.5, 0.5)&quot;</span>)) <span class="op">+</span></span>
<span id="cb279-8"><a href="ebs.html#cb279-8"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb279-9"><a href="ebs.html#cb279-9"></a>               <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="fl">0.5</span>, <span class="dt">sd =</span> <span class="dv">2</span>), </span>
<span id="cb279-10"><a href="ebs.html#cb279-10"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Normal(0.5,1.5)&quot;</span>)) <span class="op">+</span></span>
<span id="cb279-11"><a href="ebs.html#cb279-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour=</span><span class="st">&quot;Gaussian distributions&quot;</span>, </span>
<span id="cb279-12"><a href="ebs.html#cb279-12"></a>       <span class="dt">x =</span> <span class="st">&quot;outcome&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-114-1.png" width="90%" /></p>
<p>As illustrated by the Tunnel example, Gaussian distributions have the most compelling interpretation of summarizing the effect of SMURFs.
Therefore, they are useful to capture randomness in a broad class of regression models and other statistical approaches.</p>
<!-- The problem with Gaussian distributions is that they only capture the pattern of randomness under two assumption. The first assumption is that the outcome is practically continuous. That holds for duration as a measure of performance, but not for counting the errors a user makes. The second assumption is that the SMURFs are truly additive, like the forces add up, when two pool balls collide. This appears subtle at first, but it has the far reaching consequence that the outcome variable must have an infinite range in both directions, which is impossible.  -->
<p>The Gaussian distribution is called “normal”, because people normally use it.
For many decades it was the standard distribution to tackle almost every statistical problem.
That is so, because statistical models with Gaussian shape of randomness can be computed very efficiently.
Indeed, Gaussian distributions are often good approximations, which goes back to the <em>central limit theorem</em>.
Basically, this theorem proves what we have passingly observed at binomial and Poisson distributions: the more they move to the right, the more symmetric they get.
The central limit theorem proves that, in the long run, a wide range of distributions are indistinguishable from the Gaussian distribution.
But, the key word is <em>in the long run</em>.
As a general rule, Gaussian distributions approximates other distributions well, when the majority of measures stay far from the natural boundaries.
That is the case in experiments with very many attempts and moderate chances (e.g. signal detection experiments), when counts are in the high numbers (number of clicks in a complex task) or with long durations and little variance in duration.
However, in the remainder of this book, especially in chapter <a href="glm.html#glm">6</a>, we will encounter numerous real data sets where the Gaussian distribution is not a good approximation.
Gaussian models may be convenient to set up and interpret, but strictly speaking, a Gaussian model is always wrong.
And that is for one particular reason: Gaussian distributions are unbound, but there is not a single measure in any scientific discipline that really has no limits.</p>
<p>these rules are no guarantee and careful model criticism is essential.
We will return to this issue in <a href="wwm.html#model-criticism">7.1</a></p>
<!-- Measurement is prime and specialized (non-central-limit) distributions remain the first recommendation for capturing measurement errors. The true salvation of normal distributions is their application in *multi-level models*. While last century statistics was reigned by questions of location, and variance considered nuisance, new statistics  care for variation. Most notably, amount of variation in a population is added as a central idea in multi-level modeling, which is commonly referred to as *random effects*. These models can become highly complex and convenience is needed more than ever. Normal distributions tie things together in multi-level models, as they keep location and dispersion apart, tidy. -->
<p>Nowadays, computing power has evolved to a point, where efficient approximations are less needed.
Especially with the advent of Bayesian modelling, statistical users have a plethory of distributions to choose from, and we will see more of them when Generalized Linear Models are introduced <a href="glm.html#glm">6</a>.
Most of the time, choosing an appropriate shape for randomness is straight-forward, and doing so makes a model less prone to criticism <a href="wwm.html#model-criticism">7.1</a>.</p>
</div>
</div>
</div>
<div id="bayes-estimation" class="section level2">
<h2><span class="header-section-number">3.6</span> Towards Bayesian estimation</h2>
<p>Frequentist statistics falls short on recognizing that research is incremental.
Bayesian statistics embraces the idea of gradual increase in certainty when new data arrives.
Why has Bayesian statistics not been broadly adopted earlier?
The reason is that Bayesian estimation was computationally unfeasible for many decades.
In practice, the innocent multiplication of prior probability and likelihood of Bayes’ becomes a multiplication of two density distributions, which results in complex integrals, which in most cases have no analytic solution.
If you have enjoyed a classic statistics education, you may recall how the computation of an ANOVA could be carried out on paper and pencil in reasonable time (e.g. during an exam).
And that is precisely how statistical computations have been performed before the advent of electronic computing machinery.
In the frequentist statistical framework, ingenious mathematicians have developed procedures that were rather efficient to compute.
That made statistical data analysis possible in those times.</p>
<p>Expensive computation is in the past. Modern computers can simulate realistic worlds in real time and the complex integrals in Bayesian statistics they solve hands down.
When analytic solutions do not exist, the integrals can still be solved using numerical procedures.
Numerical procedures have been used in frequentist statistics, too, for example the iterative least squares algorithm applies for Generalized Linear Models, Newton-Rapson optimizer can be used to find the maximum likelihood estimate and boot-strapping produces accurate confidence limits.
However, these procedures are too limited as they fail for highly multidimensional problems as they are common in advanced regression models.</p>
<p>Today, more and more researchers leave frequentist statistics alone and enter the world of Bayesian Statistics.
Partly, this may be due to the replicability crisis of 2015, which has shown that, in general, behavioural researchers are not capabable of carrying out frequentist statistics, correctly.
In result, the incorrect use of null hypothesis testing and p-values has fully under-mined the discipline of Psychology and that may just be the tip of the iceberg.</p>
<p>I assume that the majority of researchers, who started using Bayesian Statistics, are just thrilled by the versatility of Bayesian estimation, and its natural interpretation.
To name just one example for the latter, Frequentist statisticians emphasize the randomness of sampling.
It all goes by asking: how would an estimate change, when we draw another sample?
This is best seen by the definition of the frequentist <em>confidence interval</em>: “the confidence level represents the frequency (i.e. the proportion) of possible confidence intervals that contain the true value of the unknown population parameter.” Interestingly, when asked about the definition, most researchers answer: “the range, in which the true value falls with a certainty of 95%.” Ironically, this is precisely the definition of the Bayesian <em>credibility interval</em>.
It seems that thinking of certainty by itself, not through frequencies, is more natural than a long series of imagined replications of the same experiment.</p>
<p>The other reason for Bayesian Statistics gaining ground is that today’s implementations offer endless possibilities.
In frequentist statistics, you would find an implementation for, say, linear models with a Beta shape of randomness <a href="glm.html#beta-reg">6.4.2</a>.
But, if your research design is multi-level, say for psychometric evaluation, you would be less lucky.
You would find plenty implementations for psychometrics, but none supports Beta distribution.
With Bayesian implementations, that is the past.
In chapter <a href="mlm.html#psychometrics">5.8</a> I will show how multi-level models can replace classic tools for psychometric data, and in section <a href="glm.html#beta-reg">6.4.2</a> we use Beta distribution on that model and I will explain why this is the better choice.
The greatest advantage is that all these possibilities are governed by just one implementation, the Brms engine, which even allows us to add custom distributions, like Beta-binomial distribution <a href="glm.html#betabin-reg">6.2.3.2</a>.
The most astonishing fact is accomplished by a relatively simple algorithm, called Markov-Chain Monte Carlo sampling.</p>
<p>Most Bayesian estimation engines these days ground on a numerical procedure called <em>Markov-Chain Monte-Carlo (MCMC)</em> sampling, which we will closer examine in chapter <a href="lm.html#random-walk">4.1.1</a>.
This method differs from the earlier mentioned in that it grounds on random walk.
The closest frequentist counterpart to MCMC is the bootstrapping algorithm, which draws many samples from data (how could it be different) and computes the estimates many times.
Bayesian estimation with MCMC turns this upside down, by randomly drawing possible parameter values and computing the posterior probability many times.
Similar to boot strapping, the basic MCMC algorithm is so simple, it can be explained on half a page and implemented with 25 lines of code.
Despite its simplicity, the MCMC algorithm is applicable to practically all statistical problems one can imagine.
Being so simple and generic at the same time must come at some costs.
The downside of MCMC sampling still is computing time.
Models with little data and few variables, like the examples in <a href="ebs.html#decision-making">3.1</a>, are estimated within a few seconds.
Multi-level models, which we will encounter later in this book, can take hours and large psychometric models can take up to a few days of processing time.</p>
<p>The particular merit of the MCMC algorithm is that it not only delivers accurate point estimates in almost any situation, it produces the full <em>posterior probability distribution</em>.
This lets us characterize a parameters magnitude and degree of (un-)certainty.
Let’s run an analysis on the 20 rainfall observations to see how this happens.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="ebs.html#cb280-1"></a><span class="kw">attach</span>(Rainfall)</span></code></pre></div>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="ebs.html#cb281-1"></a>M_<span class="dv">1</span> &lt;-<span class="st"> </span></span>
<span id="cb281-2"><a href="ebs.html#cb281-2"></a><span class="st">  </span>Rain <span class="op">%&gt;%</span></span>
<span id="cb281-3"><a href="ebs.html#cb281-3"></a><span class="st">  </span><span class="kw">stan_glm</span>(rain <span class="op">~</span><span class="st"> </span>cloudy <span class="dv">-1</span>, </span>
<span id="cb281-4"><a href="ebs.html#cb281-4"></a>           <span class="dt">family =</span> binomial,</span>
<span id="cb281-5"><a href="ebs.html#cb281-5"></a>           <span class="dt">data =</span> .)</span></code></pre></div>
<p>What the estimation does, is to calculate the <em>posterior distribution</em> from the observations.
The <em>posterior distribution</em> contains the probability (more precisely: the <em>density</em>) for all possible values of the parameter in question.
The following density plot represents our belief about the parameter <span class="math inline">\(P(rain|cloudy)\)</span> after we have observed twenty days:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="ebs.html#cb282-1"></a><span class="kw">posterior</span>(M_<span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb282-2"><a href="ebs.html#cb282-2"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;fixef&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb282-3"><a href="ebs.html#cb282-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">chance_of_rain =</span> <span class="kw">plogis</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb282-4"><a href="ebs.html#cb282-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> chance_of_rain, </span>
<span id="cb282-5"><a href="ebs.html#cb282-5"></a>          <span class="dt">fill =</span> parameter, </span>
<span id="cb282-6"><a href="ebs.html#cb282-6"></a>           <span class="dt">col =</span> parameter)) <span class="op">+</span></span>
<span id="cb282-7"><a href="ebs.html#cb282-7"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>)</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/umbrella_post-1.png" width="90%" /></p>
<p>From the posterior distribution, we can deduct all kinds of summary statistics, such as:</p>
<ol style="list-style-type: decimal">
<li>the most likely value for a parameter in question is called the <em>posterior mode</em> and, when prior knowledge is absent, is the same as the frequentist <em>maximum likelihood estimate</em>.</li>
<li>the average of parameter values, weighted by their probability is called the <em>posterior mean</em></li>
<li>a defined range to express 95% (or any other level of) certainty is the <em>95% credibility interval</em></li>
</ol>
<p>We can also pull non-standard summary statistics from the posterior distribution.
For example, in <a href="lm.html#test-stat">4.6.1</a> we will ask how valid a third degree polynomial is for rendering the Uncanny Valley effect.</p>
<p>Coming back to MCMC random walk: how is the posterior distribution actually produced.
The MCMC makes a particular type of random walk through parameter space, where more likely regions are visited more often.
Basically, the posterior distribution is approximated by a frequency distribution of the visited values.
See the random walk in action in the following figure!
Note how the gray connecting lines show the jumps in the MCMC random walk and how the marginal frequency distributions emerge.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="ebs.html#cb283-1"></a>G_mcmc &lt;-</span>
<span id="cb283-2"><a href="ebs.html#cb283-2"></a><span class="st">  </span><span class="kw">posterior</span>(M_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb283-3"><a href="ebs.html#cb283-3"></a><span class="st">  </span><span class="kw">select</span>(iter, chain, fixef, value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb283-4"><a href="ebs.html#cb283-4"></a><span class="st">  </span><span class="kw">spread</span>(fixef, value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb283-5"><a href="ebs.html#cb283-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> cloudyFALSE, <span class="dt">y =</span> cloudyTRUE)) <span class="op">+</span></span>
<span id="cb283-6"><a href="ebs.html#cb283-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb283-7"><a href="ebs.html#cb283-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">.3</span>)</span>
<span id="cb283-8"><a href="ebs.html#cb283-8"></a></span>
<span id="cb283-9"><a href="ebs.html#cb283-9"></a><span class="kw">plot</span>(ggExtra<span class="op">::</span><span class="kw">ggMarginal</span>(G_mcmc, <span class="dt">type =</span> <span class="st">&quot;histogram&quot;</span>))</span></code></pre></div>
<p><img src="Bayesian_statistics_files/figure-html/unnamed-chunk-117-1.png" width="90%" /></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="ebs.html#cb284-1"></a><span class="kw">detach</span>(Rainfall)</span></code></pre></div>
</div>
<div id="priors-defaults" class="section level2">
<h2><span class="header-section-number">3.7</span> On priors and defaults</h2>
<p>Bayesian priors are a wonderful idea.
Who would not like to make the best of their knowledge?
In the remainder of this book, I will <em>not</em> further introduce Bayesian priors and I owe you an explanation of how they can be used and why I don’t use them.
Let’s first take a look at the continuum of certainty.</p>
<p>Like any knowledge, prior knowledge is certain to a degree.
An example of <em>overwhelming prior</em> knowledge is an IQ score, which is designed to follow a Gaussian distribution with a mean of 100 and a standard deviation of 15.
IQ scores are also designed to be non-discriminating.
Rumors are, that a certain professor unknowingly used such an IQ test to identify gender differences in intelligence.
A Bayesian model with overwhelming priors will always return the prior itself.</p>
<p><em>Strong prior</em> knowledge can exist in the form of earlier experiments.
For example, the famous Stroop task is an experiment on human cognition that has been replicated hundreds of times.
In the Stroop task two conditions are mainly compared: the congruent and the incongruent condition and the experiment has been repeated so many times, that we have a pretty good idea of typical reaction times.
For example, someone could ask whether a certain deficit in cognitive functioning could be detected by the Stroop task.
This seems like a clinical trial experiment with a diagnosed group versus the healthy control group.
Because we have strong knowledge about the RT distribution in the population of young and healthy Psychology students, the experiment can effectively be reduced to only assess diagnosed participants.</p>
<p>Strong priors are the most useful, because we need to collect less data.
Strong priors are only available, when similar experiments have been conducted in the past and the results have been recorded, properly.
In the domain of design research, repetition of experiments rare and any variation of circumstances can have significant effects.
Design research simply is a <em>domain of weak prior knowledge</em>.</p>
<p><em>Weak prior</em> knowledge is unspecific knowledge about effects.
A certain experimentalist may not know the precise population average in the Stroop task, but would expect the majority RTs to be in range 300 - 2000ms.
For the research question this is rather useless information, but for the process of estimation it is not.
The MCMC algorithm is a random walk in a highly dimensional space and every little guidance us useful.</p>
<p>Use of priors is a complex task on its own.
For one thing, priors are specified as distribution function.
When the MCMC algorithm dances its random walk on Experiment 1, the result is a frequency distribution, which can take any shape.
In contrast, the result is <em>not</em> a distribution function.
Before we can use the results of Experiment 1 as priors for Experiment 2, we first have to identify the distribution.
The knowledge required to do that in a correct way for the models presented in this book, would fill a book on its own.</p>
<p>Still, there can be repetitions of the same experiment, leading to valuable prior knowledge.
For example, the experiment on the Uncanny Valley effects, which I will present in <a href="lm.html#prm">4.6</a>, was our third replication of <span class="citation">(Mathur and Reichling 2016)</span>.
All four experiments, including the original, share most of the stimuli (robot faces), the experimental design (a three-way design-o-metric encounter <a href="mlm.html#designometrix">5.8.4</a>) and the instrument of measurement (Eeriness ratings).
The purpose of the fourth experiment was to estimate most precisely, at which point emotional reactions towards human-like faces take a plunge, the trough of the Uncanny Valley.
From the first three experiments we had a good approximation of where the trough is.
That means we can, and should use this information.
The thing is, I do not have to specify priors, as I own the data of the previous two replications and I have a copy of the original data.
With the methods described in this book, I can just merge the four data sets and run my model with full prior knowledge, circumventing the formal specification of priors.</p>
<p>Bayes’ formula requires that there is a prior distribution.
It can be totally flat, but it still is a distribution.
Both regression engines used through-out this book allow user-specified priors for all parameters in a model.
Unfortunately, the interface for doing that is anything but user-friendly.
Fortunately, it seems that weak priors can effectively be automated.
Rstanarm <span class="citation">(Goodrich et al. 2020)</span> and Brms <span class="citation">(Bürkner 2017)</span> both run on the whole class of Generalized Linear Multi-level Models without user-specified priors.
In personal communication, Paul Bürkner, author of the Brms package was confident that the weakly informative priors generated by his implementation are safe to use for the models presented in this book.
Just a little less confident, the Rstanarm package warns the user that priors have been automatically generated and that there is the possibility that running the model in a future version of the package may result in different results.</p>
<p>For the data and models at hand, I don’t expect that future updates on the algorithm for prior specification will require me to update the conclusions I have drawn.
It rather reflects that specification of priors is still an art.
Even in more recent books, the recommendations for prior specification differ.
When the warning message is gone, the time has come to write an artisan chapter on prior specification.</p>
<!-- Speaking of which. The two regression engines provide a lean and comprehensive formula language, yet it specifies a huge range of models. From a simple expression like `(1|Part)`, the engine creates tens, sometimes  hundreds or thousands of parameters.  -->
<!-- Both engines accept specification of priors by the user, but these are given in yet another language, Stan [%Stan]. -->
</div>
<div id="further-readings" class="section level2">
<h2><span class="header-section-number">3.8</span> Further readings</h2>
<ol style="list-style-type: decimal">
<li><p>Giving priors an inferior role in this book was a pragmatic choice and this does not make me proud. For readers who want to pursue into this direction, I recommend</p>
<ol style="list-style-type: lower-alpha">
<li><span class="citation">(McElreath 2018)</span> for a start, who builds this topic from ground up and provides a user-friendly interface for the simultaneous specification of likelihood and prior.</li>
<li><span class="citation">(Gelman et al. 2013)</span> for the most explicit treatment of prior specification.</li>
</ol></li>
<li><p>Readers who now feel that they thoroughly need to re-think Statistics, <span class="citation">(McElreath 2018)</span>, a book that truly deserves its title.</p></li>
<li><p><span class="citation">(McElreath 2018)</span> also provides a more in-depth, yet accessible, introduction to the theory of statistical distributions. He explains why the Normal distribution is called “Normal” and draws fascinating connections with Information Theory.</p></li>
<li><p>An extensive set of statistical distributions is catalogued in <span class="citation">(Gelman et al. 2013)</span>.
Another good source on this topic is <a href="https://en.wikipedia.org/wiki/List_of_probability_distributions">Wikipedia List of Probability Distributions</a>.</p></li>
<li><p><span class="citation">(McElreath 2020)</span> uses a phantastic metaphor to explain the MCMC algorithm.</p></li>
</ol>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="gsr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
