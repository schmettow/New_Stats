<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Getting started with R | New statistics for the design researcher</title>
  <meta name="description" content="A statistics book for designers, human factors specialists, UX researchers, applied psychologists and everyone else who works hard to make this world a better place." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Getting started with R | New statistics for the design researcher" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A statistics book for designers, human factors specialists, UX researchers, applied psychologists and everyone else who works hard to make this world a better place." />
  <meta name="github-repo" content="schmettow/New_Stats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Getting started with R | New statistics for the design researcher" />
  
  <meta name="twitter:description" content="A statistics book for designers, human factors specialists, UX researchers, applied psychologists and everyone else who works hard to make this world a better place." />
  

<meta name="author" content="Martin Schmettow" />


<meta name="date" content="2020-09-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="ebs.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>I Preparations</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#whom-for"><i class="fa fa-check"></i><b>1.1</b> Whom this book is for</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#design-researcher"><i class="fa fa-check"></i><b>1.1.1</b> The empirical design researcher</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#experimentalist"><i class="fa fa-check"></i><b>1.1.2</b> The experimentalist</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#applied-researcher"><i class="fa fa-check"></i><b>1.1.3</b> The applied researcher</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#what-new-stats"><i class="fa fa-check"></i><b>1.2</b> What is New Statistics?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#how-to-use"><i class="fa fa-check"></i><b>1.3</b> How to use this book</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#classroom"><i class="fa fa-check"></i><b>1.3.1</b> In the classroom</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#handbook"><i class="fa fa-check"></i><b>1.3.2</b> As a handbook</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#rosetta"><i class="fa fa-check"></i><b>1.3.3</b> The stone of Rosetta</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#quant-design-research"><i class="fa fa-check"></i><b>1.4</b> Quantitative design research</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#studies-in-design-research"><i class="fa fa-check"></i><b>1.5</b> Studies in Design Research</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#observations-measures"><i class="fa fa-check"></i><b>1.6</b> Observations and measures</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#interaction-seq"><i class="fa fa-check"></i><b>1.6.1</b> Interaction sequences</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#perf-measures"><i class="fa fa-check"></i><b>1.6.2</b> performance measures</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#experience-tbd"><i class="fa fa-check"></i><b>1.6.3</b> experience [TBD]</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#design-features-tbd"><i class="fa fa-check"></i><b>1.6.4</b> design features [TBD]</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#the-human-factor-tbd"><i class="fa fa-check"></i><b>1.6.5</b> the human factor [TBD]</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#situations-tbd"><i class="fa fa-check"></i><b>1.6.6</b> situations [TBD]</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gsr.html"><a href="gsr.html"><i class="fa fa-check"></i><b>2</b> Getting started with R</a><ul>
<li class="chapter" data-level="2.1" data-path="gsr.html"><a href="gsr.html#setting-up-r"><i class="fa fa-check"></i><b>2.1</b> Setting up the R environment</a><ul>
<li class="chapter" data-level="2.1.1" data-path="gsr.html"><a href="gsr.html#install-cran"><i class="fa fa-check"></i><b>2.1.1</b> Installing CRAN packages</a></li>
<li class="chapter" data-level="2.1.2" data-path="gsr.html"><a href="gsr.html#install-github"><i class="fa fa-check"></i><b>2.1.2</b> Installing packages from Github</a></li>
<li class="chapter" data-level="2.1.3" data-path="gsr.html"><a href="gsr.html#first-program"><i class="fa fa-check"></i><b>2.1.3</b> A first statistical program</a></li>
<li class="chapter" data-level="2.1.4" data-path="gsr.html"><a href="gsr.html#bibliographic-notes"><i class="fa fa-check"></i><b>2.1.4</b> Bibliographic notes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="gsr.html"><a href="gsr.html#r-primer"><i class="fa fa-check"></i><b>2.2</b> Learning R: a primer</a><ul>
<li class="chapter" data-level="2.2.1" data-path="gsr.html"><a href="gsr.html#objects"><i class="fa fa-check"></i><b>2.2.1</b> Assigning and calling Objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="gsr.html"><a href="gsr.html#vectors"><i class="fa fa-check"></i><b>2.2.2</b> Vectors</a></li>
<li class="chapter" data-level="2.2.3" data-path="gsr.html"><a href="gsr.html#object-types"><i class="fa fa-check"></i><b>2.2.3</b> Basic object types</a></li>
<li class="chapter" data-level="2.2.4" data-path="gsr.html"><a href="gsr.html#operators-functions"><i class="fa fa-check"></i><b>2.2.4</b> Operators and functions</a></li>
<li class="chapter" data-level="2.2.5" data-path="gsr.html"><a href="gsr.html#data-frames"><i class="fa fa-check"></i><b>2.2.5</b> Storing data in data frames</a></li>
<li class="chapter" data-level="2.2.6" data-path="gsr.html"><a href="gsr.html#import-export"><i class="fa fa-check"></i><b>2.2.6</b> Import, export and archiving</a></li>
<li class="chapter" data-level="2.2.7" data-path="gsr.html"><a href="gsr.html#case-env"><i class="fa fa-check"></i><b>2.2.7</b> Case environments</a></li>
<li class="chapter" data-level="2.2.8" data-path="gsr.html"><a href="gsr.html#structuring-data"><i class="fa fa-check"></i><b>2.2.8</b> Structuring data</a></li>
<li class="chapter" data-level="2.2.9" data-path="gsr.html"><a href="gsr.html#data-transformation"><i class="fa fa-check"></i><b>2.2.9</b> Data transformation</a></li>
<li class="chapter" data-level="2.2.10" data-path="gsr.html"><a href="gsr.html#plotting"><i class="fa fa-check"></i><b>2.2.10</b> Plotting data</a></li>
<li class="chapter" data-level="2.2.11" data-path="gsr.html"><a href="gsr.html#fitting"><i class="fa fa-check"></i><b>2.2.11</b> Fitting regression models</a></li>
<li class="chapter" data-level="2.2.12" data-path="gsr.html"><a href="gsr.html#knitting"><i class="fa fa-check"></i><b>2.2.12</b> Knitting statistical reports</a></li>
<li class="chapter" data-level="2.2.13" data-path="gsr.html"><a href="gsr.html#ex-gsr"><i class="fa fa-check"></i><b>2.2.13</b> Exercises</a></li>
<li class="chapter" data-level="2.2.14" data-path="gsr.html"><a href="gsr.html#lib_gsr"><i class="fa fa-check"></i><b>2.2.14</b> Bibliographic notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ebs.html"><a href="ebs.html"><i class="fa fa-check"></i><b>3</b> Elements of Bayesian statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="ebs.html"><a href="ebs.html#decision-making"><i class="fa fa-check"></i><b>3.1</b> Rational decision making in design research</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ebs.html"><a href="ebs.html#measuring-uncertainty"><i class="fa fa-check"></i><b>3.1.1</b> Measuring uncertainty</a></li>
<li class="chapter" data-level="3.1.2" data-path="ebs.html"><a href="ebs.html#benchmarking-designs"><i class="fa fa-check"></i><b>3.1.2</b> Benchmarking designs</a></li>
<li class="chapter" data-level="3.1.3" data-path="ebs.html"><a href="ebs.html#comparing-designs"><i class="fa fa-check"></i><b>3.1.3</b> Comparison of designs</a></li>
<li class="chapter" data-level="3.1.4" data-path="ebs.html"><a href="ebs.html#prior-knowledge"><i class="fa fa-check"></i><b>3.1.4</b> Prior knowledge</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ebs.html"><a href="ebs.html#descriptive-stats"><i class="fa fa-check"></i><b>3.2</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ebs.html"><a href="ebs.html#frequencies"><i class="fa fa-check"></i><b>3.2.1</b> Frequencies</a></li>
<li class="chapter" data-level="3.2.2" data-path="ebs.html"><a href="ebs.html#central-tendency"><i class="fa fa-check"></i><b>3.2.2</b> Central tendency</a></li>
<li class="chapter" data-level="3.2.3" data-path="ebs.html"><a href="ebs.html#dispersion"><i class="fa fa-check"></i><b>3.2.3</b> Dispersion</a></li>
<li class="chapter" data-level="3.2.4" data-path="ebs.html"><a href="ebs.html#associations"><i class="fa fa-check"></i><b>3.2.4</b> Associations</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ebs.html"><a href="ebs.html#bayes-prob-theory"><i class="fa fa-check"></i><b>3.3</b> Bayesian probability theory</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ebs.html"><a href="ebs.html#set-theory"><i class="fa fa-check"></i><b>3.3.1</b> Some set theory</a></li>
<li class="chapter" data-level="3.3.2" data-path="ebs.html"><a href="ebs.html#probability"><i class="fa fa-check"></i><b>3.3.2</b> Probability</a></li>
<li class="chapter" data-level="3.3.3" data-path="ebs.html"><a href="ebs.html#likelihood"><i class="fa fa-check"></i><b>3.3.3</b> Likelihood</a></li>
<li class="chapter" data-level="3.3.4" data-path="ebs.html"><a href="ebs.html#bayes-freq-prob"><i class="fa fa-check"></i><b>3.3.4</b> Bayesian and frequentist probability</a></li>
<li class="chapter" data-level="3.3.5" data-path="ebs.html"><a href="ebs.html#bayes-theorem"><i class="fa fa-check"></i><b>3.3.5</b> Bayes theorem</a></li>
<li class="chapter" data-level="3.3.6" data-path="ebs.html"><a href="ebs.html#dynamics-belief"><i class="fa fa-check"></i><b>3.3.6</b> Bayesian dynamics of belief</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ebs.html"><a href="ebs.html#statmod"><i class="fa fa-check"></i><b>3.4</b> Statistical models</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ebs.html"><a href="ebs.html#structural-part"><i class="fa fa-check"></i><b>3.4.1</b> The structural part</a></li>
<li class="chapter" data-level="3.4.2" data-path="ebs.html"><a href="ebs.html#distributions"><i class="fa fa-check"></i><b>3.4.2</b> Distributions: shapes of randomness</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ebs.html"><a href="ebs.html#bayes-estimation"><i class="fa fa-check"></i><b>3.5</b> Towards Bayesian estimation</a></li>
</ul></li>
<li class="part"><span><b>II Models</b></span></li>
<li class="chapter" data-level="4" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>4</b> Linear models</a><ul>
<li class="chapter" data-level="4.1" data-path="lm.html"><a href="lm.html#GMM"><i class="fa fa-check"></i><b>4.1</b> Quantification at work: grand mean models</a><ul>
<li class="chapter" data-level="4.1.1" data-path="lm.html"><a href="lm.html#random-walk"><i class="fa fa-check"></i><b>4.1.1</b> Do the random walk: Markov Chain Monte Carlo sampling</a></li>
<li class="chapter" data-level="4.1.2" data-path="lm.html"><a href="lm.html#likelihood-random-term"><i class="fa fa-check"></i><b>4.1.2</b> Likelihood and random term</a></li>
<li class="chapter" data-level="4.1.3" data-path="lm.html"><a href="lm.html#posterior-dist"><i class="fa fa-check"></i><b>4.1.3</b> Working with the posterior distribution</a></li>
<li class="chapter" data-level="4.1.4" data-path="lm.html"><a href="lm.html#clu"><i class="fa fa-check"></i><b>4.1.4</b> Center and interval estimates</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lm.html"><a href="lm.html#lrm"><i class="fa fa-check"></i><b>4.2</b> Walk the line: linear regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="lm.html"><a href="lm.html#transform-measures"><i class="fa fa-check"></i><b>4.2.1</b> Transforming measures</a></li>
<li class="chapter" data-level="4.2.2" data-path="lm.html"><a href="lm.html#correlations"><i class="fa fa-check"></i><b>4.2.2</b> Correlations</a></li>
<li class="chapter" data-level="4.2.3" data-path="lm.html"><a href="lm.html#endless-linear"><i class="fa fa-check"></i><b>4.2.3</b> Endlessly linear</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lm.html"><a href="lm.html#factorial-models"><i class="fa fa-check"></i><b>4.3</b> Factorial Models</a><ul>
<li class="chapter" data-level="4.3.1" data-path="lm.html"><a href="lm.html#cgm"><i class="fa fa-check"></i><b>4.3.1</b> A versus B: Comparison of groups</a></li>
<li class="chapter" data-level="4.3.2" data-path="lm.html"><a href="lm.html#dummy"><i class="fa fa-check"></i><b>4.3.2</b> Not stupid: dummy variables</a></li>
<li class="chapter" data-level="4.3.3" data-path="lm.html"><a href="lm.html#treatment-contrasts"><i class="fa fa-check"></i><b>4.3.3</b> Treatment contrast</a></li>
<li class="chapter" data-level="4.3.4" data-path="lm.html"><a href="lm.html#amm"><i class="fa fa-check"></i><b>4.3.4</b> Absolute Means Model</a></li>
<li class="chapter" data-level="4.3.5" data-path="lm.html"><a href="lm.html#ofm"><i class="fa fa-check"></i><b>4.3.5</b> Ordered Factors Models</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lm.html"><a href="lm.html#mpm"><i class="fa fa-check"></i><b>4.4</b> Putting it all together: multi predictor models</a><ul>
<li class="chapter" data-level="4.4.1" data-path="lm.html"><a href="lm.html#mrm"><i class="fa fa-check"></i><b>4.4.1</b> On surface: multiple regression models</a></li>
<li class="chapter" data-level="4.4.2" data-path="lm.html"><a href="lm.html#mfm"><i class="fa fa-check"></i><b>4.4.2</b> Crossover: multifactorial models</a></li>
<li class="chapter" data-level="4.4.3" data-path="lm.html"><a href="lm.html#grm"><i class="fa fa-check"></i><b>4.4.3</b> Line-by-line: grouped regression models</a></li>
<li class="chapter" data-level="4.4.4" data-path="lm.html"><a href="lm.html#emp-stat-control"><i class="fa fa-check"></i><b>4.4.4</b> Empirical versus statistical control</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lm.html"><a href="lm.html#cfxm"><i class="fa fa-check"></i><b>4.5</b> Conditional effects models</a><ul>
<li class="chapter" data-level="4.5.1" data-path="lm.html"><a href="lm.html#cmrm"><i class="fa fa-check"></i><b>4.5.1</b> Conditional multiple regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="lm.html"><a href="lm.html#cmfm"><i class="fa fa-check"></i><b>4.5.2</b> Conditional multifactorial models</a></li>
<li class="chapter" data-level="4.5.3" data-path="lm.html"><a href="lm.html#saturation"><i class="fa fa-check"></i><b>4.5.3</b> Hitting the boundaries of saturation</a></li>
<li class="chapter" data-level="4.5.4" data-path="lm.html"><a href="lm.html#amplification"><i class="fa fa-check"></i><b>4.5.4</b> More than the sum: amplification</a></li>
<li class="chapter" data-level="4.5.5" data-path="lm.html"><a href="lm.html#cfx-theory"><i class="fa fa-check"></i><b>4.5.5</b> Conditional effects and theory</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lm.html"><a href="lm.html#prm"><i class="fa fa-check"></i><b>4.6</b> Doing the rollercoaster: polynomial regression models</a><ul>
<li class="chapter" data-level="4.6.1" data-path="lm.html"><a href="lm.html#test-stat"><i class="fa fa-check"></i><b>4.6.1</b> Make yourself a test statistic</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mlm.html"><a href="mlm.html"><i class="fa fa-check"></i><b>5</b> Multilevel models</a><ul>
<li class="chapter" data-level="5.1" data-path="mlm.html"><a href="mlm.html#intercept-re"><i class="fa fa-check"></i><b>5.1</b> The Human Factor: Intercept random effects</a></li>
<li class="chapter" data-level="5.2" data-path="mlm.html"><a href="mlm.html#slope-re"><i class="fa fa-check"></i><b>5.2</b> Slope random effects: variance in change</a></li>
<li class="chapter" data-level="5.3" data-path="mlm.html"><a href="mlm.html#thinking-multi-level"><i class="fa fa-check"></i><b>5.3</b> Thinking multi-level</a></li>
<li class="chapter" data-level="5.4" data-path="mlm.html"><a href="mlm.html#universality"><i class="fa fa-check"></i><b>5.4</b> Testing universality of theories</a></li>
<li class="chapter" data-level="5.5" data-path="mlm.html"><a href="mlm.html#non-human-populations"><i class="fa fa-check"></i><b>5.5</b> Non-human populations and cross-overs</a></li>
<li class="chapter" data-level="5.6" data-path="mlm.html"><a href="mlm.html#nested-re"><i class="fa fa-check"></i><b>5.6</b> Nested random effects</a></li>
<li class="chapter" data-level="5.7" data-path="mlm.html"><a href="mlm.html#pool-shrink"><i class="fa fa-check"></i><b>5.7</b> What are random effects? On pooling and shrinkage</a></li>
<li class="chapter" data-level="5.8" data-path="mlm.html"><a href="mlm.html#psychometrics"><i class="fa fa-check"></i><b>5.8</b> Psychometrics and designometric models</a><ul>
<li class="chapter" data-level="5.8.1" data-path="mlm.html"><a href="mlm.html#coverage"><i class="fa fa-check"></i><b>5.8.1</b> Coverage</a></li>
<li class="chapter" data-level="5.8.2" data-path="mlm.html"><a href="mlm.html#reliability"><i class="fa fa-check"></i><b>5.8.2</b> Reliability</a></li>
<li class="chapter" data-level="5.8.3" data-path="mlm.html"><a href="mlm.html#validity"><i class="fa fa-check"></i><b>5.8.3</b> Validity</a></li>
<li class="chapter" data-level="5.8.4" data-path="mlm.html"><a href="mlm.html#designometrix"><i class="fa fa-check"></i><b>5.8.4</b> Design-o-metrix</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>6</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="6.1" data-path="glm.html"><a href="glm.html#elements-glm"><i class="fa fa-check"></i><b>6.1</b> Elements of Generalized Linear Models</a><ul>
<li class="chapter" data-level="6.1.1" data-path="glm.html"><a href="glm.html#relinking-linearity"><i class="fa fa-check"></i><b>6.1.1</b> Re-linking linearity</a></li>
<li class="chapter" data-level="6.1.2" data-path="glm.html"><a href="glm.html#choosing-randomness"><i class="fa fa-check"></i><b>6.1.2</b> Choosing patterns of randomness</a></li>
<li class="chapter" data-level="6.1.3" data-path="glm.html"><a href="glm.html#mean-var-rel"><i class="fa fa-check"></i><b>6.1.3</b> Mean-variance relationship</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="glm.html"><a href="glm.html#count-data"><i class="fa fa-check"></i><b>6.2</b> Count data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="glm.html"><a href="glm.html#pois-reg"><i class="fa fa-check"></i><b>6.2.1</b> Poisson regression</a></li>
<li class="chapter" data-level="6.2.2" data-path="glm.html"><a href="glm.html#logistic-aka-binomial-regression-logistic-reg"><i class="fa fa-check"></i><b>6.2.2</b> Logistic (aka Binomial) regression (#logistic-reg)</a></li>
<li class="chapter" data-level="6.2.3" data-path="glm.html"><a href="glm.html#overdispersion"><i class="fa fa-check"></i><b>6.2.3</b> Modelling overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="glm.html"><a href="glm.html#duration-measures"><i class="fa fa-check"></i><b>6.3</b> Duration measures</a><ul>
<li class="chapter" data-level="6.3.1" data-path="glm.html"><a href="glm.html#exp-gam-reg"><i class="fa fa-check"></i><b>6.3.1</b> Exponential and Gamma regression</a></li>
<li class="chapter" data-level="6.3.2" data-path="glm.html"><a href="glm.html#exgauss-reg"><i class="fa fa-check"></i><b>6.3.2</b> ExGaussian regression</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="glm.html"><a href="glm.html#rating-scales"><i class="fa fa-check"></i><b>6.4</b> Rating scales</a><ul>
<li class="chapter" data-level="6.4.1" data-path="glm.html"><a href="glm.html#ord-logist-reg"><i class="fa fa-check"></i><b>6.4.1</b> Ordered logistic regression</a></li>
<li class="chapter" data-level="6.4.2" data-path="glm.html"><a href="glm.html#beta-reg"><i class="fa fa-check"></i><b>6.4.2</b> Beta regression</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="glm.html"><a href="glm.html#distributional-models"><i class="fa fa-check"></i><b>6.5</b> Beyond mean: distributional models</a><ul>
<li class="chapter" data-level="6.5.1" data-path="glm.html"><a href="glm.html#item-anchoring"><i class="fa fa-check"></i><b>6.5.1</b> Item-level anchoring in rating scales</a></li>
<li class="chapter" data-level="6.5.2" data-path="glm.html"><a href="glm.html#part-employment"><i class="fa fa-check"></i><b>6.5.2</b> Participant-level employment of scale</a></li>
<li class="chapter" data-level="6.5.3" data-path="glm.html"><a href="glm.html#part-skew"><i class="fa fa-check"></i><b>6.5.3</b> Participant-level skew in reaction times</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="wwm.html"><a href="wwm.html"><i class="fa fa-check"></i><b>7</b> Working with models</a><ul>
<li class="chapter" data-level="7.1" data-path="wwm.html"><a href="wwm.html#model-criticism"><i class="fa fa-check"></i><b>7.1</b> Model criticism</a><ul>
<li class="chapter" data-level="7.1.1" data-path="wwm.html"><a href="wwm.html#residual-analysis"><i class="fa fa-check"></i><b>7.1.1</b> Residual analysis</a></li>
<li class="chapter" data-level="7.1.2" data-path="wwm.html"><a href="wwm.html#fitted-responses"><i class="fa fa-check"></i><b>7.1.2</b> Fitted responses analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="wwm.html"><a href="wwm.html#model-selection"><i class="fa fa-check"></i><b>7.2</b> Model selection</a><ul>
<li class="chapter" data-level="7.2.1" data-path="wwm.html"><a href="wwm.html#overfitting"><i class="fa fa-check"></i><b>7.2.1</b> The problem of over-fitting</a></li>
<li class="chapter" data-level="7.2.2" data-path="wwm.html"><a href="wwm.html#cross-validation"><i class="fa fa-check"></i><b>7.2.2</b> Cross validation and LOO</a></li>
<li class="chapter" data-level="7.2.3" data-path="wwm.html"><a href="wwm.html#ic"><i class="fa fa-check"></i><b>7.2.3</b> Information Criteria</a></li>
<li class="chapter" data-level="7.2.4" data-path="wwm.html"><a href="wwm.html#choose-dist"><i class="fa fa-check"></i><b>7.2.4</b> Choosing response distributions</a></li>
<li class="chapter" data-level="7.2.5" data-path="wwm.html"><a href="wwm.html#testing-theories"><i class="fa fa-check"></i><b>7.2.5</b> Testing theories</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reflections.html"><a href="reflections.html"><i class="fa fa-check"></i><b>8</b> Reflections</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="cases.html"><a href="cases.html"><i class="fa fa-check"></i><b>A</b> Cases</a><ul>
<li class="chapter" data-level="A.1" data-path="cases.html"><a href="cases.html#real-cases"><i class="fa fa-check"></i><b>A.1</b> Real cases</a><ul>
<li class="chapter" data-level="A.1.1" data-path="cases.html"><a href="cases.html#cue8"><i class="fa fa-check"></i><b>A.1.1</b> CUE8</a></li>
<li class="chapter" data-level="A.1.2" data-path="cases.html"><a href="cases.html#uncanny"><i class="fa fa-check"></i><b>A.1.2</b> Uncanny Valley</a></li>
<li class="chapter" data-level="A.1.3" data-path="cases.html"><a href="cases.html#ipump"><i class="fa fa-check"></i><b>A.1.3</b> IPump</a></li>
<li class="chapter" data-level="A.1.4" data-path="cases.html"><a href="cases.html#sleepstudy"><i class="fa fa-check"></i><b>A.1.4</b> Case Sleepstudy</a></li>
<li class="chapter" data-level="A.1.5" data-path="cases.html"><a href="cases.html#egan"><i class="fa fa-check"></i><b>A.1.5</b> Egan</a></li>
<li class="chapter" data-level="A.1.6" data-path="cases.html"><a href="cases.html#mmn"><i class="fa fa-check"></i><b>A.1.6</b> Case: Millers Magic Number</a></li>
<li class="chapter" data-level="A.1.7" data-path="cases.html"><a href="cases.html#aup"><i class="fa fa-check"></i><b>A.1.7</b> AUP</a></li>
<li class="chapter" data-level="A.1.8" data-path="cases.html"><a href="cases.html#hugme"><i class="fa fa-check"></i><b>A.1.8</b> Hugme</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="cases.html"><a href="cases.html#synthetic-data"><i class="fa fa-check"></i><b>A.2</b> Synthetic data sets</a><ul>
<li class="chapter" data-level="A.2.1" data-path="cases.html"><a href="cases.html#rainfall"><i class="fa fa-check"></i><b>A.2.1</b> Rainfall</a></li>
<li class="chapter" data-level="A.2.2" data-path="cases.html"><a href="cases.html#sec99"><i class="fa fa-check"></i><b>A.2.2</b> 99 seconds</a></li>
<li class="chapter" data-level="A.2.3" data-path="cases.html"><a href="cases.html#rational"><i class="fa fa-check"></i><b>A.2.3</b> Rational</a></li>
<li class="chapter" data-level="A.2.4" data-path="cases.html"><a href="cases.html#browsingab"><i class="fa fa-check"></i><b>A.2.4</b> BrowsingAB</a></li>
<li class="chapter" data-level="A.2.5" data-path="cases.html"><a href="cases.html#headache"><i class="fa fa-check"></i><b>A.2.5</b> Headache</a></li>
<li class="chapter" data-level="A.2.6" data-path="cases.html"><a href="cases.html#reading"><i class="fa fa-check"></i><b>A.2.6</b> Reading time</a></li>
<li class="chapter" data-level="A.2.7" data-path="cases.html"><a href="cases.html#argame"><i class="fa fa-check"></i><b>A.2.7</b> AR_game</a></li>
<li class="chapter" data-level="A.2.8" data-path="cases.html"><a href="cases.html#sleep"><i class="fa fa-check"></i><b>A.2.8</b> Sleep</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">New statistics for the design researcher</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gsr" class="section level1">
<h1><span class="header-section-number">2</span> Getting started with R</h1>
<p>In this book, we will be using the statistical computing environment R. R at its core is a programming language that specializes on statistics and data analysis. Like all modern programming languages, R is more than just a compiler or interpreter that translates human-writeable formal statements into something a computer understands and can execute. R comes with a complete set of standard libraries that cover the usual basic stuff, as well as a collection of common statistical routines, for example the t-test or functions to compute mean and variance. Even regression analysis and plotting is included in R. Finally, packaged with R comes a rudimentary programming environment, including a console, a simple editor and a help system.</p>
<p>Most of what comes packaged with R, we will set aside. R is basically a brilliantly designed programming language for the task, but many of the standard libraries are an inconsistent and outdated mess. For example, R comes with a set of commands to import data from various formats (SPSS, CSV, etc.). Some of these commands produce objects called data.frames, whereas others return lists of lists. Although one can convert lists into dataframes, it is easier and prevents confusion if all import functions simply create dataframes. As another example, to sort a data frame by participant number, one has to write the following syntax soup:</p>
<p><code>D[order(D$Part),]</code></p>
<p>In the past few years, a single person, Hadley Wickham, has almost single-handedly started an initiative known as the <em>tidyverse</em>. The tidyverse is a growing collection of libraries that ground on a coherent and powerful set of principles for data management. One of the core packages is <em>dplyr</em> and it introduces a rich, yet rather generic, set of commands for data manipulation. The sorting of a data frame mentioned above would be written as</p>
<p><code>D %&gt;% arrange(Part)</code></p>
<p>One of Wickham’s first and well-known contributions is the <em>ggplot</em> system for graphics. Think of R’s legacy graphics system as a zoo of individual routines, one for boxplots, another one for scatterplots asf. Like animals in a zoo, they live in different habitats with practically no interaction. ggplot implements a rather abstract framework for data plots, where all pieces can be combined in a myriad of ways, using a simple and consistent syntax.</p>
<p>Where to get these gems? R is an open source system and has spawned an open ecosystem for statistical computing. Thousands of extensions for R have been made available by data scientists for data scientists. The majority of these packages is available through the <em>comprehensive R archive network (CRAN)</em>. For the common user it suffices to think of CRAN as an internet catalogue of packages, that can be searched and where desired packages can be downloaded and installed in an instance.</p>
<p>Finally, R comes with a very rudimentary programming environment that carries the questionable charm of early 1990s. Whereas several alternatives exist, most R users will feel most comfortable with the R programming environment Rstudio. At the time of writing, it is the most user-friendly and feature rich software to program in R. The next sections describe how you can set up a fully functional environment and verify that it works. Subsequently, we will get to know the basics of programming in R.</p>
<div id="setting-up-r" class="section level2">
<h2><span class="header-section-number">2.1</span> Setting up the R environment</h2>
<p>First, we <!-- #4 --> have to make sure that you have the two essential applications R and Rstudio downloaded and installed on your computer. The two programs can be retrieved from the addresses below. Make sure to select the version fit for your operating system.</p>
<ul>
<li><a href="http://www.r-project.org">R</a></li>
<li><a href="http://www.rstudio.com">Rstudio</a></li>
</ul>
<p>If you fully own the computer you are working with, meaning that you have administrator rights, just do the usual downloading and running of the setup. If everything is fine, you’ll find R and Rstudio installed under <code>c\Programs\</code> and both are in your computers start menu. You can directly proceed to the installation of packages.</p>
<p>In corporate environments, two issues can arise with the installation: first a user may not have administrator rights to install programs to the common path <code>c:\programs\</code>. Second, the home directory may reside on a network drive, which is likely to cause trouble when installing packages.</p>
<p>If you have no administrator rights, you must choose your home directory during the setup. If that is a local directory, (<code>c:/Users/YourName/</code>), this should work fine and you can proceed with the installation of packages.</p>
<p>If your home directory (i.e. <code>My Documents</code>) is located on a network drive, this is likely to cause trouble. In such a case, you must install R and Rstudio to a local directory (on your computers hard drive), where you have full read/write access. In the following, it is assumed that this directory is <code>D:/Users/YourName/</code>:</p>
<ol style="list-style-type: decimal">
<li>create a directory <code>D:/Users/YourName/R/</code>. This is where both programs, as well as packages will reside.</li>
<li>create a sub directory <code>Rlibrary</code> where all additional packages reside (R comes with a pack of standard packages, which are in a read-only system directory).</li>
<li>start Rstudio</li>
<li>create a regular text file <code>File -&gt; New File -&gt; Text file</code></li>
<li>copy and paste code from the box below</li>
<li>save the file as <code>.Rprofile</code> in <code>D:/Users/YourName/R/</code></li>
<li>open the menu and go to <code>Tools -&gt; Global options -&gt; General -&gt; Default working directory</code>. Select <code>D:/Users/YourName/R/</code>.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="gsr.html#cb7-1"></a><span class="co">## .Rprofile</span></span>
<span id="cb7-2"><a href="gsr.html#cb7-2"></a></span>
<span id="cb7-3"><a href="gsr.html#cb7-3"></a><span class="kw">options</span>(<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb7-4"><a href="gsr.html#cb7-4"></a></span>
<span id="cb7-5"><a href="gsr.html#cb7-5"></a>.First &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb7-6"><a href="gsr.html#cb7-6"></a>  RHOME &lt;&lt;-<span class="st"> </span><span class="kw">getwd</span>()</span>
<span id="cb7-7"><a href="gsr.html#cb7-7"></a>    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Loading .Rprofile in&quot;</span>, <span class="kw">getwd</span>(), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-8"><a href="gsr.html#cb7-8"></a>  <span class="kw">.libPaths</span>(<span class="kw">c</span>(<span class="kw">paste0</span>(RHOME,<span class="st">&quot;Rlibrary&quot;</span>), <span class="kw">.libPaths</span>()))</span>
<span id="cb7-9"><a href="gsr.html#cb7-9"></a>}</span>
<span id="cb7-10"><a href="gsr.html#cb7-10"></a></span>
<span id="cb7-11"><a href="gsr.html#cb7-11"></a>.Last &lt;-<span class="st"> </span><span class="cf">function</span>(){ </span>
<span id="cb7-12"><a href="gsr.html#cb7-12"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Goodbye at &quot;</span>, <span class="kw">date</span>(), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-13"><a href="gsr.html#cb7-13"></a>}</span></code></pre></div>
<p>With the above steps you have created a customized start-up profile for R. The profile primarily sets the library path to point to a directory on the computers drive. As you are owning this directory, R can install the packages without admin rights. In the second part, you configure Rstudio’s default path, which is where R, invoked from Rstudio, searches for the .Rprofile.</p>
<p>After closing and reopening Rstudio, you should see a message in the console window saying:</p>
<blockquote>
<p>Loading .Rprofile in D:/Users/YourName/R/</p>
</blockquote>
<p>That means that R has found the <code>.Rprofile</code> file and loaded it at start-up. The <code>.Rprofile</code> file primarily sets the path of the <em>library</em>, which is the collection of packages you install yourself. Whether this was successful can be checked by entering the <code>console</code> window in Rstudio, type the command below and hit Enter.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="gsr.html#cb8-1"></a><span class="kw">.libPaths</span>()</span></code></pre></div>
<p>If your installation went fine, you should see an output like the following. If the output lacks the first entry, your installation was not successful and you need to check all the above steps.</p>
<blockquote>
<p>[1] “D:/Users/YourName/R/Rlibrary” “C:/Program Files/R/R-3.3.0/library”</p>
</blockquote>
<div id="install-cran" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Installing CRAN packages</h3>
<p>While R comes with a set of standard packages, thousands of packages are available to enhance functionality for every purpose you can think of. Most packages are available from the <em>Comprehensive R Network Archive (CRAN)</em>.</p>
<p>For example, the package <em>foreign</em> is delivered with R and provides functions to read data files in various formats, e.g. SPSS files. The package <em>haven</em> is a rather new package, with enhanced functionality and usability. It is not delivered with R, hence, so we have to fetch it.</p>
<p>Generally, packages need to be <em>installed once</em> on your system and to be <em>loaded everytime</em> you need them. Installation is fairly straight-forward once your R environment has been setup correctly and you have an internet connection.</p>
<p>In this book we will use a number of additional packages from CRAN. The listed packages below are all required packages, all can be loaded using the <code>library(package)</code> command. The package <em>tidyverse</em> is a metapackage that installs and loads a number of modern packages. The ones being used in this book are:</p>
<ul>
<li><em>dplyr</em> and <em>tidyr</em> for data manipulation</li>
<li><em>ggplot</em> for graphics</li>
<li><em>haven</em> for reading and writing files from other statistical packages</li>
<li><em>readr</em> for reading and writing text-based data files (e.g., CSV)</li>
<li><em>readxl</em> for reading Excel files</li>
<li><em>stringr</em> for string matching and manipulation</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="gsr.html#cb9-1"></a><span class="co">## tidyverse</span></span>
<span id="cb9-2"><a href="gsr.html#cb9-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb9-3"><a href="gsr.html#cb9-3"></a></span>
<span id="cb9-4"><a href="gsr.html#cb9-4"></a><span class="co">## data manipulation</span></span>
<span id="cb9-5"><a href="gsr.html#cb9-5"></a><span class="kw">library</span>(openxlsx)</span>
<span id="cb9-6"><a href="gsr.html#cb9-6"></a></span>
<span id="cb9-7"><a href="gsr.html#cb9-7"></a><span class="co">## plotting</span></span>
<span id="cb9-8"><a href="gsr.html#cb9-8"></a><span class="kw">library</span>(gridExtra)</span>
<span id="cb9-9"><a href="gsr.html#cb9-9"></a></span>
<span id="cb9-10"><a href="gsr.html#cb9-10"></a><span class="co">## regression models</span></span>
<span id="cb9-11"><a href="gsr.html#cb9-11"></a><span class="kw">library</span>(rstanarm)</span>
<span id="cb9-12"><a href="gsr.html#cb9-12"></a></span>
<span id="cb9-13"><a href="gsr.html#cb9-13"></a><span class="co">## other</span></span>
<span id="cb9-14"><a href="gsr.html#cb9-14"></a><span class="kw">library</span>(devtools) <span class="co">## only needed for installing from Github</span></span>
<span id="cb9-15"><a href="gsr.html#cb9-15"></a><span class="kw">library</span>(knitr)</span>
<span id="cb9-16"><a href="gsr.html#cb9-16"></a></span>
<span id="cb9-17"><a href="gsr.html#cb9-17"></a><span class="co">## non-CRAN packages</span></span>
<span id="cb9-18"><a href="gsr.html#cb9-18"></a><span class="kw">library</span>(mascutils)</span>
<span id="cb9-19"><a href="gsr.html#cb9-19"></a><span class="kw">library</span>(bayr)</span></code></pre></div>
<p>We start by <em>checking the packages</em>:</p>
<ol style="list-style-type: decimal">
<li>create a new R file by <code>File --&gt; New file --&gt; R script</code></li>
<li>copy and paste the above code to that file and run it. By repeatedly pressing <code>Ctrl-Return</code> you run every line one-by-one. As a first time user with a fresh installation, you will now see error messages like:</li>
</ol>
<blockquote>
<p>Error in library(tidyverse) : there is no package called ‘tidyverse’</p>
</blockquote>
<p>This means that the respective package is not yet present in your R library. Before you can use the package <em>tidyverse</em> you have to install it from CRAN. For doing so, use the built-in package management in RStudio, which fetches the package from the web and is to be found in the tab <em>Packages</em>. At the first time, you may have to select a repository and refresh the package list, before you can find and install packages. Then click <code>Install</code>, enter the names of the missing package(s) and install. On the R console the following command downloads and installs the package <em>tidyverse</em>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="gsr.html#cb10-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>CRAN is like a giant stream of software pebbles, shaped over time in a growing tide. Typically, a package gets better with every version, be it in reliability or versatility, so you want to be up-to-date. Rstudio has a nice dialogue to update packages and there is the R command:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="gsr.html#cb11-1"></a><span class="kw">update.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>Finally, run the complete code block at once by selecting it and <code>Ctrl-Enter</code>. You will see some output to the console, which you should check once again. Unless the output contains any error messages (like above), you have successfully installed and loaded all packages.</p>
<p><em>Note</em> that R has a somewhat idiosyncratic jargon: many languages, such as Java or Python, call “libraries” what R calls “packages”. <em>The</em> library in R is strictly the set of packages installed on your computer and the <code>library</code> command loads a package from the library.</p>
</div>
<div id="install-github" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Installing packages from Github</h3>
<p>Two packages, <em>mascutils</em> and <em>bayr</em> are written by the author of this book. They have not yet been committed to CRAN, but they are available on <em>Github</em> which is a general purpose versioning system for software developers and few authors. Fortunately, with the help of the <em>devtools</em> package it is rather easy to install these packages, too. Just enter the Rstudio console and type:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="gsr.html#cb12-1"></a><span class="kw">library</span>(devtools)</span>
<span id="cb12-2"><a href="gsr.html#cb12-2"></a><span class="kw">install_github</span>(<span class="st">&quot;schmettow/mascutils&quot;</span>)</span>
<span id="cb12-3"><a href="gsr.html#cb12-3"></a><span class="kw">install_github</span>(<span class="st">&quot;schmettow/bayr&quot;</span>)</span></code></pre></div>
<p>Again, you have to do that only once after installing R and you can afterwards load the packages with the <code>library</code> command. Only if the package gets an update to add functionality or remove bugs, you need to run these commands again.</p>
</div>
<div id="first-program" class="section level3">
<h3><span class="header-section-number">2.1.3</span> A first statistical program</h3>
<p>After you have set up your R environment, you are ready to run your first R program (you will not yet understand all the code, but as you proceed with this book, all will become clear):</p>
<ol style="list-style-type: decimal">
<li>Stay in the file where you have inserted and run the above code for loading the packages.</li>
<li>Find the <em>environment tab</em> in Rstudio. It should be empty.</li>
<li>Copy-and-paste the code below into your first file, right after library commands.</li>
<li>Run the code lines one-by-one and observe what happens (in RStudio: Ctrl-Enter)</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="gsr.html#cb13-1"></a><span class="co">## Simulation of a data set with 100 participants </span></span>
<span id="cb13-2"><a href="gsr.html#cb13-2"></a><span class="co">## in two between-subject conditions</span></span>
<span id="cb13-3"><a href="gsr.html#cb13-3"></a>N &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb13-4"><a href="gsr.html#cb13-4"></a>levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;control&quot;</span>,<span class="st">&quot;experimental&quot;</span>)</span>
<span id="cb13-5"><a href="gsr.html#cb13-5"></a>Group &lt;-<span class="st"> </span><span class="kw">rep</span>(levels, N<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb13-6"><a href="gsr.html#cb13-6"></a>age &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">runif</span>(N, <span class="dv">18</span>, <span class="dv">35</span>),<span class="dv">0</span>)</span>
<span id="cb13-7"><a href="gsr.html#cb13-7"></a>outcome &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dv">42</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>, <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>(Group <span class="op">==</span><span class="st"> &quot;experimental&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">42</span></span>
<span id="cb13-8"><a href="gsr.html#cb13-8"></a>Experiment &lt;-<span class="st"> </span><span class="kw">tibble</span>(Group, age, outcome) <span class="op">%&gt;%</span><span class="st"> </span>mascutils<span class="op">::</span><span class="kw">as_tbl_obs</span>()</span>
<span id="cb13-9"><a href="gsr.html#cb13-9"></a></span>
<span id="cb13-10"><a href="gsr.html#cb13-10"></a>Experiment <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">8</span>)</span>
<span id="cb13-11"><a href="gsr.html#cb13-11"></a></span>
<span id="cb13-12"><a href="gsr.html#cb13-12"></a><span class="co">## Plotting the distribution of outcome</span></span>
<span id="cb13-13"><a href="gsr.html#cb13-13"></a>Experiment <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-14"><a href="gsr.html#cb13-14"></a><span class="st">  </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> outcome) ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-15"><a href="gsr.html#cb13-15"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/first_simulation_1-1.png" width="90%" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="gsr.html#cb14-1"></a><span class="co">## ... outcome by group</span></span>
<span id="cb14-2"><a href="gsr.html#cb14-2"></a>Experiment <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-3"><a href="gsr.html#cb14-3"></a><span class="st">  </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">fill =</span> Group, <span class="dt">x =</span> outcome) ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-4"><a href="gsr.html#cb14-4"></a><span class="st">  </span><span class="kw">geom_density</span>()</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/first_simulation_1-2.png" width="90%" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="gsr.html#cb15-1"></a><span class="co">## ... statistical model comparing the groups</span></span>
<span id="cb15-2"><a href="gsr.html#cb15-2"></a></span>
<span id="cb15-3"><a href="gsr.html#cb15-3"></a>model &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(<span class="dt">formula =</span> outcome <span class="op">~</span><span class="st"> </span>Group, </span>
<span id="cb15-4"><a href="gsr.html#cb15-4"></a>            <span class="dt">data =</span> Experiment) </span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="gsr.html#cb16-1"></a><span class="kw">fixef</span>(model)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fixef</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="right">209.9</td>
<td align="right">207</td>
<td align="right">213.0</td>
</tr>
<tr class="even">
<td align="left">Groupexperimental</td>
<td align="right">41.4</td>
<td align="right">37</td>
<td align="right">45.6</td>
</tr>
</tbody>
</table>
<p>Observe Console, Environment and Plots. Did you see</p>
<ul>
<li>how the <em>Environment</em> window is populated with new variables (Values and Data)?</li>
<li>a table appears in the <em>Console</em>, when executing the <code>summary(Experiment)</code> command?</li>
<li>how the “camel-against-the-light” in <em>Plots</em> tab morphed into “two-piles-of-colored-sugar”?</li>
</ul>
<p>Congratulations! You have just</p>
<ul>
<li>simulated data of a virtual experiment with two groups</li>
<li>summarized the data</li>
<li>plotted the data and</li>
<li>estimated a Bayesian regression model that compares the two groups.</li>
</ul>
<p>Isn’t it amazing, that in less than 20 simple statements we have just reached the level of a second-year bachelor student? Still, you may find the R output a little inconvenient, as you may want to save the output of your data analysis. Not long ago, that really was an issue, but in the past few years R has become a great tool for <em>reproducable research</em>. The most simple procedure of saving your analysis for print or sharing is to:</p>
<ol style="list-style-type: decimal">
<li>save the R file your have created by hitting <code>CTRL-S</code> and selecting a directory and name.</li>
<li>in RStudio open <code>File --&gt; Compile notebook</code> and select Word as a format.</li>
<li>Hit <code>Compile</code></li>
</ol>
<p>A new Word document should appear that shows all code and the output. Now, you can copy-and-paste the graphics into another document or a presentation.</p>
</div>
<div id="bibliographic-notes" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Bibliographic notes</h3>
<p><a href="http://www.calvin.edu/~rpruim/talks/Rminis/RStartingUp.pdf">Getting started with Rstudio (presentation)</a></p>
<p><a href="http://it-ebooks.info/book/2253/">Getting started with Rstudio (ebook)</a></p>
<p><a href="http://www.rstudio.com/resources/cheatsheets/">rstudio cheat sheets</a> is a collection of beautifully crafted cheat sheets for ggplot, dplyr and more. I suggest you print the data mangling and ggplot cheat sheets and always keep them on your desk.</p>
<p><a href="http://tidyverse.org/">The tidyverse</a> is a meta package that loads all core tidyverse packages by Hadley Wickham.</p>
</div>
</div>
<div id="r-primer" class="section level2">
<h2><span class="header-section-number">2.2</span> Learning R: a primer</h2>
<blockquote>
<p>cRazy as in ‘idiosyncrasy’</p>
</blockquote>
<p>This book is for applied researchers in design sciences, whose frequent task is to analyze data and report it to stakeholders. Consequently, the way I use R in this book capitalizes on interactive data analysis and reporting. As it turns out, a small fraction of R, mostly from the tidyverse, is sufficient to write R code that is effective and fully transparent. In most cases, a short chain of simple data transformations tidies the raw data which can then be pushed into a modelling or graphics engine that will do the hard work. We will not bother (ourselves and others) with usual programming concepts such as conditionals, loops or the somewhat eccentric approaches to functional programming. At the same time, we can almost ignore all the clever and advanced routines that underlay statistical inference and production of graphics, as others have done the hard work for us.</p>
<p>R mainly serves three purposes, from easy to advanced:
1. interactive data analysis
2. creating data analysis reports
3. developing new statistical routines.</p>
<p>It turns out that creating multimedia reports in R has become very easy by the knitr/markdown framework that is neatly integrated into the Rstudio environment. I</p>
<p>With R one typically <em>works interactively through a data analysis</em>. The analysis often is a rather routine series of steps, like:</p>
<ol style="list-style-type: decimal">
<li>load the data</li>
<li>make a scatter plot</li>
<li>run a regression</li>
<li>create a coefficient table</li>
</ol>
<p>A program in R is usually developed iteratively: once you’ve loaded and checked your data, you progress to the next step step of your analysis, test it and proceed. At every step, one or more new objects are created in the environment, capturing intermediate and final results of the analysis:</p>
<ol style="list-style-type: decimal">
<li>a data frame holding the data</li>
<li>a graphics object holding a scatterplot</li>
<li>a model object holding the results of a regression analysis</li>
<li>a data frame for the coefficient table</li>
</ol>
<p>As R is an interpreter language, meaning there is no tedious compile-and-run cycles in everyday R programming. You develop the analysis as it happens. It is even normal to jump back and forth in an R program, while building it.</p>
<p>R is a way to <em>report and archive</em> what precisely you have been doing with your data. In statistics, mathematical formulas are the common form of unambiguously describing a statistical model. For example, the following equation defines a linear regression model between the observed outcome <span class="math inline">\(y\)</span> and the predictor <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\mu_i &amp;= \beta_0 +  \beta_1x_i\\
y_i &amp;\sim N(\mu_i, \sigma)
\end{aligned}
\]</span></p>
<p>As we will later see <a href="lm.html#cgm">4.3.1</a>, in Rs formula language the same model is unambiguously specified as:</p>
<p><code>y ~ x</code></p>
<p>R is currently the <em>lingua franca</em> of statistical computing. As a programming language, R has the same precision as math, but is more expressive. You can specify complex models, but also graphics and the steps of data checking and preparation. As an example, consider an outlier removal rule of:</p>
<blockquote>
<blockquote>
<p>An observation is valid if it does not exceed the tenfold of the observation mean.</p>
</blockquote>
</blockquote>
<p>We just applied our own rule of outlier removal to the data. Others may consider this rule invalid or arbitrary. Disagreement is virtue in science and one can only disagree with what one actually sees. In R, the researcher <em>formally reports</em> what precisely has been done with the data. For example, the same outlier removal rule is unambiguously specified by the following code (the first line just simulates some data).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="gsr.html#cb17-1"></a>D &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">score =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">50</span>, <span class="dv">800</span>))</span>
<span id="cb17-2"><a href="gsr.html#cb17-2"></a></span>
<span id="cb17-3"><a href="gsr.html#cb17-3"></a>D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(score <span class="op">&lt;</span><span class="st"> </span><span class="kw">mean</span>(score)) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">50</td>
</tr>
</tbody>
</table>
<p>Finally, R is a way to <em>develop and share statistical programs</em>. Thousands of packages in the R ecosystem cover almost all statistical problems you can imagine. As a programming language, R has been designed for that particular purpose. Under the hood of R, a bunch of generic, yet powerful, principles purr to make it a convenient language for typical problems in statistical computation. Readers with programming experience can fly over the R basics that follow. But, as a specific purpose language R has a few idiosyncracies you should know about:</p>
<p>Almost all programming languages the first element of a list has the index zero. We got used to it, but for beginners it is a another hurdle that is unnecessary. Mathematicians, catholiques, software developers in bars and everyone, young or old, counts</p>
<blockquote>
<blockquote>
<p>“one”, “two” ,“three”.</p>
</blockquote>
</blockquote>
<p>And so does R:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="gsr.html#cb18-1"></a><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>Counting from one is perhaps the most lovable idiosyncracy of R. But, lets also welcome people who have experience with other programming languages:</p>
<p>The first thing one has to know about R is that it is a <em>functional programming</em> language. A function simply is a programmed procedure that takes data as input, applies some transformation and returns data as output. That sounds trivial, but there is an important difference to most other languages: Different to procedures in Pascal or object oriented methods (in Java or Python), functions are forbidden to modify any external object. A certain function is a black box, but one can be sure that the only thing it does is return a new object.</p>
<p>At the same time, functions are first-class citizens in R and can be called everywhere, even as an <em>argument to another function</em>. The <em>plyr</em> package is famous for functions that call functions, also called high-level functions. The following three liner makes heavy use of high level functions. First, a list of binary matrices is generated by repeatedly calling a random number generator, then the row sum of all matrices is computed and returned as a (new) list.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="gsr.html#cb20-1"></a>make_binary_matrix &lt;-<span class="st"> </span></span>
<span id="cb20-2"><a href="gsr.html#cb20-2"></a><span class="st">  </span><span class="cf">function</span>(size) <span class="kw">as.matrix</span>(<span class="kw">rbernoulli</span>(size<span class="op">^</span><span class="dv">2</span>, <span class="dt">p =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>))</span>
<span id="cb20-3"><a href="gsr.html#cb20-3"></a></span>
<span id="cb20-4"><a href="gsr.html#cb20-4"></a>LoM &lt;-<span class="st"> </span><span class="kw">llply</span>(<span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>), make_binary_matrix)</span>
<span id="cb20-5"><a href="gsr.html#cb20-5"></a></span>
<span id="cb20-6"><a href="gsr.html#cb20-6"></a><span class="kw">llply</span>(LoM, rowSums)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0
## 
## [[2]]
##  [1] 0 0 0 0 0 1 0 1 0 0 0 1 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0
## 
## [[3]]
##  [1] 0 0 0 0 0 0 0 0 1 1 1 0 0 0 1 1 0 0 0 0 0 0 0 1 0 1 0 1 1 0 0 0 0 0 1 0 0 0
## [39] 0 0 1 0 0 0 0 0 0 0 0</code></pre>
<p>What we have seen is a routine application of higher level functions: apply a transformation to a sequence of data sets. In a majority of programming languages you had to write a loop instead and this is why experienced programmers can easily fall for the active user paradox when they learn R, by sticking to loops. Believe me one thing: Once you have wrapped your head around functional programming, you will program the same procedure in a quarter of time with half the code and your program will run significantly faster. My general advice is:</p>
<blockquote>
<blockquote>
<p>Whenever you think you need a loop, you don’t.</p>
</blockquote>
</blockquote>
<p>For me it helped to imagine the following: loops carry the notion of chain of data that moves over a fixed transformation device. In functional programing functions the can work in a hierarchy, a high-level device moves along a string of data. It carries an exchangeable low-level device that applies the desired transformation to every position.</p>
<p>If you come from relational data bases you you have something in common with the statistician: you both think in transformation of tables. Not coincidently, the features in <em>dplyr</em>, the tidy data transformation engine, are clearly borrowed from SQL. You will also feel at home with the idea of reports powered by functional chunks embedded in a templating system.</p>
<p>For object orientation folks, R is a good choice, but you have to get used to it. First, it gives you the choice of several object orientation systems, which sometimes requires to install a package. The so-called <em>S3 system</em> is the original. It is rather limited and some even call it informal. The approach is as simple as it is unusal. S3 mainly is a raw method dispatcher that can handles overloading of functions. S3 puts methods first, then objects, whereas in traditional object orientation, the method belongs to the class, making the object “knows” its methods. In S3, the object and the method both know their class. When calling an S3 method, you actually call a generic method that finds the matching method and applies it.</p>
<p>Beginners are at peace with all of this. You can count like you do. Functional programming is intuitive for working on research data. And because of S3 the function <code>summary</code> always does something useful.</p>
<div id="objects" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Assigning and calling Objects</h3>
<p>Any statistical analysis can be thought of as a production chain. You take the raw data and process it into a neat data table, which you feed into graphics and regression engines or summarize by other means. At almost every step there is an input and an output object.</p>
<p><em>Objects</em> are a basic feature of R. They are temporary storage places in the computer’s memory. Objects always have a name chosen by the programmer. By its name, a stored object can be found back at any time. Two basic operations apply for all objects: an object is stored by <em>assigning</em> it a name and it is retrieved by <em>calling</em> its name. If you wanted to store the number of observations in your data set under the name <code>N_obs</code>, you use the assignment operator <code>&lt;-</code>. The name of the variable is left of the operator, the assigned value is right of it.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="gsr.html#cb22-1"></a>N_obs &lt;-<span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<p>Now, that the value is stored, you can call it any time by simply calling its name:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="gsr.html#cb23-1"></a>N_obs</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Just calling the name prints the value to Console. In typical interactive programming sessions with R, this is already quite useful. But, you can do much more with this mechanism.</p>
<p>Often, what you want is to do calculations with the value. For example, you have a repeated measures study and want to calculate the average number of observations per participant. For this you need the number of observations, and the number of participants. The below code creates both objects, does the calculation (right of <code>&lt;-</code>) and stores it in another object <code>avg_N_Obs</code></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="gsr.html#cb25-1"></a>N_Obs &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb25-2"><a href="gsr.html#cb25-2"></a>N_Part &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb25-3"><a href="gsr.html#cb25-3"></a>avg_N_Obs &lt;-<span class="st"> </span>N_Obs<span class="op">/</span>N_Part</span>
<span id="cb25-4"><a href="gsr.html#cb25-4"></a>avg_N_Obs</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Objects can exist without a name, but are volatile, then. They cannot be used any further. The following arithmetic operation does create an object, a single number. For a moment or so this number exists somewhere in your computers memory, but once it is printed to the screen, it is gone. Of course, the same expression can be called again, resulting in the same number. But, strictly, it is a different object.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="gsr.html#cb27-1"></a>N_Obs<span class="op">/</span>N_Part <span class="co">## gone after printing</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="gsr.html#cb29-1"></a>N_Obs<span class="op">/</span>N_Part <span class="co">## same value, different object</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>There even is a formal way to show that the two numbers, although having the same value assigned, are located at different addresses. This is just for the purpose of demonstration and you will rarely use it in everyday programming tasks:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="gsr.html#cb31-1"></a><span class="kw">tracemem</span>(N_Obs<span class="op">/</span>N_Part)</span></code></pre></div>
<pre><code>## [1] &quot;&lt;000000003DA6A530&gt;&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="gsr.html#cb33-1"></a><span class="kw">tracemem</span>(N_Obs<span class="op">/</span>N_Part)</span></code></pre></div>
<pre><code>## [1] &quot;&lt;000000003DAD36C8&gt;&quot;</code></pre>
</div>
<div id="vectors" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Vectors</h3>
<p>Notice the <code>[1]</code> that R put in front of the single value when printing it? This is an <em>index</em>. Different to other programming languages, all basic data types are <em>vectors</em> in R. Vectors are containers for storing many values <em>of the same type</em>. The values are addressed by the index, <code>N_Obs[1]</code> calls the first element. In R, <em>indices start counting with 1</em>, which is different to most other languages that start at zero. And if you have a single value only, this is just a vector of length one.</p>
<p>For statistics programming having vectors as basic data types makes perfect sense. Any statistical data is a collection of values. What holds for data is also true for functions applied to data. Practically all frequently used mathematical functions work on vectors, take the following example:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="gsr.html#cb35-1"></a>X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb35-2"><a href="gsr.html#cb35-2"></a><span class="kw">mean</span>(X)</span></code></pre></div>
<pre><code>## [1] 1.96</code></pre>
<p>The <code>rnorm</code> command <em>produces</em> a vector of length 100 from three values. More precisely, it does 100 random draws from a normal distribution with mean 2 and an SD of 1. The <code>mean</code> command takes the collection and <em>reduces</em> it to a single value. By the way, this is precisely, what we call <em>a statistic: a single quantity that characterizes a collection of quantities</em>.</p>
</div>
<div id="object-types" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Basic object types</h3>
<p>Objects can be of various <em>classes</em>. In R the common basic classes are: logical, factor, character, integer and numeric. Besides that, programmers can define their own complex classes, for example, to store the results of regression models.</p>
<p>Objects of type <em>logical</em> store the two levels <code>TRUE</code>, <code>FALSE</code>, like presence or absence of a treatment, or passed and failed test items. With Boolean operators one can compute new logical values, for example</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="gsr.html#cb37-1"></a>Apple &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb37-2"><a href="gsr.html#cb37-2"></a>Pear  &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb37-3"><a href="gsr.html#cb37-3"></a></span>
<span id="cb37-4"><a href="gsr.html#cb37-4"></a>Apple <span class="op">&amp;</span><span class="st"> </span>Pear <span class="co">## and</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="gsr.html#cb39-1"></a>Apple <span class="op">|</span><span class="st"> </span>Pear <span class="co">## or</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>More generally, logical values can be used for categorization, when their are only two categories, which is called a <em>dichotomous variable</em>. For example, gender is usually coded as a vector of characters (<code>"m", "f", "f"</code>), but one can always do:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="gsr.html#cb41-1"></a>is_female &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>)</span>
<span id="cb41-2"><a href="gsr.html#cb41-2"></a>is_male   &lt;-<span class="st"> </span><span class="kw">c</span>(T, F, F)</span></code></pre></div>
<p>Programmers are lazy folks when it comes to typing, therefore R allows you to abbreviate <code>TRUE</code> and <code>FALSE</code> as shown above. As a consequence, one should never assign objects the name reserved for logical values, so don’t do one of the following:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="gsr.html#cb42-1"></a><span class="co">## never do this</span></span>
<span id="cb42-2"><a href="gsr.html#cb42-2"></a><span class="ot">TRUE</span> &lt;-<span class="st"> &quot;All philosophers have beards&quot;</span> <span class="co">## a character object, see below</span></span>
<span id="cb42-3"><a href="gsr.html#cb42-3"></a>F    &lt;-<span class="st"> &quot;All gods existed before the big bang&quot;</span></span>
<span id="cb42-4"><a href="gsr.html#cb42-4"></a><span class="dv">42</span> <span class="op">*</span><span class="st"> </span>F</span></code></pre></div>
<p>The class <code>numeric</code> stores real numbers and is therefore abundant in statistical programming. All the usual arithmetic operations apply:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="gsr.html#cb43-1"></a>a &lt;-<span class="st"> </span><span class="fl">1.0</span></span>
<span id="cb43-2"><a href="gsr.html#cb43-2"></a>b &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb43-3"><a href="gsr.html#cb43-3"></a><span class="kw">sqrt</span>(b)</span></code></pre></div>
<pre><code>## [1] 1.41</code></pre>
<p>Objects of class <code>integer</code> are more specific as they store natural numbers, only. This often occurs as counts, ranks or indices.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="gsr.html#cb45-1"></a>friends &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">anton =</span> <span class="dv">1</span>, </span>
<span id="cb45-2"><a href="gsr.html#cb45-2"></a>             <span class="dt">berta =</span> <span class="dv">3</span>, </span>
<span id="cb45-3"><a href="gsr.html#cb45-3"></a>             <span class="dt">carlo =</span> <span class="dv">2</span>)</span>
<span id="cb45-4"><a href="gsr.html#cb45-4"></a><span class="kw">order</span>(friends)</span></code></pre></div>
<pre><code>## [1] 1 3 2</code></pre>
<p>The usual arithmetic operations apply, although the result of operation may no longer be <code>integer</code>, but <code>numeric</code></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="gsr.html#cb47-1"></a>N &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb47-2"><a href="gsr.html#cb47-2"></a>sum_of_scores &lt;-<span class="st"> </span><span class="dv">32</span></span>
<span id="cb47-3"><a href="gsr.html#cb47-3"></a>mean_score &lt;-<span class="st"> </span><span class="dv">32</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb47-4"><a href="gsr.html#cb47-4"></a>mean_score</span></code></pre></div>
<pre><code>## [1] 10.7</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="gsr.html#cb49-1"></a><span class="kw">class</span>(mean_score)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>Surprisingly, logical values can be used in arithmetic expressions, too. When R encounters value <code>TRUE</code> in an arithmetic context, it replaces it with 1, zero otherwise. Used with multiplication, this acts like an on/off switch, which we will put to use for building <a href="lm.html#dummy">factorial models</a>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="gsr.html#cb51-1"></a><span class="ot">TRUE</span> <span class="op">+</span><span class="st"> </span><span class="ot">TRUE</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="gsr.html#cb53-1"></a><span class="kw">sqrt</span>(<span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="gsr.html#cb55-1"></a>is_car &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>) <span class="co">## bicycle otherwise</span></span>
<span id="cb55-2"><a href="gsr.html#cb55-2"></a>wheels &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>is_car <span class="op">*</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb55-3"><a href="gsr.html#cb55-3"></a>wheels</span></code></pre></div>
<pre><code>## [1] 4 4 2</code></pre>
<p>Data sets usually contain variables that are not numeric, but partition the data into groups. For example, we frequently group observations by the following</p>
<ul>
<li><code>Part</code>: participant</li>
<li><code>Condition</code>: experimental condition</li>
<li><code>Design</code>: one of several designs</li>
<li><code>Education</code>: level of education (e.g., low, middle or high)</li>
</ul>
<p>Two object types apply for grouping observations: <em>factor</em> and <em>character</em>. While factors specialize on grouping observations, character objects can also be used to store longer text, say the description of a usability problem. The following identifies two conditions in a study, say a comparison of designs A and B. Note how the factor identifies its <em>levels</em> when called to the screen:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="gsr.html#cb57-1"></a>design_char &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>)</span>
<span id="cb57-2"><a href="gsr.html#cb57-2"></a>design_char</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;B&quot; &quot;A&quot;</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="gsr.html#cb59-1"></a>design_fact &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>))</span>
<span id="cb59-2"><a href="gsr.html#cb59-2"></a>design_fact</span></code></pre></div>
<pre><code>## [1] A B B A
## Levels: A B</code></pre>
<p>Statistical analyses deal with real world data which ever so often is messy. Frequently, a planned observation could not be recorded, because the participant decided to quit or the equipment did not work properly or the internet collapsed. Users of certain legacy statistics packages got used to coding missing observations as <code>-999</code> and then declared this a missing value. In R <em>missing values are first-class citizens</em>. Every vector of a certain class can contain missing values, which are identified as <code>NA</code>.</p>
<p>Most basic statistics functions, like <code>mean()</code>, <code>sd()</code> or <code>median()</code> are act conservatively when the data contains missing values. If there is a single <code>NA</code> in the variable to be summarized, the result is <code>NA</code>. While this is good in the sense of transparency, much of the time what the researcher wants is to have the summary statistic with <code>NA</code> values being removed, first.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="gsr.html#cb61-1"></a>clicks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="ot">NA</span>, <span class="dv">2</span>)</span>
<span id="cb61-2"><a href="gsr.html#cb61-2"></a><span class="kw">mean</span>(clicks)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="gsr.html#cb63-1"></a><span class="kw">mean</span>(clicks, <span class="dt">na.rm =</span> T)</span></code></pre></div>
<pre><code>## [1] 2.5</code></pre>
<p>This book is about programming and statistics at the same time. Unfortunately, there are a few terms that have a particular meaning in both domains. One of those is a “variable”. In statistics, a variable usually is a property we have recorded, say the body length of persons, or their gender. In general programming, a variable is a space in the computers memories, where results can be stored and recalled. Fortunately, R avoids any confusion and calls <em>objects</em> what is usually called a programming variable.</p>
</div>
<div id="operators-functions" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Operators and functions</h3>
<p>R comes with a full bunch of functions for creating and summarizing data. Let me first introduce you to functions that produce exactly one number to characterize a vector. The following functions do that with to the vector <code>X</code>, every in their own way:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="gsr.html#cb65-1"></a><span class="kw">length</span>(X)</span>
<span id="cb65-2"><a href="gsr.html#cb65-2"></a><span class="kw">sum</span>(X)</span>
<span id="cb65-3"><a href="gsr.html#cb65-3"></a><span class="kw">mean</span>(X)</span>
<span id="cb65-4"><a href="gsr.html#cb65-4"></a><span class="kw">var</span>(X)</span>
<span id="cb65-5"><a href="gsr.html#cb65-5"></a><span class="kw">sd</span>(X)</span>
<span id="cb65-6"><a href="gsr.html#cb65-6"></a><span class="kw">min</span>(X)</span>
<span id="cb65-7"><a href="gsr.html#cb65-7"></a><span class="kw">max</span>(X)</span>
<span id="cb65-8"><a href="gsr.html#cb65-8"></a><span class="kw">median</span>(X)</span></code></pre></div>
<p>These functions are a transformation of data. The input to these transformations is <code>X</code> and is given as an <em>argument</em> to the function. Other functions require more than one argument. The <code>quantile</code> function is routinely used to summarize a variable. Recall that <code>X</code> has been drawn from a Normal distribution of <span class="math inline">\(\mu=2\)</span> and standard deviation <span class="math inline">\(\sigma = 1\)</span>. All Normal distributions have the property that about 66% of the mass is within the range of <span class="math inline">\(\mu-\sigma\)</span> and <span class="math inline">\(\mu+\sigma\)</span> <!-- #9 -->. That means in turn: 17% are below <span class="math inline">\(\mu-\sigma\)</span> and 66 + 17 = 83% are <em>below</em> <span class="math inline">\(\mu+\sigma\)</span>. The number of observations in a certain range of values is called a <em>quantile</em>. The <code>quantile</code> function operates on X, but takes an (optional) vector of quantiles as second argument:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="gsr.html#cb66-1"></a><span class="kw">quantile</span>(X, <span class="kw">c</span>(.<span class="dv">17</span>, <span class="fl">.83</span>))</span></code></pre></div>
<pre><code>##   17%   83% 
## 0.903 2.978</code></pre>
<p>Most functions in R have <em>optional arguments</em> that let you change how the function performs. The basic mathematical functions all have the optional argument <code>na.rm</code>. This is a switch that determines how the function deals with missing values <code>NA</code>. Many optional arguments have <em>defaults</em>. The default of <code>na.rm</code> is <code>FALSE</code> (“return NA in case of NAs in the vector”). By setting it to <code>TRUE</code>, they are removed before operation.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="gsr.html#cb68-1"></a>B &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="ot">NA</span>, <span class="dv">3</span>)</span>
<span id="cb68-2"><a href="gsr.html#cb68-2"></a><span class="kw">mean</span>(B)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="gsr.html#cb70-1"></a><span class="kw">mean</span>(B, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Most more complex routines in R have an abundance of parameters, most of which have reasonable defaults, fortunately. To give a more complex example, the first call of <code>stan_glm</code> performs a Bayesian estimation of the grand mean model. The second does a
Poisson grand mean model with 5000 iterations per MCMC chain. As <code>seed</code> has been fixed, every subsequent run will produce the exact same chains. My apologies for the jargon! <!-- #10 --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="gsr.html#cb72-1"></a>D_<span class="dv">1</span> =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">X =</span> <span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb72-2"><a href="gsr.html#cb72-2"></a>M_<span class="dv">1</span> =<span class="st"> </span><span class="kw">stan_glm</span>(X <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb72-3"><a href="gsr.html#cb72-3"></a>               <span class="dt">data =</span> D_<span class="dv">1</span>)</span>
<span id="cb72-4"><a href="gsr.html#cb72-4"></a></span>
<span id="cb72-5"><a href="gsr.html#cb72-5"></a>D_<span class="dv">2</span> =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">X =</span> <span class="kw">rpois</span>(<span class="dv">20</span>, <span class="dv">2</span>))</span>
<span id="cb72-6"><a href="gsr.html#cb72-6"></a>M_<span class="dv">2</span> =<span class="st"> </span><span class="kw">stan_glm</span>(X <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb72-7"><a href="gsr.html#cb72-7"></a>               <span class="dt">family =</span> poisson,</span>
<span id="cb72-8"><a href="gsr.html#cb72-8"></a>               <span class="dt">seed =</span> <span class="dv">42</span>,</span>
<span id="cb72-9"><a href="gsr.html#cb72-9"></a>               <span class="dt">iter =</span> <span class="dv">5000</span>,</span>
<span id="cb72-10"><a href="gsr.html#cb72-10"></a>               <span class="dt">data =</span> D_<span class="dv">1</span>)</span></code></pre></div>
<p>R brings the usual set of arithmetic operators, like <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and more. In fact, an operator is just a function. The sum of two numbers can, indeed, be written in these two ways:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="gsr.html#cb73-1"></a><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="gsr.html#cb75-1"></a><span class="st">`</span><span class="dt">+</span><span class="st">`</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>The second term is a function that takes two numbers as input and returns a third. It is just a different syntax, and this one is called the <em>polish notation</em>. I will never use it throughout the rest of this book.</p>
<p>Another set of commonly used operators are logical, they implement <em>Boolean algebra</em>. Some common Boolean operators are shown in the truth table:</p>
<table>
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th>!A</th>
<th>A &amp; B</th>
<th>A | B</th>
<th>A == B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td>not</td>
<td>and</td>
<td>or</td>
<td>equals</td>
</tr>
<tr class="even">
<td>T</td>
<td>T</td>
<td>F</td>
<td>T</td>
<td>T</td>
<td>T</td>
</tr>
<tr class="odd">
<td>T</td>
<td>F</td>
<td>F</td>
<td>F</td>
<td>T</td>
<td>F</td>
</tr>
<tr class="even">
<td>F</td>
<td>T</td>
<td>T</td>
<td>F</td>
<td>T</td>
<td>F</td>
</tr>
<tr class="odd">
<td>F</td>
<td>F</td>
<td>T</td>
<td>F</td>
<td>F</td>
<td>T</td>
</tr>
</tbody>
</table>
<p>Be careful not to confuse Boolean “and” and “or” with their common natural language use. If you ask: “Can you buy apples <em>or</em> pears on the market?”, the natural answer would be: “both”. The Boolean answer is: TRUE. In a requirements document you could state “This app is for children and adults”. In Boolean the answer would be FALSE, because no one can be a child and an adult at the same time, strictly. A correct Boolean statement would be: “The envisioned users can be adult or child”. <!-- #11 --></p>
<p>Further Boolean operators exist, but can be derived from the three above. For example, the exclusive OR, “either A or B” can be written as: <code>(A | B) &amp; !(A &amp; B)</code>. This term only gets TRUE when A or B is TRUE, but not both. In the data analysis workflow, Boolean logic is frequently used for filtering data and we re-encounter them in data transformation.</p>
<p>Finally, it sometimes is convenient or necessary to program own functions. A full coverage of developing functions is beyond the scope of this introduction, so I show just one simple example. If one desires a more convenient function to compute the mean that ignore missing values by default, this can be constructed as follows:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="gsr.html#cb77-1"></a>mean_conv &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb77-2"><a href="gsr.html#cb77-2"></a>  <span class="kw">mean</span>(<span class="dt">x =</span> B, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb77-3"><a href="gsr.html#cb77-3"></a>}</span>
<span id="cb77-4"><a href="gsr.html#cb77-4"></a></span>
<span id="cb77-5"><a href="gsr.html#cb77-5"></a><span class="kw">mean_conv</span>(B)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Notice that:</p>
<ul>
<li>the <code>function()</code> function creates new functions</li>
<li>the arguments given to <code>function(x)</code> will be the arguments expected by the function <code>mean_conv(x)</code>.</li>
<li>code enclosed by</li>
</ul>
<p>More examples of creating basic functions can be found in section @ref(descriptive_stats). As R is a functional programming language, it offers very elaborate ways of programming functions, way beyond what is found in common languages, such as Python or Java. An advanced example is given in section @ref(forecasting_LOO).</p>
</div>
<div id="data-frames" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Storing data in data frames</h3>
<p>Most behavioral research collects <em>real data</em> to work with. As behavior researchers are obsessed about finding associations between variables, real data usually contains several. If you have a sample of observations (e.g. participants) and every case has the same variables (measures or groups), data is stored in a table structure, where columns are variables and rows are observations.</p>
<p>R knows the <code>data.frame</code> objects to store variable-by-observation tables. Data frames are tables, where columns represent statistical variables. Variables have names and can be of different data types, as they usually appear in empirical research. In many cases data frames are imported to R, as they represent real data. Here, we first see how to create data frames by simulation. First, we usually want some initial inspection of a freshly harvested data frame.</p>
<!-- Data frames are objects. By just calling a data frame it gets printed to the screen. This is a good moment to reflect on one idiosyncrasy in R, a feature, of course. R is primarily designed for interactive use, which matches the way researchers build their data analysis. This implies, that the programmer often wants to quickly check what currently is in a variable. Now, observe what happens when we call `Experiment`: -->
<!-- ```{r df_call } -->
<!-- Experiment -->
<!-- ``` -->
<!-- This is useful information printed to the screen, we see sample size, names of objects and their classes, and the first eight observations as examples. What we don't see is the data itself, but some sort of summary. It would be a complete disaster, if R would pass this information on when the call is part of an assignment or other operation on the data, for example: `NewExp <- Experiment`. Apparently, R is aware of whether a called object is part of an operation, or purely for the programmers eyes. For any object, if *called to the console in an intercative session*, R silently uses the `print` function on the object. The following would give precisely the same results as above. -->
<!-- ```{r df_call_print, opts.label = "rtut.nr"} -->
<!-- print(Experiment) -->
<!-- ``` -->
<!-- Such `print` functions exist for dozens of classes of objects. They represent what the developers thought would be the most salient or logical thing to print in an interactive session. By virtue of the object system, R finds the right print function for the object at hand.  -->
<!-- However, when working interactively, most of the time you do a data transformation and assign it to a new variable, thus you check it immediately. As the assignment is always silent (unless there occurs an error), you are forced to type a print statement afterwards. There is shortcut for that: if you embrace the assignment statement in brackets, the result will be printed to the screen. As convenient as this is, especially when creating longer data transformation chains, it introduces some visual clutter. In this book I use it sparingly, at most. -->
<!-- The dedicated print function does what way back a developer thought would be the most useful information in most cases. Depending on the situation, it can provide too much, too little or just the wrong information. For example: when simulating a data set, we want to check whether the resulting data frame has the desired length and whether the variables have the correct class. The standard implementation of the print command, dumps the whole data frame to the screen, which can be much more than ever needed. The newer dplyr implementation `tibble` (from the tidyverse, also called *tibble*) you have seen in action already, is much better suited for this situation, as it displays dimensions and variable classes. In contrast, if the job is to spot whether there are many missing values (`NA`), the classic print performs better. -->
<p>Several commands are available to look into a data frame from different perspectives. Another command that is implemented for a variety of classes, ibluding dara frames, is <code>summary</code>. For all data frames, it produces an overview with descriptive statistics for all variables (i.e. columns), matching their object type. Particularly useful for data initial screening, is that missing values are listed per variable.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="gsr.html#cb79-1"></a><span class="kw">print</span>(<span class="kw">summary</span>(Experiment))</span></code></pre></div>
<pre><code>##       Obs           Group                age          outcome   
##  Min.   :  1.0   Length:100         Min.   :18.0   Min.   :179  
##  1st Qu.: 25.8   Class :character   1st Qu.:22.0   1st Qu.:211  
##  Median : 50.5   Mode  :character   Median :27.0   Median :233  
##  Mean   : 50.5                      Mean   :26.9   Mean   :232  
##  3rd Qu.: 75.2                      3rd Qu.:32.0   3rd Qu.:252  
##  Max.   :100.0                      Max.   :35.0   Max.   :274</code></pre>
<p>The <code>str</code> (structure) command works on any R object and displays the hierarchical structure (if there is one):</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="gsr.html#cb81-1"></a><span class="kw">str</span>(Experiment)</span></code></pre></div>
<pre><code>## Classes &#39;tbl_obs&#39;, &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 100 obs. of  4 variables:
##  $ Obs    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Group  : chr  &quot;control&quot; &quot;experimental&quot; &quot;control&quot; &quot;experimental&quot; ...
##  $ age    : num  18 19 31 28 19 19 32 28 33 31 ...
##  $ outcome: num  209 236 206 256 221 ...</code></pre>
<p>Data frames store variables, but statistical procedures operate on variables. We need ways of accessing and manipulating statistical variables and we will have plenty. First, recall that in R the basic object types are all vectors. You can store as many elements as you want in an object, as long as they are of the same class.</p>
<p>Internally, data frames are a collection of “vertical” vectors that are equally long. Being a collection of vectors, the variables of a data frame can be of different classes, like <code>character</code>, <code>factor</code> or <code>numeric</code>. In the most basic case, you want to calculate a statistic for a single variable out of a data frame. The <code>$</code> operator pulls the variable out as a vector:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="gsr.html#cb83-1"></a><span class="kw">mean</span>(Experiment<span class="op">$</span>outcome)</span></code></pre></div>
<pre><code>## [1] 231</code></pre>
<p>As data frames are rectangular structures, you can also access individual values by their addresses. The following commands call</p>
<ul>
<li>the first <em>outcome</em> measure</li>
<li>the first to third elements of <em>Group</em></li>
<li>the complete first row</li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="gsr.html#cb85-1"></a>Experiment[  <span class="dv">1</span>, <span class="dv">3</span>]</span>
<span id="cb85-2"><a href="gsr.html#cb85-2"></a>Experiment[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb85-3"><a href="gsr.html#cb85-3"></a>Experiment[  <span class="dv">1</span>,  ]</span></code></pre></div>
<p>Addressing one or more elements in square brackets, always requires two elements, first the row, second the column. As odd as it looks, one or both elements can be empty, which just means: get all rows (or all columns). Even the expression <code>Experiment[,]</code> is fully valid and will just the return the whole data frame.</p>
<p>There is an important difference, however, when using R’s classic <code>data.frame</code> as compared to dplyr’s <code>tibble</code>implementation: When using single square brackets on dplyr data frames one always gets a data frame back. That is a very predictable behavior, and very much unlike the classic: with <code>data.frame</code>, when the addressed elements expand over multiple columns, like
<code>Experiment[, 1:2]</code>, the result will be a <code>data.frame</code> object, too. However, when slicing a single column, the result is a vector:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="gsr.html#cb86-1"></a>Exp_classic &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(Experiment)</span>
<span id="cb86-2"><a href="gsr.html#cb86-2"></a>Exp_classic[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]  <span class="co">## data.frame</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Obs</th>
<th align="left">Group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">control</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">experimental</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="gsr.html#cb87-1"></a>Exp_classic[<span class="dv">1</span>,]       <span class="co">## data.frame</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Obs</th>
<th align="left">Group</th>
<th align="right">age</th>
<th align="right">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">control</td>
<td align="right">18</td>
<td align="right">209</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="gsr.html#cb88-1"></a>Exp_classic[,<span class="dv">1</span>]       <span class="co">## vector</span></span></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100</code></pre>
<p>Predictability and a few other useful tweaks made me prefer <code>tibble</code> over <code>data.frame</code>. But, many third-party packages continue to produce classic <code>data.frame</code> objects. For example, there is an alternative to package `<code>readxl</code>, <code>openxlsx</code>, which reads (and writes) Excel files. It returns classic data.frames, which can easily be converted as follows:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="gsr.html#cb90-1"></a>D_foo &lt;-<span class="st"> </span></span>
<span id="cb90-2"><a href="gsr.html#cb90-2"></a><span class="st">  </span><span class="kw">read.xlsx</span>(<span class="st">&quot;foo.xlsx&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb90-3"><a href="gsr.html#cb90-3"></a><span class="st">  </span><span class="kw">as_tibble</span>()</span></code></pre></div>
<p>While <code>tibble[]</code> behaves perfectly predictable, in that it always returns a data frame, even when this is just a single column or cell. Sometimes, one wants to truly extract a vector. With a <code>tibble</code> a single column can be extracted as a vector, using double square brackets, or using the <code>$</code> operator.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="gsr.html#cb91-1"></a>Experiment[[<span class="dv">1</span>]]       <span class="co">## vector</span></span>
<span id="cb91-2"><a href="gsr.html#cb91-2"></a>Experiment<span class="op">$</span>Group      <span class="co">## the same</span></span></code></pre></div>
<p>Sometimes, it may be necessary to change values in a data frame. For example, a few outliers have been discovered during data screening, and the researcher decides to mark them as missing values. The syntax for indexing elements in a data frame can be used in conjunction with the assignment operator <code>&lt;-</code>. In the example below, we make the simulated experiment more realistic by injecting a few outliers. Then we discard these outliers by setting them all to <code>NA</code>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="gsr.html#cb92-1"></a><span class="co">## injecting</span></span>
<span id="cb92-2"><a href="gsr.html#cb92-2"></a>Experiment[<span class="dv">2</span>,      <span class="st">&quot;outcome&quot;</span>] &lt;-<span class="st"> </span><span class="dv">660</span></span>
<span id="cb92-3"><a href="gsr.html#cb92-3"></a>Experiment[<span class="dv">6</span>,      <span class="st">&quot;outcome&quot;</span>] &lt;-<span class="st"> </span><span class="dv">987</span></span>
<span id="cb92-4"><a href="gsr.html#cb92-4"></a>Experiment[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="st">&quot;age&quot;</span>]     &lt;-<span class="st"> </span><span class="dv">-99</span></span>
<span id="cb92-5"><a href="gsr.html#cb92-5"></a></span>
<span id="cb92-6"><a href="gsr.html#cb92-6"></a><span class="co">## printing first few observations</span></span>
<span id="cb92-7"><a href="gsr.html#cb92-7"></a><span class="kw">head</span>(Experiment)</span>
<span id="cb92-8"><a href="gsr.html#cb92-8"></a></span>
<span id="cb92-9"><a href="gsr.html#cb92-9"></a><span class="co">## setting to NA</span></span>
<span id="cb92-10"><a href="gsr.html#cb92-10"></a>Experiment[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">6</span>),<span class="st">&quot;outcome&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb92-11"><a href="gsr.html#cb92-11"></a>Experiment[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),<span class="st">&quot;age&quot;</span>]     &lt;-<span class="st"> </span><span class="ot">NA</span></span></code></pre></div>
<p>Besides the injection, note two more features of addressing data frame elements. The first is, that vectors can be used to address multiple rows, e.g. 2 and 6. In fact, the range operator <code>1:3</code> we used above is just a convenient way of creating a vector <code>c(1,2,3)</code>. Although not shown in the example, this works for columns alike.</p>
<p>The careful reader may also have noted another oddity in the above example. With <code>Experiment[c(2, 6),"outcome"]</code> we addressed two elements, but right-hand side of <code>&lt;-</code> is only one value. That is a basic mechanism of R, called <em>reuse</em>. When the left-hand side is longer than the right-hand side, the right-hand side is reused as many times as needed. Many basic functions in R work like this, and it can be quite useful. <!-- #12 --> For example, you may want to create a vector of 20 random numbers, where one half has a different mean as the second half of observations.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="gsr.html#cb93-1"></a><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The above example reuses the two mean values 50 times, creating an alternating pattern. Strictly speaking, the <code>sd = 1</code> parameter is reused, too, a 100 times. While reuse often comes in convenient, it can also lead to difficult programming errors. So, it is a good advice to be aware of this mechanism and always carefully check the input to vectorized functions.</p>
</div>
<div id="import-export" class="section level3">
<h3><span class="header-section-number">2.2.6</span> Import, export and archiving</h3>
<p>R lets you import data from almost every conceivable source, given that you have installed and loaded the appropriate packages (foreign, haven or openxlsx for Excel files). Besides that R has its own file format for storing data, which is <em>.Rda</em> files. With these files you can save data frames (and any other object in R), using the <code>save(data, file = "some_file.Rda")</code> and <code>load(file = "some_file.Rda")</code> commands.</p>
<p>Few people create their data tables directly in R, but have legacy data sets in Excel (<em>.xslx</em>) and SPSS files (<em>.sav</em>). Moreover, the data can be produced by electronic measurement devices (e.g. electrodermal response measures) or programmed experiments can provide data in different forms, for example as <em>.csv</em> (comma-separated-values) files. All these files can be opened by the following commands:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="gsr.html#cb94-1"></a><span class="co">## Text files</span></span>
<span id="cb94-2"><a href="gsr.html#cb94-2"></a>Experiment &lt;-<span class="st"> </span></span>
<span id="cb94-3"><a href="gsr.html#cb94-3"></a><span class="st">  </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/Experiment.csv&quot;</span>)</span>
<span id="cb94-4"><a href="gsr.html#cb94-4"></a></span>
<span id="cb94-5"><a href="gsr.html#cb94-5"></a><span class="co">## Excel</span></span>
<span id="cb94-6"><a href="gsr.html#cb94-6"></a>Experiment &lt;-<span class="st"> </span></span>
<span id="cb94-7"><a href="gsr.html#cb94-7"></a><span class="st">  </span><span class="kw">read_excel</span>(<span class="st">&quot;Data/Experiment.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="dv">1</span>)</span>
<span id="cb94-8"><a href="gsr.html#cb94-8"></a></span>
<span id="cb94-9"><a href="gsr.html#cb94-9"></a><span class="co">## SPSS (haven)</span></span>
<span id="cb94-10"><a href="gsr.html#cb94-10"></a>Experiment &lt;-<span class="st"> </span></span>
<span id="cb94-11"><a href="gsr.html#cb94-11"></a><span class="st">  </span><span class="kw">read_sav</span>(<span class="st">&quot;Data/Experiment.sav&quot;</span>)</span>
<span id="cb94-12"><a href="gsr.html#cb94-12"></a></span>
<span id="cb94-13"><a href="gsr.html#cb94-13"></a><span class="co">## SPSS (foreign)</span></span>
<span id="cb94-14"><a href="gsr.html#cb94-14"></a>Experiment &lt;-</span>
<span id="cb94-15"><a href="gsr.html#cb94-15"></a><span class="st">  </span><span class="kw">read.spss</span>(<span class="st">&quot;Data/Experiment.sav&quot;</span>, <span class="dt">to.data.frame =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Note that I gave two options for reading SPSS files. The first (with an underscore) is from the newer haven package (part of tidyverse). With some SPSS files, I experienced problems with this command, as it does not convert SPSS’s data type <em>labelled</em> (which is almost the same as an R factor). The alternative is the classic <code>read.spss</code> command which works almost always, but as a default it creates a list of lists, which is not what you typically want. With the extra argument, as shown, it behaves as expected.</p>
<p>Remember, data frames are objects and volatile as such. If you leave your session, they are gone. Once you have you data frame imported and cleaned, you may want to store it to a file. Like for reading, many commands are available for writing all kinds of data formats. If you are lucky to have a complete R-based workflow, you can conveniently use R’s own format for storing data, <code>Rdata</code> files. For storing a data frame and then reading it back in (in your next session), simply do:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="gsr.html#cb95-1"></a><span class="kw">save</span>(Experiment, <span class="dt">file =</span> <span class="st">&quot;Data/Experiment.Rda&quot;</span>)</span>
<span id="cb95-2"><a href="gsr.html#cb95-2"></a><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;Data/Experiment.Rda&quot;</span>)</span></code></pre></div>
<p>Note that with <code>save</code> and <code>load</code> all objects are restored by their original names, without using any assignments. Take care, as this will not overwrite any object with the same name. Another issue is that for the <code>save</code> command you have to explicitly refer to the <code>file</code> argument and provide the file path as a character object. In Rstudio, begin typing <code>file=""</code>, put the cursor between the quotation marks and hit <code>Tab</code>, which opens a small dialogue for navigation to the desired directory.</p>
<p>Once you have loaded, prepared and started to analyze a data frame in R, there is little reason to go back to any legacy program. Still, the <code>haven</code> and <code>foreign</code> packages contain commands to write to various file formats. I’ll keep that as an exercise to the reader.</p>
</div>
<div id="case-env" class="section level3">
<h3><span class="header-section-number">2.2.7</span> Case environments</h3>
<p>This book features more than a dozen case studies. Every case will be encountered several times and multiple objects are created along the way: data sets, regressions, graphics, tables, you name it. That posed the problem of naming the objects, so that they are unique. I could have chosen object names, like: <code>BrowsingAB_M_1</code>, <code>AUP_M_1</code>, etc. But, this is not what you normally would do, when working on one study at a time. Moreover, every letter you add to a line of code makes it more prone to errors and less likely that you, dear reader, are typing it in and trying it out yourself.</p>
<p>For these reasons, all cases are enclosed in <em>case environments</em> and provided with this book. For getting a case environment to work in your session, it has to be loaded from the respective R data file first:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="gsr.html#cb96-1"></a><span class="kw">load</span>(<span class="st">&quot;BrowsingAB.Rda&quot;</span>)</span></code></pre></div>
<p>In R, <em>environments</em> are containers for collections of objects. If an object <code>BAB1</code> is placed in an environment <code>BrowsingAB</code>, it can be called as <code>BrowsingAB$BAB1</code>. This way, no brevity is gained. Another way to assess objects in an environment is to <em>attach the environment first</em> as:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="gsr.html#cb97-1"></a><span class="kw">attach</span>(BrowsingAB)</span>
<span id="cb97-2"><a href="gsr.html#cb97-2"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>()</span>
<span id="cb97-3"><a href="gsr.html#cb97-3"></a><span class="kw">detach</span>(BrowsingAB)</span>
<span id="cb97-4"><a href="gsr.html#cb97-4"></a></span>
<span id="cb97-5"><a href="gsr.html#cb97-5"></a><span class="kw">attach</span>(Reading)</span>
<span id="cb97-6"><a href="gsr.html#cb97-6"></a>D_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>()</span></code></pre></div>
<p>Calling <code>attach</code> gets you into the <em>namespace</em> of the environment (formally correct: the namespace gets imported to your working environment). All objects in that namespace become immediately visible by their mere name. The <code>detach</code> command leaves the environment, again. When working with the case environments, I strongly recommend to detach before attaching another environment.</p>
<p>All case environments provided with this book contain one or more data sets. Many of the cases are synthetic data which has been generated by a simulation function. This function, routinely called <code>simulate</code>, is provided with the case environment, too. That gives you the freedom to produce your own data sets with the same structure, but different effects.
Generally, calling the simulation function without any further arguments, exactly reproduces the synthetic data set provided with the case environment.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="gsr.html#cb98-1"></a><span class="kw">simulate</span>()  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>() <span class="co">## reproduces the data frame D_1</span></span>
<span id="cb98-2"><a href="gsr.html#cb98-2"></a><span class="kw">simulate</span>(<span class="dt">N =</span> <span class="dv">6</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>() <span class="co">## simulates first 6 participants only</span></span></code></pre></div>
<p>Furthermore, once you delve deeper into R, you can critically inspect the simulation function’s code for its behavioral and psychological assumptions (working through the later chapters on data management and simulation will help).</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="gsr.html#cb99-1"></a>simulate <span class="co">## calling a function without parantheses prints its code</span></span></code></pre></div>
<pre><code>## function(N = 40,
##            beta = c(Intercpt = 60, 
##                     fnt_size_12 = -12, 
##                     fnt_color_blk = -10, 
##                     ia_blk_12 = 8),
##            sigma = 5,
##            seed = 42) 
##     {
##     set.seed(seed)
##     out &lt;-
##       tibble(Part = 1:N,
##                  font_size = factor(rep(c(1, 2), N/2), 
##                                     levels = c(1,2), 
##                                     labels = c(&quot;10pt&quot;, &quot;12pt&quot;)),
##                  font_color = factor(c(rep(1, N/2), rep(2, N/2)),
##                                      levels = c(1,2), 
##                                      labels = c(&quot;gray&quot;, &quot;black&quot;))) %&gt;%
##        mutate( mu = beta[1] + 
##                 beta[2] * (font_size == &quot;12pt&quot;) +
##                 beta[3] * (font_color == &quot;black&quot;) +
##                 beta[4] * (font_color == &quot;black&quot;) * (font_size == &quot;12pt&quot;),
##               ToT = rnorm(N,  mu, sigma)) %&gt;% 
##     as_tbl_obs()
##     
##     #class(out) &lt;- append(class(out), &quot;sim_tbl&quot;)
##     attr(out, &quot;coef&quot;) &lt;- list(beta = beta,
##                               sigma = sigma)
##     attr(out, &quot;seed&quot;) &lt;- seed
##     
##     out %&gt;% as_tbl_obs()
##     }
## &lt;bytecode: 0x000000002e133810&gt;</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="gsr.html#cb101-1"></a><span class="kw">detach</span>(Reading)</span></code></pre></div>
<p>Finally, the case environments contain all objects that have been created throughout this book. This is especially useful for the regression models, as fitting these can take from a few seconds to hours.</p>
<p>Note that working with environments is a tricky business. Creating these case environments in an efficient way was more difficult than you may think. Therefore, I do <em>not</em> recommend using environments in everday data analysis, with one exception: at any moment the current working environment contains all objects that have been created, so far. That is precisely the set of objects shown in the Environment pane of Rstudio (or call <code>ls()</code> for a listing). Saving all objects and retrieving them when returning from a break is as easy as:<!-- #13 --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="gsr.html#cb102-1"></a><span class="kw">save</span>(<span class="dt">file =</span> <span class="st">&quot;my_data_analysis.Rda&quot;</span>)</span>
<span id="cb102-2"><a href="gsr.html#cb102-2"></a><span class="co">## have a break</span></span>
<span id="cb102-3"><a href="gsr.html#cb102-3"></a><span class="kw">load</span>(<span class="st">&quot;my_data_analysis.Rda&quot;</span>)</span></code></pre></div>
<p>Next to that, Rstudio can be configured to save the current workspace on exit and reload it on the next start. When working on just one data analysis for a longer period of time, this can be a good choice.</p>
</div>
<div id="structuring-data" class="section level3">
<h3><span class="header-section-number">2.2.8</span> Structuring data</h3>
<p>In the whole book, data sets are structured according to the rule <em>one-row-per-observation of the dependent variable</em> (the ORPO rule). Many researchers still organize their data tables as one-row-per-participant, as is requested by some legacy statistics programs. This is fine in research with non-repeated measures, but will not function properly with modern regression models, like linear mixed-effects models. Consider a study where two designs were evaluated by three participants using a self-report item, like “how easy to use is the interface?” Then, the <em>wrong way</em> of structuring the data would be:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="gsr.html#cb103-1"></a>ORPO <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb103-2"><a href="gsr.html#cb103-2"></a><span class="st">  </span><span class="kw">filter</span>(Task <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, Item <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb103-3"><a href="gsr.html#cb103-3"></a><span class="st">  </span>mascutils<span class="op">::</span><span class="kw">discard_redundant</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb103-4"><a href="gsr.html#cb103-4"></a><span class="st">  </span><span class="kw">spread</span>(Design, response) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb103-5"><a href="gsr.html#cb103-5"></a><span class="st">  </span><span class="kw">as_tbl_obs</span>()</span></code></pre></div>
<p>The correct way of setting up the data frame is:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="gsr.html#cb104-1"></a>ORPO <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb104-2"><a href="gsr.html#cb104-2"></a><span class="st">  </span><span class="kw">filter</span>(Task <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, Item <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb104-3"><a href="gsr.html#cb104-3"></a><span class="st">  </span>mascutils<span class="op">::</span><span class="kw">discard_redundant</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Part</th>
<th align="left">Design</th>
<th align="right">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">A</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">A</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>The ORPO rule dictates another principle: every row should have a unique identifier, which can be a combination of values. In the example above, every observation is uniquely identified by the participant identifier and the design condition. If we extend the example slightly, it is immediatly apparent, why the ORPO rule is justified. Imagine, the study actually asked three partcipants to rate two different tasks on two different designs by three self-report items. By the ORPO rule, we can easily extend the data frame as below (showing a random selection of rows). I leave it up to the reader to figure out how to press such a data set in the wide legacy format.</p>
<p>Using identifiers is good practice for several reasons. First, it reduces problems during manual data entry. Second, it allows to efficiently record data in multi-method experiments and join them automatically. An exammple is given in Appendix <a href="cases.html#hugme">A.1.8</a>. Lastly, the identifiers will become statistically interesting by themselves when we turn to linear mixed-effects models and the notion of <em>members of a population</em> <a href="mlm.html#non-human-populations">5.5</a>. Throughout the book I will use standard names for recurring identifier variables in design research:</p>
<ul>
<li>Part</li>
<li>Design</li>
<li>Item</li>
<li>Task</li>
</ul>
<p>Note that usually these entities get numerical identifiers, but these numbers are just labels. Throughout, variables are written Uppercase when they are entities, but not real numbers. An exception is the trial order in experiments with massive repeated measures. These get a numerical type to allow exploring effects over time such as learning, training and fatigue.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="gsr.html#cb105-1"></a>ORPO <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb105-2"><a href="gsr.html#cb105-2"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb105-3"><a href="gsr.html#cb105-3"></a><span class="st">  </span><span class="kw">arrange</span>(Part, Task, Design, Item)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Part</th>
<th align="right">Task</th>
<th align="left">Design</th>
<th align="right">Item</th>
<th align="right">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">B</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="left">B</td>
<td align="right">3</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2</td>
<td align="left">A</td>
<td align="right">2</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
<div id="data-transformation" class="section level3">
<h3><span class="header-section-number">2.2.9</span> Data transformation</h3>
<p>Do you wonder about the strange use of <code>%&gt;%</code> in my code above? This is the tidy way of programming data transformations in R.</p>
<p>The so-called magritte operator <code>%&gt;%</code> is part of the <em>dplyr/tidyr</em> framework for data manipulation. It chains steps of data manipulation by connecting transformation functions, also called piping. In the following, we will first see a few basic examples. Later, we will proceed to longer transformation chains and see how graceful dplyr piping is, compared to the classic data transformation syntax in R.</p>
<p>Importing data from any of the possible resources, will typically give a data frame. However, often the researcher wants to <em>select</em> or <em>rename</em> variables in the data frame. Say, you want the variable <em>Group</em> to be called <em>Condition</em>, omit the variable <em>age</em> and store the new data frame as <em>Exp</em>. The <code>select</code> command does all this. In the following code the data frame <code>Experiment</code> is piped into <code>select</code>. The variable <em>Condition</em> is renamed to <em>Group</em>, and the variable <em>outcome</em> is taken as-is. All other variables are discarded.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="gsr.html#cb106-1"></a>Exp &lt;-<span class="st">  </span>Experiment <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-2"><a href="gsr.html#cb106-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">Condition =</span> Group, outcome) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>()</span></code></pre></div>
<p>Another frequent step in data analysis is cleaning the data from missing values and outliers. In the following code example, we first “inject” a few missing values for age (which were coded as -99) and outliers (&gt;500) in the outcome variable. Note that I am using some R commands that you don’t need to understand by now. Then we reuse the above code for renaming (this time keeping <em>age</em> on board) and add some filtering steps:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="gsr.html#cb107-1"></a><span class="co">## rename, then filtering</span></span>
<span id="cb107-2"><a href="gsr.html#cb107-2"></a>Exp &lt;-<span class="st">  </span></span>
<span id="cb107-3"><a href="gsr.html#cb107-3"></a><span class="st">  </span>Experiment <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb107-4"><a href="gsr.html#cb107-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">Condition =</span> Group, age, outcome) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb107-5"><a href="gsr.html#cb107-5"></a><span class="st">  </span><span class="kw">filter</span>(outcome <span class="op">&lt;</span><span class="st"> </span><span class="dv">500</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb107-6"><a href="gsr.html#cb107-6"></a><span class="st">  </span><span class="kw">filter</span>(age <span class="op">!=</span><span class="st"> </span><span class="dv">-99</span>)</span>
<span id="cb107-7"><a href="gsr.html#cb107-7"></a></span>
<span id="cb107-8"><a href="gsr.html#cb107-8"></a>Exp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>()</span></code></pre></div>
<p>During data preparation and analysis, new variables are created routinely. For example, the covariate is often shifted to the center before using linear regression:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="gsr.html#cb108-1"></a>mean_age =<span class="st"> </span><span class="kw">mean</span>(Exp<span class="op">$</span>age)</span>
<span id="cb108-2"><a href="gsr.html#cb108-2"></a>Exp &lt;-<span class="st"> </span>Exp <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb108-3"><a href="gsr.html#cb108-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_cntrd =</span> age <span class="op">-</span><span class="st"> </span>mean_age)</span>
<span id="cb108-4"><a href="gsr.html#cb108-4"></a>Exp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>()</span></code></pre></div>
<p>Finally, for the descriptive statistics part of your report, you probably want to summarize the outcome variable per experimental condition. The following chain of commands first groups the data frame, then computes means and standard deviations. At every step, a data frame is piped into another command, which processes the data frame and outputs a data frame.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="gsr.html#cb109-1"></a>Exp <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb109-2"><a href="gsr.html#cb109-2"></a><span class="st">  </span><span class="kw">group_by</span>(Condition) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb109-3"><a href="gsr.html#cb109-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(outcome),</span>
<span id="cb109-4"><a href="gsr.html#cb109-4"></a>           <span class="dt">sd =</span> <span class="kw">sd</span>(outcome) )</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Condition</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">control</td>
<td align="right">211</td>
<td align="right">10.76</td>
</tr>
<tr class="even">
<td align="left">experimental</td>
<td align="right">252</td>
<td align="right">8.41</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting" class="section level3">
<h3><span class="header-section-number">2.2.10</span> Plotting data</h3>
<p>Good statistical graphics can vastly improve your and your readers understanding of data and results. This book exclusively introduces the modern ggplot2 graphics system of R, which is based on the <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/">grammar of graphics</a>.</p>
<p>Every plot starts with piping a data frame into the <code>ggplot(aes(...))</code> command. The <code>aes(...)</code> argument of ggplot creates the <em>aesthetics</em>, which is a <em>mapping between variables and features of the plot</em> (and only remotely has something to do with beauty). Review the code once again that produces the piles-of-sugar: the aesthetics map the variable <em>Group</em> on the fill color, whereas <em>outcome</em> is mapped to the x axis. For a plot to be valid, there must at least one layer with a <em>geometry</em>. The above example uses the density geometry, which calculates the density and maps it to the y axis.</p>
<p>The ggplot2 plotting system knows a full set of geometries, like:</p>
<ul>
<li>scatter plots with <code>geom_point()</code></li>
<li>smooth line plots with <code>geom_smooth()</code></li>
<li>histograms with <code>geom_histogram()</code></li>
<li>box plots with <code>geom_boxplot()</code> and</li>
<li>my personal favorite: horizontal density diagrams with <code>geom_violin()</code></li>
</ul>
<p>For a brief demonstration of ggplots basic functionality, we use the <code>BAB1</code> data set of the BrowsingAB case. We attach the case environment and use the <code>str</code> command to take a first look at the data:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="gsr.html#cb110-1"></a><span class="kw">attach</span>(BrowsingAB)</span>
<span id="cb110-2"><a href="gsr.html#cb110-2"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tbl_obs</span>()</span></code></pre></div>
<p>The BrowsingAB case is a virtual series of studies, where two websites were compared by how long it takes users to complete a given task, time-on-task (ToT). Besides the design factor, a number of additional variables exist, that could possibly play a role for ToT, too. We explore the data set with ggplot:</p>
<p>We begin with a plot that shows the association between age of the participant and ToT. Both variables are metric and suggest themselves to be put on a 2D plane, with coordinates x and y, a <em>scatter plot</em>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="gsr.html#cb111-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb111-2"><a href="gsr.html#cb111-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,  <span class="dt">y =</span> ToT)) <span class="op">+</span></span>
<span id="cb111-3"><a href="gsr.html#cb111-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/build_ggpl_2-1.png" width="90%" /></p>
<p>Let’s take a look at the elements of the command chain: The first two lines pipe the data frame into the ggplot engine.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="gsr.html#cb112-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb112-2"><a href="gsr.html#cb112-2"></a><span class="st">  </span><span class="kw">ggplot</span>(...)</span></code></pre></div>
<p>At that moment, the ggplot engine “knows” which variables the data frame contains and hence are available for the plot. It does not yet know, which variables are being used, and how. The next step is, usually, to consider a basic (there exist more than 30) <em>geometry</em> and put it on a <em>layer</em>. The scatter plot geometry of ggplot is <code>geom_point</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="gsr.html#cb113-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb113-2"><a href="gsr.html#cb113-2"></a><span class="st">  </span><span class="kw">ggplot</span>(...) <span class="op">+</span></span>
<span id="cb113-3"><a href="gsr.html#cb113-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p>The last step is the <em>aesthetic mapping</em>, which tells ggplot the variables to use and how to map them to <em>aesthetic</em> properties of the geometry. The basic properties of points in a coordinate system are the x and y-positions:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="gsr.html#cb114-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb114-2"><a href="gsr.html#cb114-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> ToT)) <span class="op">+</span></span>
<span id="cb114-3"><a href="gsr.html#cb114-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p>The function <code>aes</code> creates a mapping where the aesthetics per variable are given. When call <code>aes</code> directly, we see that it is just a table.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="gsr.html#cb115-1"></a><span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> ToT)</span></code></pre></div>
<pre><code>## Aesthetic mapping: 
## * `x` -&gt; `age`
## * `y` -&gt; `ToT`</code></pre>
<p>One tiny detail in the above chain has not yet been explained: the <code>+</code>. When choosing the geometry, you actually <em>add a layer</em> to the plot. This is, of course, not the literal mathematical sum. Technically, what the author of the ggplot2 package did, was to <em>overload</em> the <code>+</code> operator. A large set of ggplot functions can be combined in a myriad of ways, just using <code>+</code>. The overloaded <code>+</code> in ggplot is a brilliant analogy: you can infinitely chain ggplot functions, like you can create long sums. You can store ggplot object and later modify it by adding functions. The analogy has its limits, though: other than sums, order matters in ggplot combinations: the first in the chain is always <code>ggplot</code> and layers are drawn upon each other.</p>
<p>Let’s move on with a slightly different situation that will result in a different geometry. Say, we are interested in the distribution of the time-on-task measures under the two designs. We need a geometry, that visualizes the distribution of quantitative variables split by a grouping variable, factor. The box plot does the job:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="gsr.html#cb117-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb117-2"><a href="gsr.html#cb117-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Design,  <span class="dt">y =</span> ToT)) <span class="op">+</span></span>
<span id="cb117-3"><a href="gsr.html#cb117-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/unnamed-chunk-32-1.png" width="90%" /></p>
<p>The box plot maps ToT to y (again). The factor Design is represented as a split on the x-axis. Interestingly, the box plot does not represent the data as raw as in the scatter plot example. The geometry actually performs an analysis on ToT, which produces five statistics: min, first quartile, median, third quartile and max. These statistics define the vertical positions of bars and end points.</p>
<p>Now, we combine all three variables in one plot: how does the association between ToT and age differ by design? As we have two quantitative variables, we stay with the scatter plot for now. As we intend to separate the groups, we need a property of points to distinguish them. Points offer several additional aesthetics, such as color, size and shape. We choose color, and add it to the aesthetic mapping by <code>aes</code>. Note, that it does not matter whether you use the British or American way of writing (colour vs. color).</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="gsr.html#cb118-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb118-2"><a href="gsr.html#cb118-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,  <span class="dt">y =</span> ToT, <span class="dt">color =</span> Design)) <span class="op">+</span></span>
<span id="cb118-3"><a href="gsr.html#cb118-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/unnamed-chunk-33-1.png" width="90%" /></p>
<p>Now, we can distinguish the groups visually, but there is too much clutter to discover any relation. With the box plot we saw that some geometries do not represent the raw data, but summaries (statistics) of data. For scatter plots, a geometry that does the job of summarizing the trend is <code>geom_smooth</code>. This geometry summarizes a cloud of points by drawing a LOESS-smooth line through it. Note how the color mapping is applied to all geometry layers.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="gsr.html#cb119-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb119-2"><a href="gsr.html#cb119-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,  <span class="dt">y =</span> ToT, <span class="dt">color =</span> Design)) <span class="op">+</span></span>
<span id="cb119-3"><a href="gsr.html#cb119-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb119-4"><a href="gsr.html#cb119-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>()</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/unnamed-chunk-34-1.png" width="90%" /></p>
<p>We see a highly interesting pattern: the association between age and ToT follows two slightly different mirrored sigmoid curves.</p>
<p>Now that we have represented three variables with properties of geometries, what if we wanted to add a fourth one, say education level? Formally, we could use another aesthetic, say shape of points, to represent it. You can easily imagine that this would no longer result in a clear visual figure. For situations, where there are many factors, or factors with many levels, it is impossible to reasonably represent them in one plot. The alternative is to use <em>facetting</em>. A facet splits the data by a grouping variable and creates one single plot for every group:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="gsr.html#cb120-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb120-2"><a href="gsr.html#cb120-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,  <span class="dt">y =</span> ToT, <span class="dt">color =</span> Design)) <span class="op">+</span></span>
<span id="cb120-3"><a href="gsr.html#cb120-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb120-4"><a href="gsr.html#cb120-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span></span>
<span id="cb120-5"><a href="gsr.html#cb120-5"></a><span class="st">  </span><span class="kw">facet_grid</span>(Education <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/unnamed-chunk-35-1.png" width="90%" /></p>
<p>See, how the <code>facet_grid</code> command takes a formula, instead of just a variable name. This makes faceting the primary choice for highly-dimensional situations. For example, we may also choose to represent both factors, Design and education by facets:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="gsr.html#cb121-1"></a>BAB1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb121-2"><a href="gsr.html#cb121-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,  <span class="dt">y =</span> ToT)) <span class="op">+</span></span>
<span id="cb121-3"><a href="gsr.html#cb121-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb121-4"><a href="gsr.html#cb121-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span></span>
<span id="cb121-5"><a href="gsr.html#cb121-5"></a><span class="st">  </span><span class="kw">facet_grid</span>(Education <span class="op">~</span><span class="st"> </span>Design)</span></code></pre></div>
<p><img src="Getting_started_with_R_files/figure-html/unnamed-chunk-36-1.png" width="90%" /></p>
<p>Note how the color aesthetic, although unnecessary, is kept. It is possible to map several aesthetics (or facets) to one variable, but not vice versa.</p>
</div>
<div id="fitting" class="section level3">
<h3><span class="header-section-number">2.2.11</span> Fitting regression models</h3>
<p>Above we have seen examples of functions that boil down a vector to a single statistic, like the mean. R has several functions that summarize data in a more complex way. One function with a wide range of applications is the <code>lm</code> command, that applies regression models to data (provided as data frames).</p>
<p>In the following, we will use another simulated data frame <code>Exp</code> to demonstrate linear models. To make this more interesting, we simulate <code>Exp</code> in a slightly advanced way, with quantitative associations between variables. Note how the <em>expected value</em> <span class="math inline">\(\mu\)</span> is created by drawing on the variables <code>Condition</code> and <code>age</code>. The last step adds (somewhat) realistic noise to the measures, by drawing from the normal distribution with a mean of <span class="math inline">\(mu\)</span>.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="gsr.html#cb122-1"></a>N_Obs &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb122-2"><a href="gsr.html#cb122-2"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb122-3"><a href="gsr.html#cb122-3"></a>Exp &lt;-</span>
<span id="cb122-4"><a href="gsr.html#cb122-4"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">Obs =</span> <span class="dv">1</span><span class="op">:</span>N_Obs,</span>
<span id="cb122-5"><a href="gsr.html#cb122-5"></a>             <span class="dt">Condition =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Experimental&quot;</span>, <span class="st">&quot;Control&quot;</span>),</span>
<span id="cb122-6"><a href="gsr.html#cb122-6"></a>                             N_Obs<span class="op">/</span><span class="dv">2</span>),</span>
<span id="cb122-7"><a href="gsr.html#cb122-7"></a>             <span class="dt">age =</span> <span class="kw">runif</span>(N_Obs, <span class="dv">18</span>, <span class="dv">35</span>),</span>
<span id="cb122-8"><a href="gsr.html#cb122-8"></a>             <span class="dt">mu =</span> <span class="dv">200</span> <span class="op">+</span><span class="st"> </span>(Condition <span class="op">==</span><span class="st"> &quot;Control&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">50</span> <span class="op">+</span><span class="st"> </span>age <span class="op">*</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb122-9"><a href="gsr.html#cb122-9"></a>             <span class="dt">outcome =</span> <span class="kw">rnorm</span>(N_Obs, mu, <span class="dv">10</span>))</span></code></pre></div>
<p>The experiment involves two groups, which in classic statistics would clearly point to what is commonly referred to as <em>ANOVA</em>. As it will turn out in <a href="lm.html#cgm">4.3.1</a>, old-fashioned ANOVA can be replaced by a rather simple regression model, that I call comparison of groups model (CGM). The estimation of regression models is done by a <em>regression engine</em>, which basically is a (very powerful) R command. The specification for any regression model is given in R’s formula language. Learning this formula language is key to unleashing the power of regression models in R. We can perform a CGM on the data frame <code>Exp</code> using the regression engine <code>stan_glm</code>. The desired model estimates the effect of <code>Condition</code> on <code>outcome</code>. This produces a regression object that contains an abundance of information, much of it is of little interest for now. (A piece of information, that it does <em>not</em> contain is F-statistics and p-values; and that is why it is not an ANOVA, strictly speaking!) The foremost question is how strong the difference between the groups is. The <code>fixef</code> command extracts the parameter estimates from the model to answer the question.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="gsr.html#cb123-1"></a>M_<span class="dv">1</span> &lt;-<span class="st"> </span></span>
<span id="cb123-2"><a href="gsr.html#cb123-2"></a><span class="st">  </span><span class="kw">stan_glm</span>(outcome <span class="op">~</span><span class="st"> </span>Condition, </span>
<span id="cb123-3"><a href="gsr.html#cb123-3"></a>     <span class="dt">data =</span> Exp)</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="gsr.html#cb124-1"></a><span class="kw">fixef</span>(M_<span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fixef</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="right">275.4</td>
<td align="right">264.0</td>
<td align="right">286.2</td>
</tr>
<tr class="even">
<td align="left">ConditionExperimental</td>
<td align="right">-47.5</td>
<td align="right">-62.6</td>
<td align="right">-31.9</td>
</tr>
</tbody>
</table>
<p>Another classic model is <em>linear regression</em>, where outcome is predicted by a metric variable, say <code>age</code>. The <code>stan_glm</code> regression engine is truly multi-purpose and does the job with grace:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="gsr.html#cb125-1"></a>M_<span class="dv">2</span> &lt;-<span class="st"> </span></span>
<span id="cb125-2"><a href="gsr.html#cb125-2"></a><span class="st">  </span><span class="kw">stan_glm</span>(outcome <span class="op">~</span><span class="st"> </span>age, </span>
<span id="cb125-3"><a href="gsr.html#cb125-3"></a>     <span class="dt">data =</span> Exp)</span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="gsr.html#cb126-1"></a><span class="kw">fixef</span>(M_<span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fixef</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="right">219.02</td>
<td align="right">133.51</td>
<td align="right">308.60</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">1.16</td>
<td align="right">-1.98</td>
<td align="right">4.18</td>
</tr>
</tbody>
</table>
<p>If you are interested in both at the same time, you can combine that in one model by the following formula:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="gsr.html#cb127-1"></a>M_<span class="dv">3</span> &lt;-<span class="st"> </span></span>
<span id="cb127-2"><a href="gsr.html#cb127-2"></a><span class="st">  </span><span class="kw">stan_glm</span>(outcome <span class="op">~</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span>age, </span>
<span id="cb127-3"><a href="gsr.html#cb127-3"></a>     <span class="dt">data =</span> Exp)</span></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="gsr.html#cb128-1"></a><span class="kw">fixef</span>(M_<span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">fixef</th>
<th align="right">center</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Intercept</td>
<td align="right">219.72</td>
<td align="right">177.280</td>
<td align="right">261.59</td>
</tr>
<tr class="even">
<td align="left">ConditionExperimental</td>
<td align="right">-50.35</td>
<td align="right">-63.763</td>
<td align="right">-36.38</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">2.01</td>
<td align="right">0.557</td>
<td align="right">3.52</td>
</tr>
</tbody>
</table>
<p>A statistical model has several components, for example the coefficients and residuals. Models are complex objects, from which a variety of inferences can be made. For example, the coefficient estimates can be extracted and used for prediction. This is what <code>fixef()</code> does in the above code.</p>
<p>A number of functions can be used to extract certain aspects of the model. For example:</p>
<ul>
<li><code>fixef(model)</code> extracts the linear effects</li>
<li><code>residuals(model)</code> extracts the measurement errors</li>
<li><code>predict(model)</code> extracts the expected values</li>
</ul>
<p>These will all be covered in later chapters.</p>
</div>
<div id="knitting" class="section level3">
<h3><span class="header-section-number">2.2.12</span> Knitting statistical reports</h3>
<p>As you have seen throughout this chapter, with R you can effectively manage data, create impressively expressive graphics and conveniently estimate statistical models. Then usually comes the painful moment where all this needs to be assembled into a neat report. With R and Rstudio it has never been easier than that. In fact, complete books have been written in R, like the one you are reading.</p>
<p>A <em>minimal statistical report</em> contains four elements:</p>
<ol style="list-style-type: decimal">
<li>a recap of the research question</li>
<li>description of how the statistical model relates to the research question</li>
<li>a few figures or tables that answers the research question</li>
<li>an explanation of the results</li>
</ol>
<p>Of these four elements, three are pure text. For a minimal report it is a fairly convenient to use a word processor software for the text, craft the figure in R and copy it. One problem with this approach is that a <em>scrunitable statistical report</em> contains at least the following <em>additional</em> elements:</p>
<ol style="list-style-type: decimal">
<li>procedures of data preparation (sources, transformations, variable names, outlier removal)</li>
<li>data exploration (ranges of variables, outlier discovery, visualizing associations, etc.)</li>
<li>model estimation (formula specification, convergence checks)</li>
<li>model criticism (normality of residuals, etc.)</li>
</ol>
<p>In advanced statistical workflows this is then multiplied by the number of models, an iterative selection process. Because it is easy to lie with statistics, these elements are needed as to build a fundament of credibility. Full transparency is achieved, when another researcher can exactly reproduce all steps of the original analysis. It is obvious that the easiest way to achieve this, is to hand over the full R script.</p>
<p>The most user-friendly way to achieve both, a good looking report and full transparency, is to write a document that contains all before mentioned: text, graphics, tables and R code. In the R environment such mixed documents can be written in the <em>markdown/knitr</em> framework.</p>
<p>Markdown implements a simple markup language, with that you can typset simple, structured texts in a plain ASCII editor. Later in the workflow, such a markup document is transformed into one of various output formats, that are rendered by the respective programs, such as Microsoft Word or an HTML browser.</p>
<div class="figure">
<img src="Illustrations/markup_minimal_report.png" alt="" />
<p class="caption">A minimal statistical report in markdown</p>
</div>
<p>The above text is an alternation of markup text and <em>chunks</em>, those weirdly enclosed pieces of R code. While the text is static, the chunks are processed by the knitr engine, evaluating the enclosed R code and knitting the output into a document. Very conveniently, when the output is a figure, it will be inserted into the document right away. The <code>kable</code> command from the knitr package, in turn, produces neatly rendered tables from data frame objects. By default, the R code is shown, too, but that can be customized.</p>
<p>The minimal workflow for statistical reporting with knitr is as follows:</p>
<ol style="list-style-type: decimal">
<li>Use markdown right away, covering all steps of your data analysis, i.e. a scrutable report. You may even start writing when only one part of your data gathering is completed, because due to the dynamic chunks, updating the report when new data arrives is just a button click away.</li>
<li>When the data analysis is complete, compile the scrutable report to Word format</li>
<li>Extract the passages, figures and tables for a minimal statistical report. This is your results section.</li>
<li>provide the scrutable report as appendix or supplementary material</li>
</ol>
<p>In the notion of this chapter, this is just to get you started and knitr is so tightly integrated with the Rstudio environment that I don’t even bother to explain the commands for knitting a document. Once acquainted with the basics, markdown provides a few additional markup tokens, like footnotes, hyperlinks or including images. The customization options and addons for knitr are almost endless and various interesting addons are available, just to mention two:</p>
<ol style="list-style-type: decimal">
<li>The bookdown package provides an infrastructure for writing and publishing longer reports and books.</li>
<li>With the shiny package one can add dynamic widgets to HTML reports. Think of a case, where your statistical model is more complicated than a linear regression line or a few group means, say you are estimating a polynomial model or a learning curve. Then, with a simple shiny app, you can enable your readers to understand the model by playful exploration.</li>
</ol>
</div>
<div id="ex-gsr" class="section level3">
<h3><span class="header-section-number">2.2.13</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>In the book package (directory <code>/Data</code>) you will find the data set of the (virtual) study BAB1, which we will be using in coming chapters. This data comes as comma-separated value file with the file ending <code>.csv</code>. Load this file into R using the <code>read_csv</code> command and check the dataframe.</p></li>
<li><p>Find the documentation of the packages <code>haven</code> and <code>readr</code>. Find two import functions. The one that is most useful for you and the one that you consider most exotic.</p></li>
<li><p>We have seen how to extract a data frame column as a vector using the double square brackets. There seems to be no such option to extract an individual row as a vector. Why? (Think about object types). &lt;–! #14 –&gt;</p></li>
<li><p>Use the world wide web to find geometries that are useful for plotting associations between grouping variables (factors) and a metric variables. Try them all on the BAB1 data frame. Compare the geometries on what properties of the data they convey.</p></li>
<li><p>Like data frames and regression results, plots produced by ggplot are complex objects, too. Create an arbitrary plot, store it in a variable and inspect it using <code>class</code>, <code>summary</code> and <code>str</code>. In addition, what happens when you assign the plot to a variable and what happens when you call the variable?</p></li>
<li><p>Revisit the python-swallowed-camel plot and check out how the aesthetic mapping is created. The plot uses a density geometry. Change it into a histogram. Then produce a box plot that shows the two conditions (think carefully about the mappings of x and y).</p></li>
<li><p>Use the data set BAB5 in BrowsingAB. It contains a follow-up experiment, where participants had to do five different tasks on the website. Plot the association between age and ToT by task, using color. Then put Task on a facet grid, and use color to represent Design again.</p></li>
<li><p>Use the data set BAB5 in BrowsingAB. Using a transformation chain, take the sum or average of participants’ ToT. Then run a few simple regression models.</p></li>
<li><p>Use your own data. Drop an Excel and/or an SPSS file into the same directory as your current R file. Read the data into a data frame and summarize what is in the data frame. Use ggplot to create one or more exploratory graphs. Then use dplyr <code>summarize</code> to create summary statistics.</p></li>
<li><p>Do a full exploratory analysis of the dataframe D_agg in case environment IPump. It has the predictors Design, Group, Education and experience. It has the outcome variables ToT, deviations and workload.</p>
<ol style="list-style-type: decimal">
<li>Get the data frame into R and produce a summary.</li>
<li>Plot a histogram for all dependent variables.</li>
<li>Produce a table that counts the number of observations per Education(al level).</li>
<li>Produce a table that displays minimum, maximum, median, mean and standard deviation of experience.</li>
<li>Exclude participants with less than four years of experience.</li>
<li>Produce a table with group means per Design and Session.</li>
<li>For every outcome variable, produce a plot for Design by session.</li>
<li>Explore graphically, what other relations may exist between outcome variables and Group, Education and experience.</li>
<li>Run a regression model for ToT with Design and Session as predictors.</li>
<li>Produce a coefficient table.</li>
<li>Plot the residuals.</li>
</ol></li>
</ol>
</div>
<div id="lib_gsr" class="section level3">
<h3><span class="header-section-number">2.2.14</span> Bibliographic notes</h3>
<p><a href="http://r4ds.had.co.nz/">R for Data Science</a> is a book co-authored by Hadley “Tidy” Wickham.</p>
<p><a href="http://www.r-bloggers.com/ggplot2-version-of-figures-in-%E2%80%9C25-recipes-for-getting-started-with-r%E2%80%9D/">ggplot2 Version of Figures in “25 Recipes for Getting Started with R”</a> for readers who are familiar with the legacy plotting commands in R.</p>
<p><a href="http://rpubs.com/justmarkham/dplyr-tutorial">Introduction to dplyr for Faster Data Manipulation in R</a> introduces dplyr, the next generation R interface for data manipulation, which is used extensively in this book.</p>
<p><a href="http://www.statmethods.net/">Quick-R</a> is a comprehensive introduction to many common statistical techniques with R.</p>
<p><a href="http://codeasmanuscript.org/lessons/">Code as manuscript</a> features a small set of lessons with code examples, assignments and further resources. For if you are in a haste.</p>
<p><a href="https://bookdown.org/yihui/bookdown/">bookdown: Authoring Books and Technical Documents with R Markdown</a> fully unleashes the power of knitr for writing and publishing longer reports and books.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ebs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["New_Stats.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
